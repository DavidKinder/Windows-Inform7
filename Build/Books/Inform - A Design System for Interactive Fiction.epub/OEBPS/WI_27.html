<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!-- Generated by indoc on 11 Aug 2016 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_WI.css" rel="stylesheet" type="text/css" />
<title>Chapter 27: Extensions</title>
</head>
<body class="paper papertint"><p class="chapterheading">Chapter 27: Extensions</p>
<p class="chaptercontents"><a href="WI_27.html#s1" class="standardlink"><span class="chaptercontentsitem">§27.1. The status of extensions</span></a>; <a href="WI_27.html#s2" class="standardlink"><span class="chaptercontentsitem">§27.2. The Standard Rules</span></a>; <a href="WI_27.html#s3" class="standardlink"><span class="chaptercontentsitem">§27.3. Built-in, installed and project-specific extensions</span></a>; <a href="WI_27.html#s4" class="standardlink"><span class="chaptercontentsitem">§27.4. Authorship</span></a>; <a href="WI_27.html#s5" class="standardlink"><span class="chaptercontentsitem">§27.5. A simple example extension</span></a>; <a href="WI_27.html#s6" class="standardlink"><span class="chaptercontentsitem">§27.6. Version numbering</span></a>; <a href="WI_27.html#s7" class="standardlink"><span class="chaptercontentsitem">§27.7. Extensions and story file formats</span></a>; <a href="WI_27.html#s8" class="standardlink"><span class="chaptercontentsitem">§27.8. Extensions can include other extensions</span></a>; <a href="WI_27.html#s9" class="standardlink"><span class="chaptercontentsitem">§27.9. Extensions can interact with other extensions</span></a>; <a href="WI_27.html#s10" class="standardlink"><span class="chaptercontentsitem">§27.10. Extensions in the Index</span></a>; <a href="WI_27.html#s11" class="standardlink"><span class="chaptercontentsitem">§27.11. Extension documentation</span></a>; <a href="WI_27.html#s12" class="standardlink"><span class="chaptercontentsitem">§27.12. Examples and headings in extension documentation</span></a>; <a href="WI_27.html#s13" class="standardlink"><span class="chaptercontentsitem">§27.13. Implications</span></a>; <a href="WI_27.html#s14" class="standardlink"><span class="chaptercontentsitem">§27.14. Using Inform 6 within Inform 7</span></a>; <a href="WI_27.html#s15" class="standardlink"><span class="chaptercontentsitem">§27.15. Defining phrases in Inform 6</span></a>; <a href="WI_27.html#s16" class="standardlink"><span class="chaptercontentsitem">§27.16. Phrases to decide in Inform 6</span></a>; <a href="WI_27.html#s17" class="standardlink"><span class="chaptercontentsitem">§27.17. Handling phrase options</span></a>; <a href="WI_27.html#s18" class="standardlink"><span class="chaptercontentsitem">§27.18. Making and testing use options</span></a>; <a href="WI_27.html#s19" class="standardlink"><span class="chaptercontentsitem">§27.19. Longer extracts of Inform 6 code</span></a>; <a href="WI_27.html#s20" class="standardlink"><span class="chaptercontentsitem">§27.20. Primitive Inform 6 declarations of rules</span></a>; <a href="WI_27.html#s21" class="standardlink"><span class="chaptercontentsitem">§27.21. Inform 6 objects and classes</span></a>; <a href="WI_27.html#s22" class="standardlink"><span class="chaptercontentsitem">§27.22. Inform 6 variables, properties, actions, and attributes</span></a>; <a href="WI_27.html#s23" class="standardlink"><span class="chaptercontentsitem">§27.23. Inform 6 Understand tokens</span></a>; <a href="WI_27.html#s24" class="standardlink"><span class="chaptercontentsitem">§27.24. Inform 6 adjectives</span></a>; <a href="WI_27.html#s25" class="standardlink"><span class="chaptercontentsitem">§27.25. Naming Unicode characters</span></a>; <a href="WI_27.html#s26" class="standardlink"><span class="chaptercontentsitem">§27.26. The template layer</span></a>; <a href="WI_27.html#s27" class="standardlink"><span class="chaptercontentsitem">§27.27. Translating the language of play</span></a>; <a href="WI_27.html#s28" class="standardlink"><span class="chaptercontentsitem">§27.28. Segmented substitutions</span></a>; <a href="WI_27.html#s29" class="standardlink"><span class="chaptercontentsitem">§27.29. Invocation labels, counters and storage</span></a>; <a href="WI_27.html#s30" class="standardlink"><span class="chaptercontentsitem">§27.30. To say one of</span></a></p><table class="centredtable"><tr><td class="roadsigndirection"><a href="WI_1.html" class="standardlink"><img alt="arrow-up-left.png" src="images/arrow-up-left.png" /></a></td><td><a href="WI_1.html" class="standardlink">Contents of <i>Writing with Inform</i></a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_26.html" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_26.html" class="standardlink">Chapter 26: Publishing</a></td></tr>
<tr><td class="roadsigndirection"><a href="examples_alphabetical.html" class="standardlink"><img alt="arrow-down-right.png" src="images/arrow-down-right.png" /></a></td><td><a href="examples_alphabetical.html" class="standardlink">Indexes of the examples</a></td></tr>
</table><p class="sectionheading"><a id="s1"></a>§27.1. The status of extensions</p>
<p>The range of simulation offered by Inform's model world is intentionally limited to a core of basic essentials. We could argue at the margins, and the choice of what's in and what's out is partly traditional, but most people find the model reasonable as far as it goes.</p>
<p>Between 1993 and 2006, quite a range of &quot;library extensions&quot; for Inform 6 was written. Most of these extensions aimed to fill out the model by simulating other aspects of life, too: money, clothing, pourable liquids. None of these extensions was official and all of them were: it was a free-for-all, and in several cases different authors wrote rival extensions to model the same basic ideas. The development of Inform 7 was strongly influenced by this history and by the recognition that the base of rules and grammar inside a typical modern story are seldom written by a single author. They combine the standard Inform material with extensions by several third parties, together with anything specific to the story in question.</p>
<p>Inform 7 has a more organised idea of extensions, as we shall see. But anyone is free to write an extension on any terms or for any reason. Writers may wish to use the techniques in this chapter to develop private extensions of their own, used in several projects, or to share them with associates but not more widely.</p>
<p>But most writers of extensions do so to contribute to the Inform community, and for the satisfaction of solving a problem. Inform does not recognise anyone's approach to a particular need as &quot;the official solution&quot; - for instance, although the standard Inform distribution includes a copy of Locksmith by Emily Short, that is not the &quot;official&quot; way to make automatically unlocking doors, and anyone is welcome to try a better one.</p>
<p>However, the Inform project does recognise some extensions as &quot;public&quot;. Public extensions are the ones archived on the Inform website for the free use of all Inform writers. Those who wish to contribute an extension as a public one are obliged to follow a number of guidelines, which are mostly stylistic points intended to make the range of extensions easier to work with. Extension writers are asked to join in the spirit of these rules and help make the whole cooperative enterprise work harmoniously. Extensions which do play by these rules are also accepted into the Public Library, which makes them easy for all Inform users everywhere to find and obtain them.</p>
<p>Writers who wish to make their extensions public on the Inform website should also be clear that by doing so, they are donating their work to the community on the basis of the broadest form of Creative Commons license: that is, they retain copyright and the right to be identified as the author (and as we shall see they are automatically credited in any work of IF which uses their extension), but are giving unlimited permission to use, circulate and republish their extensions in any form, even as part of commercial works (should that arise). To publish a public extension is a public-spirited act, done for only the reward of a modest acknowledgement.</p>
<p>If the author of an extension has not made it public, or indicated in some other way that it is free to be used without the need for permission, then it would be both polite and prudent to check with the author before publishing something which incorporates his work.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_26.html#s10" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_26.html#s10" class="standardlink">Back to Chapter 26: Publishing: §26.10. A short concluding homily</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s2" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s2" class="standardlink">Onward to §27.2. The Standard Rules</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s2"></a>§27.2. The Standard Rules</p>
<p>When any source text is run through Inform, a secret first line is inserted, which reads:</p>
<!-- START CODE "c9009" -->
<a id="c9009"></a><blockquote class="code"><p class="quoted">
Include the Standard Rules by Graham Nelson.
</p></blockquote>
<!-- END CODE -->
<p>The &quot;Standard Rules&quot; file contains the definitions of the basic kinds, phrases, actions and grammar described in this documentation: for instance, it includes lines like</p>
<!-- START CODE "c9010" -->
<a id="c9010"></a><blockquote class="code"><p class="quoted">
A container is a kind of thing.
</p></blockquote>
<!-- END CODE -->
<p>...without which Inform would be lost. Although including the Standard Rules is compulsory, it is treated internally as if it were any other &quot;extension&quot;.</p>
<p>What happens when an &quot;Include&quot; sentence is reached is that the sentence is replaced with the whole text of the file in question, often many paragraphs long.</p>
<p>If the file has already been included, then the sentence is simply ignored. This is so that we can have two extensions, each of which needs the other: if A says to include B, and B says to include A, the result is that including one automatically includes the other, so we always get both which ever we ask for - not that there is a hideous infinite regress.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s1" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s1" class="standardlink">Back to §27.1. The status of extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s3" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s3" class="standardlink">Onward to §27.3. Built-in, installed and project-specific extensions</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s3"></a>§27.3. Built-in, installed and project-specific extensions</p>
<p>To recap: Inform builds projects from both the source text typed by the author and from Extensions; one of these, the Standard Rules, is always included; others are added as authors please. About 20 are &quot;built-in&quot; to Inform, meaning that they are stored inside the application and always available. Others must be &quot;installed&quot;, and each Inform user will have a folder somewhere on his computer which contains these. Users typically obtain these from the Public Library feature in the application, but they can also download them directly from inform7.com and then use an Install Extension menu option in the application. Either way, the application then squirrels the file away, and it becomes available to any projects that that user may be working on.</p>
<p>It is also possible to have extensions available to just one project. These must be stored in the Extensions subfolder of the project's &quot;.materials&quot; folder, but otherwise are arranged the same as installed extensions - there's an outer folder for each author's name, and extensions are named with a &quot;.i7x&quot; extension within. For example:</p>
<!-- START CODE "c9011" -->
<a id="c9011"></a><blockquote class="code"><p class="quoted">
Mourning Hypercritical.inform
<br />Mourning Hypercritical.materials
<br />&#160;&#160;&#160;&#160;Extensions
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;John Siracusa
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Fixing The Finder.i7x
</p></blockquote>
<!-- END CODE -->
<p>When Inform needs to find an extension, it looks here first, then in the installed area, then in its built-in area. That means that we can make our own revised or hacked version of an extension, put it in the &quot;.materials&quot; area, and then have it take precedence over the installed or built-in one. We could even have our own private version of the Standard Rules here.</p>
<p>(This has a number of possible uses - for example, to provide a convenient test-bed when working on an experimental version of an extension.)</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s2" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s2" class="standardlink">Back to §27.2. The Standard Rules</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s4" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s4" class="standardlink">Onward to §27.4. Authorship</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s4"></a>§27.4. Authorship</p>
<p>Extensions are identified by author and by name, so that a given author can produce his or her own range of extensions, and need only ensure that these are named differently from each other. If John Smith and Mary Brown each want to write an extension called &quot;Following People&quot;, there is no conflict.</p>
<p>The name of an extension, and of an author, should be written in Sentence Capitalisation: that is, upper case for the first letter in each word. (Inform uses this to minimise problems on machines where filenames are read with case sensitivity.) It is permitted for author names to include upper-case letters within words, as with the &quot;G&quot; in &quot;Jesse McGrew&quot;. In general it is best to avoid accented or unusual letters in titles and author names, but the standard ISO Latin-1 characters should be allowed - for instance,</p>
<!-- START CODE "c9012" -->
<a id="c9012"></a><blockquote class="code"><p class="quoted">
Étude Pour La Fênetre by Françoise Gauß begins here.
</p></blockquote>
<!-- END CODE -->
<p>The author name must not start with &quot;The&quot;, nor contain the words &quot;by&quot;, &quot;and&quot; or &quot;version&quot;, or contain punctuation, as in &quot;John X. Doe&quot;; the title similarly, except that &quot;and&quot; is permitted. Name and author's name must each be no more than 50 characters long, including any spaces between words.</p>
<p>Authors are asked to use real names rather than cryptic handles like &quot;ifguy&quot;, and to use genteel, plausible pseudonyms like &quot;Emily Short&quot; rather than, say, &quot;Drooling Zombie&quot; or &quot;Team Inform&quot;. Authors are also asked to use the same author's name for all their own extensions, and (it should go without saying) not to masquerade as anybody else.</p>
<p>Sometimes authorship is complicated. What if Mary Brown finds some Inform 6 code written by John Smith in the mid-90s, and puts an I7 gloss on it to make an I7 extension, but then Pierre Dupont translates it into French: who's the author of the result? The rule is that the person making the current, latest version is the author listed in the titling line, so we end up with</p>
<!-- START CODE "c9013" -->
<a id="c9013"></a><blockquote class="code"><p class="quoted">
... by Pierre Dupont begins here.
</p></blockquote>
<!-- END CODE -->
<p>But Mary and John deserve their credits too: see the next section for how to give them.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s3" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s3" class="standardlink">Back to §27.3. Built-in, installed and project-specific extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s5" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s5" class="standardlink">Onward to §27.5. A simple example extension</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s5"></a>§27.5. A simple example extension</p>
<p>Extensions are plain text files, and can be created with any text editor. (It is sometimes said that &quot;there is no such thing as plain text&quot;, there being so many ways to represent exotic characters: so to be precise, an extension is a text file with the Unicode UTF-8 encoding, either with or without a BOM marker, using any of the possible forms of line-ending (Unix, Windows, Macintosh, or Unicode line divider). This is a detail which will only matter if the extension contains accented letters or other exotica.)</p>
<p>Extensions look very much like passages of Inform source, because except for a special introductory and concluding sentence, and one convention, that is all they are:</p>
<!-- START CODE "c9014" -->
<a id="c9014"></a><blockquote class="code"><p class="quoted">
The Ducking Action by Graham Nelson begins here.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9015" -->
<a id="c9015"></a><blockquote class="code"><p class="quoted">
&quot;An action for ducking one's head.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9016" -->
<a id="c9016"></a><blockquote class="code"><p class="quoted">
Ducking is an action applying to nothing. Report ducking: say &quot;You duck!&quot; Understand &quot;duck&quot; as ducking.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9017" -->
<a id="c9017"></a><blockquote class="code"><p class="quoted">
The Ducking Action ends here.
</p></blockquote>
<!-- END CODE -->
<p>Not a useful or interesting extension, but those few words add a whole new action and everything needed to make it work. It is Inform's ability to mix up rooms, things, kinds, grammar, phrases and rules, in more or less any order, which makes it possible for extensions to work.</p>
<p>The introductory sentence must be placed as the only content of line 1 of the file, which must not contain comments, and has to be written in exactly the correct form. Inform checks this very carefully when performing its census of installed extensions, on each translation of the text. (In case the extension's title is a plural, we are allowed to write &quot;begin&quot; and &quot;end&quot; instead of &quot;begins&quot; and &quot;ends&quot;. For instance, the last line of the standard rules is &quot;The Standard Rules end here.&quot;)</p>
<p>The &quot;one convention&quot; mentioned above is that if a double-quoted text is placed immediately after the beginning sentence (and with no intervening comments), then it is taken to be a short description of the extension's content called the &quot;rubric&quot;. Hence the line:</p>
<!-- START CODE "c9018" -->
<a id="c9018"></a><blockquote class="code"><p class="quoted">
&quot;An action for ducking one's head.&quot;
</p></blockquote>
<!-- END CODE -->
<p>Providing a rubric is helpful, because it enables Inform to give a meaningful listing even for an as-yet unused and unindexed extension, and because it helps the Inform website to produce better directories. Note the word &quot;short&quot;: such text is likely to be truncated if it exceeds 500 characters.</p>
<p>A second double-quoted text can also, optionally, be added in yet a third special starting paragraph. This is to provide additional credits to people who have contributed to this or earlier versions. For instance:</p>
<!-- START CODE "c9019" -->
<a id="c9019"></a><blockquote class="code"><p class="quoted">
The Ducking Action by Graham Nelson begins here.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9020" -->
<a id="c9020"></a><blockquote class="code"><p class="quoted">
&quot;An action for ducking one's head.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9021" -->
<a id="c9021"></a><blockquote class="code"><p class="quoted">
&quot;based on original Inform 6 code by Marc Canard&quot;
</p></blockquote>
<!-- END CODE -->
<p>Note the typical style here: it's a phrase rather than a sentence, and neither starts with an upper-case letter nor ends with a full stop. (The additional credit is then used in documentation and also in the VERSION text of any Inform story file using the extension.)</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s4" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s4" class="standardlink">Back to §27.4. Authorship</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s6" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s6" class="standardlink">Onward to §27.6. Version numbering</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#e251" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_27.html#e251" class="standardlink">Example 449: <img class="asterisk" alt="*" src="images/asterisk.png" /><img class="asterisk" alt="*" src="images/asterisk.png" /> <b>Modern Conveniences</b>&#160;&#160;&#160; Exemplifying the kind of source we might use in writing extensions for kitchen and bathroom appliances.</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s6"></a>§27.6. Version numbering</p>
<p>As we have seen, extensions are referred to by name and author, but they can also (optionally) be referred to by version. For instance:</p>
<!-- START CODE "c9022" -->
<a id="c9022"></a><blockquote class="code"><p class="quoted">
Include version 2 of the Ducking Action by Graham Nelson.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9023" -->
<a id="c9023"></a><blockquote class="code"><p class="quoted">
Version 1/040426 of the Ducking Action by Graham Nelson begins here.
</p></blockquote>
<!-- END CODE -->
<p>A version number must be a whole number 1, 2, ..., 999 (version 0 is not allowed, and nor are decimal points), optionally followed by a slash '/' and then a six-figure date, in the form YYMMDD: so 040426 means 26 April 2004.</p>
<p>A request to include version 2 of something implicitly means &quot;version 2 or later&quot;, and similarly &quot;version 2/040426&quot; means version 2 with a date of 26 April 2004 or later, or else any version higher than 2. If Inform loads the extension but finds that its version is not good enough, an error is issued.</p>
<p>Where no version number is quoted, the rule is that an unspecified version predates any numbered version. This means that the line</p>
<!-- START CODE "c9024" -->
<a id="c9024"></a><blockquote class="code"><p class="quoted">
Include the Ducking Action by Graham Nelson.
</p></blockquote>
<!-- END CODE -->
<p>will be happy with any version of the extension at all, whether numbered or not; but</p>
<!-- START CODE "c9025" -->
<a id="c9025"></a><blockquote class="code"><p class="quoted">
Include version 2 of the Ducking Action by Graham Nelson.
</p></blockquote>
<!-- END CODE -->
<p>will only accept the extension if it has a version number attached (and with that number being 2 or higher).</p>
<p>During play of any story compiled by Inform 7, typing VERSION lists various serial numbers of the pieces of software used to make it. The list concludes with names, authors and version numbers of any extensions used. So every author whose work contributes to a story automatically gets a modest credit within it. The same list can be printed, at the discretion of the designer, using the textual substitution:</p>
<!-- START PHRASE "defn378" -->
<div class="definition"><a id="defn378"></a><p class="defnprototype"><b>say &quot;[the</b>/--<b> list of extension credits]&quot;</b></p>
<!-- END PHRASE -->
<!-- definition of phs_extcredits -->

<p>This text substitution expands to one or more lines of text crediting each of the extensions used by the current source text, along with their version numbers and authors. Extensions whose authors have chosen the &quot;use authorial modesty&quot; option are missed out. Example:</p>
<!-- START CODE "c9026" -->
<a id="c9026"></a><blockquote class="code"><p class="quoted">
Standard Rules version 2/090402 by Graham Nelson
</p></blockquote>
<!-- END CODE -->

<!-- end definition -->
</div>

<p>If we want our extension to go uncredited - perhaps if it is a low-level enabling sort of thing, for instance - we can place the following sentence inside the definition of the extension:</p>
<!-- START CODE "c9027" -->
<a id="c9027"></a><blockquote class="code"><p class="quoted">
Use authorial modesty.
</p></blockquote>
<!-- END CODE -->
<p>The same sentence placed in the body of a source text causes all extensions by the same author as the main source text to go uncredited. In other words, if Isaac Miggins writes a source text and includes, say, Unlikely Events by Isaac Miggins, then this extension will go uncredited in the VERSION command.</p>
<p>A complete list, undiluted by modesty, can always be obtained using:</p>
<!-- START PHRASE "defn379" -->
<div class="definition"><a id="defn379"></a><p class="defnprototype"><b>say &quot;[the</b>/--<b> complete list of extension credits]&quot;</b></p>
<!-- END PHRASE -->
<!-- definition of phs_compextcredits -->

<p>This text substitution expands to one or more lines of text crediting each of the extensions used by the current source text, along with their version numbers and authors. Every extension is included, even those whose authors have opted for &quot;use authorial modesty&quot;. Example:</p>
<!-- START CODE "c9028" -->
<a id="c9028"></a><blockquote class="code"><p class="quoted">
Standard Rules version 2/090402 by Graham Nelson
<br />Locksmith version 9 by Emily Short
</p></blockquote>
<!-- END CODE -->

<!-- end definition -->
</div>

<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s5" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s5" class="standardlink">Back to §27.5. A simple example extension</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s7" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s7" class="standardlink">Onward to §27.7. Extensions and story file formats</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s7"></a>§27.7. Extensions and story file formats</p>
<p>Inform compiles to several different story file formats, and in each case uses only a small part of their abilities - especially when it comes to fancy tricks with the keyboard or screen. So people may well want to write extensions which provide access to some of these tricks (like &quot;Basic Screen Effects&quot;, included in the standard Inform distribution, but more so). Unfortunately, these tricks are very likely to fail to compile - or fail to work - on some of the possible story file formats, so the resulting extension would probably go wrong (and mysteriously wrong) for users who have chosen a different format.</p>
<p>Inform therefore provides a way for extensions to declare the formats they are compatible with. All that is required is to add a proviso in brackets after the title is declared:</p>
<!-- START CODE "c9029" -->
<a id="c9029"></a><blockquote class="code"><p class="quoted">
Version 2 of Basic Screen Effects (for Z-Machine version 8 only) by Emily Short begins here.
</p></blockquote>
<!-- END CODE -->
<p>Other examples might be &quot;(for Glulx only)&quot;, or &quot;(for Z-machine only)&quot;. If no such proviso is given, the extension is assumed to be compatible with every story file format.</p>
<p>Extensions are also able to include material which is only used on some story file formats and not others - in principle, this might allow the same facilities to be provided to the author whatever story file format is used, but to achieve these effects differently depending on the current Settings. The convention here is exactly like &quot;not for release&quot;: if a heading or subheading in the source text contains a bracketed proviso, then the material under that heading (and under its dependent subheadings) will be ignored if the current story file format does not match. For example:</p>
<!-- START CODE "c9030" -->
<a id="c9030"></a><blockquote class="code"><p class="quoted">
Section 2.3G (for Glulx only)
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9031" -->
<a id="c9031"></a><blockquote class="code"><p class="quoted">
To reveal the explosion:
<br />&#160;&#160;&#160;&#160;[...the Glulx way...]
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9032" -->
<a id="c9032"></a><blockquote class="code"><p class="quoted">
Section 2.3Z (for Z-machine only)
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9033" -->
<a id="c9033"></a><blockquote class="code"><p class="quoted">
To reveal the explosion:
<br />&#160;&#160;&#160;&#160;[...the Z-machine way...]
</p></blockquote>
<!-- END CODE -->
<p>would ensure that &quot;reveal the explosion&quot; works nicely whichever story file format is used.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s6" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s6" class="standardlink">Back to §27.6. Version numbering</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s8" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s8" class="standardlink">Onward to §27.8. Extensions can include other extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#e385" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_27.html#e385" class="standardlink">Example 450: <img class="asterisk" alt="*" src="images/asterisk.png" /><img class="asterisk" alt="*" src="images/asterisk.png" /> <b>Tilt 3</b>&#160;&#160;&#160; Displaying the card suits from our deck of cards with red and black colored unicode symbols.</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s8"></a>§27.8. Extensions can include other extensions</p>
<p>As was mentioned earlier, the same extension is sometimes requested several times. For instance, suppose the main source text asks to include version 2 of extension X, and also to include extension Y. Suppose further that Y contains a request to include version 4 of X. We now have two different requests for X. Inform works out the minimum version number needed to satisfy these requests (in this case 4) and gives an error if the extension it actually loads turns out to be earlier.</p>
<p>This is true even of the Standard Rules. Suppose that the Standard Rules had recently been republished in version 37, making the previously existing version 36 out of date, and that an extension is written which capitalizes on a new feature in v37. It will therefore not work if people try to use it with v36. All the extension needs to do is to say:</p>
<!-- START CODE "c9034" -->
<a id="c9034"></a><blockquote class="code"><p class="quoted">
Include version 37 of the Standard Rules by Graham Nelson.
</p></blockquote>
<!-- END CODE -->
<p>to guarantee that v37 or later will be used.</p>
<p>If an extension does include other extensions, it should do so in a paragraph immediately following the introductory sentence, so that anyone looking at the file can see these mutual dependencies at a glance.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s7" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s7" class="standardlink">Back to §27.7. Extensions and story file formats</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s9" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s9" class="standardlink">Onward to §27.9. Extensions can interact with other extensions</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s9"></a>§27.9. Extensions can interact with other extensions</p>
<p>When one extension is being used, it's probably only one among several. A really general-purpose extension might want to behave differently depending on which other extensions are also present. This can be achieved using headings which are &quot;for use with&quot; (or &quot;without&quot;) other extensions. For instance:</p>
<!-- START CODE "c9035" -->
<a id="c9035"></a><blockquote class="code"><p class="quoted">
Chapter 2a (for use with Locksmith by Emily Short)
</p></blockquote>
<!-- END CODE -->
<p>specifies that everything under this heading (and its subheadings, if any) will be ignored unless the extension Locksmith by Emily Short is included. Conversely,</p>
<!-- START CODE "c9036" -->
<a id="c9036"></a><blockquote class="code"><p class="quoted">
Chapter 2b (for use without Locksmith by Emily Short)
</p></blockquote>
<!-- END CODE -->
<p>will be ignored unless it isn't included. This allows an extension to give two variations on the same material - one if Locksmith is present, the other if not.</p>
<p>Headings can also replace portions of extensions which have been included. For instance:</p>
<!-- START CODE "c9037" -->
<a id="c9037"></a><blockquote class="code"><p class="quoted">
Section 6 - Hacked locking (in place of Section 1 - Regular locking in Locksmith by Emily Short)
</p></blockquote>
<!-- END CODE -->
<p>places the source text under the new heading in the place of the old (which is thrown away). If there should be two or more headings of the same name in the given extension, the first is the one replaced; if two or more headings attempt to replace the same heading in the given extension, the final attempt in source text order is the one which succeeds; and finally, heading dependencies like the above are scanned in a top-down way. Thus, if we have:</p>
<!-- START CODE "c9038" -->
<a id="c9038"></a><blockquote class="code"><p class="quoted">
Chapter 2a (for use with Locksmith by Emily Short)
<br />...
<br />Section 1 - Hacked marbles (in place of Section 4 in Marbles by Peter Wong)
<br />...
</p></blockquote>
<!-- END CODE -->
<p>and we don't include Locksmith, then the replacement of Section 4 of Marbles is not made, because Section 1 - Hacked marbles is subordinate to the Chapter 2a heading which we've told Inform to ignore.</p>
<p>If the name of the heading to replace contains the word &quot;in&quot;, it's a good idea to use quotation marks for clarity:</p>
<!-- START CODE "c9039" -->
<a id="c9039"></a><blockquote class="code"><p class="quoted">
Section - Hacked questions (in place of &quot;Section 4 - Phrase used to ask questions in closed mode&quot; in Questions by Michael Callaghan)
</p></blockquote>
<!-- END CODE -->
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s8" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s8" class="standardlink">Back to §27.8. Extensions can include other extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s10" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s10" class="standardlink">Onward to §27.10. Extensions in the Index</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s10"></a>§27.10. Extensions in the Index</p>
<p>As soon as a project has successfully been translated, its Index is brought up to date: pages of the index record all the kinds and what they are for, all the phrases which can be used, and so on. Any kind or phrase created in an extension is automatically included. The extension's presence in the project is itself recorded - the Contents index for any project contains a brief list of all extensions used in that project, along with their authors and version numbers. For instance:</p>
<!-- START CODE "c9040" -->
<a id="c9040"></a><blockquote class="code"><p class="quoted">
Standard Rules version 1/040731
<br />Locksmith by Emily Short
<br />Tupperware by Emily Short
</p></blockquote>
<!-- END CODE -->
<p>The Kinds index aims to give the reader a brief note of what each kind is intended for. We can provide for this by writing a sentence like so:</p>
<!-- START CODE "c9041" -->
<a id="c9041"></a><blockquote class="code"><p class="quoted">
The specification of player's holdall is &quot;Represents a container which the player can carry around as a sort of rucksack, into which spare items are automatically stowed away.&quot;
</p></blockquote>
<!-- END CODE -->
<p>There is no need to specify the properties which apply: that is all done automatically. &quot;Specification&quot; is a sort of pseudo-property used just for this: we can also give specifications to kinds of value and to actions, and these are similarly used in the Index pages.</p>
<p>Every extension has the right to its own set of headings and subheadings, independently of those used by the main source for the work or by any other extension which may be included. (So if the extension is divided into four sections and finishes on Section D, say, that doesn't mean that Section D will continue outside the extension as the main source of the story runs on.)</p>
<p>Extensions should, of course, be written so that they never produce Problem messages, so at first sight it appears that these headings will never be outwardly visible. In fact, though, Problems do occasionally turn up in extensions, usually when the user has made a mistake, or when two inconsistent extensions are used in the same project. But more importantly, the headings in an extension are used when indexing phrases (and also actions) to group similar phrases together. For instance, the Standard Rules contain the heading:</p>
<!-- START CODE "c9042" -->
<a id="c9042"></a><blockquote class="code"><p class="quoted">
Section SR4/7 - Searching and sorting tables
</p></blockquote>
<!-- END CODE -->
<p>The half-dozen phrases defined in this section of the Standard Rules are then indexed under the subheading &quot;Searching and sorting tables&quot;: Inform looks for a hyphen in the heading and then uses any text which follows the hyphen. (If there is no hyphen, the entire heading text is used.)</p>
<p>If an extension contains no headings, its phrases (or actions) are indexed simply as &quot;Miscellaneous&quot;.</p>
<p>Finally, any phrase or variable defined immediately under a heading whose name ends in the word &quot;unindexed&quot; will be omitted from the Phrasebook or Contents index respectively. (That won't apply to definitions under subheadings of the heading.) This is intended so that technical apparatus used only inside the extensions can be concealed from the outside user's immediate view. Inform as it is presently constituted does not allow extensions to make fully private definitions, but this feature at least allows them to make unadvertised ones.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s9" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s9" class="standardlink">Back to §27.9. Extensions can interact with other extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s11" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s11" class="standardlink">Onward to §27.11. Extension documentation</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s11"></a>§27.11. Extension documentation</p>
<p>A basic mechanism for documenting extensions is built into Inform. For many extensions, this will probably do instead of a manual; for more complex ones, it should still prove a useful supplement to one.</p>
<p>As described in Chapter 2 above, whenever an extension is installed, its documentation is made available to the user. Such text should be written concisely, while giving examples wherever appropriate. Stylistically, it should ideally follow the model of the main Inform documentation: just as an extension expands the standard rules, so its documentation expands this manual. &quot;We need...&quot; is preferred to &quot;You need...&quot;, and so on: we're all in this together.</p>
<p>In order to be recognised as documentation, this text should appear at the foot of the extension file, <span class="italic">after</span> the compulsory end sentence. The first paragraph must have exactly the following form, with a skipped line before and after:</p>
<!-- START CODE "c9043" -->
<a id="c9043"></a><blockquote class="code"><p class="quoted">
---- DOCUMENTATION ----
</p></blockquote>
<!-- END CODE -->
<p>For instance, the &quot;Ducking Action&quot; example might end:</p>
<!-- START CODE "c9044" -->
<a id="c9044"></a><blockquote class="code"><p class="quoted">
...
<br />The Ducking Action ends here.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9045" -->
<a id="c9045"></a><blockquote class="code"><p class="quoted">
---- DOCUMENTATION ----
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9046" -->
<a id="c9046"></a><blockquote class="code"><p class="quoted">
This is a modest extension, with much to be modest about. It allows us to use a new action for ducking, as in ducking the player's head (not as in ducking a witch). Ducking will do nothing unless rules are added:
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9047" -->
<a id="c9047"></a><blockquote class="code"><p class="quoted">
&#160;&#160;&#160;&#160;Instead of ducking in the Shooting Gallery, say &quot;Too late!&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9048" -->
<a id="c9048"></a><blockquote class="code"><p class="quoted">
...
</p></blockquote>
<!-- END CODE -->
<p>We obtain indented code examples by beginning a line with a tab. A double indentation can be got with two tabs in a row, and so forth. (Beware: some text editors, or emailers, flatten tabs into a row of four or perhaps eight spaces each. Inform will not recognise such a line of spaces as a tab.)</p>
<p>Note that text in square brackets should be avoided in the documentation, because that's taken as being comment matter on the extension, and omitted.</p>
<p>Tables should be similarly indented, and should begin with the word &quot;Table ...&quot;: the top line is taken to be the name of the table, and subsequent lines are tab-divided columns. Inform will automatically group this into a table, like so:</p>
<!-- START CODE "c9049" -->
<a id="c9049"></a><blockquote class="code"><p class="quoted">
Table of Exemplariness
<br /></p></blockquote><table class="codetable">
<tr><td class="quotedtablecell"><p class="quoted">stellar object</p></td><td class="quotedtablecell"><p class="quoted">example</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">galaxy</p></td><td class="quotedtablecell"><p class="quoted">&quot;Andromeda Galaxy M31&quot;</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">star</p></td><td class="quotedtablecell"><p class="quoted">&quot;Sirius&quot;</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">planet</p></td><td class="quotedtablecell"><p class="quoted">&quot;Neptune&quot;</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">moon</p></td><td class="quotedtablecell"><p class="quoted">&quot;Enceladus&quot;</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">dwarf planet</p></td><td class="quotedtablecell"><p class="quoted">&quot;Ceres&quot;</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">plutino</p></td><td class="quotedtablecell"><p class="quoted">&quot;38628 Huya&quot;</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">cubewano</p></td><td class="quotedtablecell"><p class="quoted">&quot;Easterbunny&quot;</p></td></tr>
</table><blockquote><p>
</p></blockquote>
<!-- END CODE -->
<p>(Footnote: Since the first appearance of this book, Easterbunny has been renamed Makemake, the creator god in the mythology of the people of Easter Island.)</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s10" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s10" class="standardlink">Back to §27.10. Extensions in the Index</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s12" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s12" class="standardlink">Onward to §27.12. Examples and headings in extension documentation</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s12"></a>§27.12. Examples and headings in extension documentation</p>
<p>Extensions with very large amounts of documentation can, if the author chooses, divide the material up using headings and/or subheadings. These must be written as paragraphs exactly like so:</p>
<!-- START CODE "c9050" -->
<a id="c9050"></a><blockquote class="code"><p class="quoted">
Chapter: Avoiding Events
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9051" -->
<a id="c9051"></a><blockquote class="code"><p class="quoted">
Section: Ducking examinations and tests
</p></blockquote>
<!-- END CODE -->
<p>Inform will then typeset them to stand out, will number them automatically, and will add a table of contents at the top of the page. (For most extensions, the documentation will be short and sweet, and this would just be clutter: headings and subheadings are best used only where the text would otherwise be difficult to read.)</p>
<p>Any extension's documentation can contain Examples, just as the main Inform documentation does: these are automatically labelled A, B, C, ... rather than given numbers, to ensure that they do not clash with the numbering used in the built-in chapters. (The labels may be helpful in writing an extension's documentation: we can write, for instance, a note such as &quot;see Example C below&quot;.)</p>
<p>Examples must be given last in the documentation, and there can be up to 26 of them, though most extensions will need one example at the most, and some will have none at all. Each example must begin with a paragraph exactly like so:</p>
<!-- START CODE "c9052" -->
<a id="c9052"></a><blockquote class="code"><p class="quoted">
Example: ** We Must Perform a Quirkafleeg - Ducking to avoid arrows as one proceeds east across battlements.
</p></blockquote>
<!-- END CODE -->
<p>Again, there must be a skipped line before and after. The row of asterisks must be *, **, *** or ****, just as in the main documentation, which we should follow on all points of style. The rest of the line contains the title, a hyphen, and then the description. The title should be given with Each Word except Prepositions and Similar Things Capitalized, while the description should look like a sentence, and end with a full stop.</p>
<p>The text of the example follows, of course, and continues until the end of the file, or the next &quot;Example:&quot; line, whichever comes first.</p>
<p>Each example should (normally) contain one single, complete, story, long enough to demonstrate the use of the extension and to have a little flavour to it, but not so long that the reader gets lost. It should have a title, which should match the name of the example (in the case above, &quot;We Must Perform a Quirkafleeg&quot;). It should conclude with a paragraph defining a test:</p>
<!-- START CODE "c9053" -->
<a id="c9053"></a><blockquote class="code"><p class="quoted">
Test me with &quot;east / duck / east / jump / east / duck / east / rescue esmerelda&quot;.
</p></blockquote>
<!-- END CODE -->
<p>The idea is that typing one single command, TEST ME, into the resulting story should show off what the extension does.</p>
<p>When an extension contains more than one example, they should be given in order of asterisk rating, that is, starting with the * examples, then the ** examples, and so on up.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s11" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s11" class="standardlink">Back to §27.11. Extension documentation</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s13" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s13" class="standardlink">Onward to §27.13. Implications</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s13"></a>§27.13. Implications</p>
<p>Extensions often need to define new kinds or properties, which we want to make as helpful as possible for the user. In particular, we want them not to require additional work for the author just to obtain the effect which seems only natural.</p>
<p>For example, consider Inform's built-in &quot;locked&quot; property. If a door is locked, then it cannot be opened, which seems fair enough. But if the player tries to unlock the door, he might then find the following response:</p>
<!-- START CODE "c9054" -->
<a id="c9054"></a><blockquote class="code"><p class="quoted">
That doesn't seem to be something you can unlock.
</p></blockquote>
<!-- END CODE -->
<p>Which does not seem right. In real life, almost all locked items have outwardly exposed locks which it is perfectly sensible to try to unlock, given a key. The problem is that our door has the &quot;locked&quot; property, but not the &quot;lockable&quot; one.</p>
<p>The Standard Rules solve this problem by including the following line:</p>
<!-- START CODE "c9055" -->
<a id="c9055"></a><blockquote class="code"><p class="quoted">
Something locked is usually lockable.
</p></blockquote>
<!-- END CODE -->
<p>This ensures that any door said by the author only to be &quot;locked&quot; will be &quot;lockable&quot; as well, and adds a small but worthwhile touch of realism.</p>
<p>Such a sentence is called an &quot;implication&quot;, as it is in the form &quot;Condition A implies Condition B&quot;. Note that the two conditions must consist of either/or properties with or without kinds attached. Thus:</p>
<!-- START CODE "c9056" -->
<a id="c9056"></a><blockquote class="code"><p class="quoted">
A room in the Open Desert is usually lighted.
</p></blockquote>
<!-- END CODE -->
<p>will not work because &quot;a room in the Open Desert&quot; is a more complicated grammatical construction than, say, &quot;lighted&quot; or &quot;a lighted room&quot;: it contains a relative clause. Inform can only deal with simple implications.</p>
<p>Inform never overrides certainties with mere implications, and is cautious about allowing them to build overly long chains of argument. This is to prevent the following kind of difficulty:</p>
<!-- START CODE "c9057" -->
<a id="c9057"></a><blockquote class="code"><p class="quoted">
An open door is usually closed. A closed door is usually open.
</p></blockquote>
<!-- END CODE -->
<p>Implications work just the same for values which aren't objects, so:</p>
<!-- START CODE "c9058" -->
<a id="c9058"></a><blockquote class="code"><p class="quoted">
Colour is a kind of value. The colours are red, green and blue.
<br />A colour can be zesty or flat. A colour can be bright or dull.
<br />Red and blue are bright. Blue is flat.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9059" -->
<a id="c9059"></a><blockquote class="code"><p class="quoted">
A bright colour is usually zesty.
</p></blockquote>
<!-- END CODE -->
<p>results in red being zesty, but blue and green being flat; blue because the source text explicitly says so (which trumps the &quot;usually&quot;), and green because this isn't a bright colour, so the implication doesn't arise.</p>
<p>Implications have not been mentioned up to now since they are only really needed by extensions, but also because they can be tricky, with unforeseen consequences. We should handle them with care.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s12" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s12" class="standardlink">Back to §27.12. Examples and headings in extension documentation</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s14" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s14" class="standardlink">Onward to §27.14. Using Inform 6 within Inform 7</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s14"></a>§27.14. Using Inform 6 within Inform 7</p>
<p>To return to what was said on the first page of this documentation: Inform 7 (or I7), the current version, is not at all like Inform 6 (or I6). Internally, however, I7 works by translating the source text into an I6 program, so that in a practical sense the current version of Inform actually contains its predecessor.</p>
<p>The final sections of this chapter show how I6 code can be mixed directly in with I7. The remaining pages will therefore make little or no sense to those who do not already use I6. But for those who do know I6 already, it would be all too easy to write highly hybridised code, constantly mixing I6 and I7. The authors of Inform hope that this will not happen: for almost all purposes, I7 is much more powerful than I6, and fails - when it has to fail - in a way more helpful to the user. Ideally, all I6 content would be confined to extensions (and this may be mandated in future releases of Inform), and even writers of extensions are asked to pare down their usage of I6 to the minimum necessary.</p>
<p>The methods for incorporating I6 code into I7 have been designed with this in mind, that is, to encourage people to use I6 in as self-contained a way as possible: in particular to isolate the relatively few functions which need to be written in I6, and to give them natural language expression.</p>
<p>Finally, anyone hacking with I7 for a while is likely to become curious about the Standard Rules file, and to look at the text on which the Inform world model is founded. The file is, of course, no secret, but it can be misleading. For one thing, it appears to have great freedom to set up the world model as it pleases, but in fact the I7 compiler may well crash unless certain things are done just so in the Standard Rules: they depend on each other.</p>
<p>Moreover, the Standard Rules use a number of syntaxes which are not documented in this chapter: these are constantly being altered, and it would not be safe to imitate them. Any I6-related syntax which is not documented in this chapter may be removed or changed in effect at any time without warning, for instance in an update of Inform to fix bugs.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s13" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s13" class="standardlink">Back to §27.13. Implications</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s15" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s15" class="standardlink">Onward to §27.15. Defining phrases in Inform 6</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s15"></a>§27.15. Defining phrases in Inform 6</p>
<p>The phrases described in this documentation, such as &quot;end the story&quot;, are all defined in the Standard Rules, and are for the most part defined not in terms of other I7 phrases but instead reduced to equivalents in I6. For instance:</p>
<!-- START CODE "c9060" -->
<a id="c9060"></a><blockquote class="code"><p class="quoted">
To end the story (- deadflag=3; story_complete=false; -).
</p></blockquote>
<!-- END CODE -->
<p>The notation &quot;(-&quot; and &quot;-)&quot; indicates that what comes in between is I6 code. The minus sign is supposed to be a mnemonic for the decrease from 7 to 6: later we shall use &quot;(+&quot; and &quot;+)&quot; to go back up the other way, from 6 to 7.</p>
<p>When a phrase is defined as containing only a single command, and that command is defined using I6 - as here - it is compiled in-line. This means that the phrase &quot;end the story&quot; will always be translated as &quot;deadflag=3; story_complete=false;&quot;, rather than being translated into a call to a suitable function whose only statement is &quot;deadflag=3; story_complete=false;&quot;.</p>
<p>This is an easy case since the wording never varies. More typical examples would be:</p>
<!-- START CODE "c9061" -->
<a id="c9061"></a><blockquote class="code"><p class="quoted">
To say (something - number): (- print {something}; -).
<br />To sort (T - table name) in (TC - table column) order:
<br />&#160;&#160;&#160;&#160;(- TableSort({T}, {TC}, 1); -).
</p></blockquote>
<!-- END CODE -->
<p>When the braced name of one of the variables in the phrase preamble appears, this is compiled to the corresponding I6 expression at the relevant position in the I6 code. So, for instance,</p>
<!-- START CODE "c9062" -->
<a id="c9062"></a><blockquote class="code"><p class="quoted">
say the capacity of the basket
</p></blockquote>
<!-- END CODE -->
<p>might be compiled to</p>
<!-- START CODE "c9063" -->
<a id="c9063"></a><blockquote class="code"><p class="quoted">
print O17_basket.capacity;
</p></blockquote>
<!-- END CODE -->
<p>because &quot;{something}&quot; is expanded to &quot;capacity of the basket&quot; (I7 code) and then translated to &quot;O17_basket.capacity&quot; (I6 code), which is then spliced into the original I6 definition &quot;print {something};&quot;.</p>
<p>Braces &quot;{&quot; are of course significant in I6. A real brace can be obtained by making the character following it a space, and then I7 will not attempt to read it as a request for substitution.</p>
<p>It's also possible for the pair of characters &quot;-)&quot; to occur in I6 code, for example here:</p>
<!-- START CODE "c9064" -->
<a id="c9064"></a><blockquote class="code"><p class="quoted">
for (i=3 : i&gt;0 : i--)
</p></blockquote>
<!-- END CODE -->
<p>and I7 will read the &quot;-)&quot; as terminating the I6; we can get around this with an extra space:</p>
<!-- START CODE "c9065" -->
<a id="c9065"></a><blockquote class="code"><p class="quoted">
for (i=3 : i&gt;0 : i-- )
</p></blockquote>
<!-- END CODE -->
<p>Warning: Inform 6 uses a restricted character set, allowing use of most of the accented characters in ISO Latin-1 (those found in a set called ZSCII) but little beyond that. It's therefore hazardous to use any exotic Unicode characters in an inclusion.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s14" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s14" class="standardlink">Back to §27.14. Using Inform 6 within Inform 7</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s16" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s16" class="standardlink">Onward to §27.16. Phrases to decide in Inform 6</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#e168" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_27.html#e168" class="standardlink">Example 451: <img class="asterisk" alt="*" src="images/asterisk.png" /><img class="asterisk" alt="*" src="images/asterisk.png" /><img class="asterisk" alt="*" src="images/asterisk.png" /> <b>Pink or Blue</b>&#160;&#160;&#160; Asking the player to select a gender to begin play.</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s16"></a>§27.16. Phrases to decide in Inform 6</p>
<p>There are basically three forms of phrase in I7: phrases which do something, but produce no value or opinion as a result; phrases to decide whether or not something is true; and phrases to decide on a value. We have already seen examples of writing the first form in I6:</p>
<!-- START CODE "c9066" -->
<a id="c9066"></a><blockquote class="code"><p class="quoted">
To say (something - number): (- print {something}; -).
</p></blockquote>
<!-- END CODE -->
<p>Here the I6 form is required to be I6 routine code in void context, that is, it will normally be one or more statements each of which ends in a semicolon (unless there are braced code blocks present). In this case, we have just one I6 statement, ending in a semicolon.</p>
<p>An example of a phrase to decide whether something is true would be:</p>
<!-- START CODE "c9067" -->
<a id="c9067"></a><blockquote class="code"><p class="quoted">
To decide whether in darkness: (- (location==thedark) -).
</p></blockquote>
<!-- END CODE -->
<p>Here the I6 code providing the definition must be a valid I6 condition, and be in round brackets, but there is no semicolon.</p>
<p>Lastly, an example of a phrase to decide on a value:</p>
<!-- START CODE "c9068" -->
<a id="c9068"></a><blockquote class="code"><p class="quoted">
To decide which number is the hours part of (t - time): (- ({t}/60) -).
</p></blockquote>
<!-- END CODE -->
<p>Again, this is a value in I6 as well: no semicolon. It is probably safest to place the value in round brackets.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s15" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s15" class="standardlink">Back to §27.15. Defining phrases in Inform 6</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s17" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s17" class="standardlink">Onward to §27.17. Handling phrase options</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s17"></a>§27.17. Handling phrase options</p>
<p>The Standard Rules use the Inform list-writer with the following definition, which shows how a much more complicated I6 routine can be given a natural-language expression.</p>
<!-- START CODE "c9069" -->
<a id="c9069"></a><blockquote class="code"><p class="quoted">
To list the contents of (O - an object),
<br />&#160;&#160;&#160;&#160;with newlines,
<br />&#160;&#160;&#160;&#160;indented,
<br />&#160;&#160;&#160;&#160;giving inventory information,
<br />&#160;&#160;&#160;&#160;as a sentence,
<br />&#160;&#160;&#160;&#160;including contents,
<br />&#160;&#160;&#160;&#160;including all contents,
<br />&#160;&#160;&#160;&#160;tersely,
<br />&#160;&#160;&#160;&#160;giving brief inventory information,
<br />&#160;&#160;&#160;&#160;using the definite article,
<br />&#160;&#160;&#160;&#160;listing marked items only,
<br />&#160;&#160;&#160;&#160;prefacing with is/are,
<br />&#160;&#160;&#160;&#160;not listing concealed items,
<br />&#160;&#160;&#160;&#160;suppressing all articles
<br />&#160;&#160;&#160;&#160;and/or with extra indentation:
<br />&#160;&#160;&#160;&#160;(- I7WriteListFrom(child({O}), {phrase options}); -).
</p></blockquote>
<!-- END CODE -->
<p>This can be used by, say:</p>
<!-- START CODE "c9070" -->
<a id="c9070"></a><blockquote class="code"><p class="quoted">
list the contents of O, as a sentence, using the definite article
</p></blockquote>
<!-- END CODE -->
<p>&quot;{phrase options}&quot; is a special substitution: it is a bitmap which assigns the given options one bit each, starting with the least significant bit for the first-mentioned option (&quot;with newlines&quot; above) and going up to the most significant bit for the last (&quot;with extra indentation&quot;).</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s16" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s16" class="standardlink">Back to §27.16. Phrases to decide in Inform 6</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s18" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s18" class="standardlink">Onward to §27.18. Making and testing use options</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s18"></a>§27.18. Making and testing use options</p>
<p>Use options (see Chapter 2 above) manifest themselves in the I6 code generated by I7 as constants which are either defined, or not. For instance, the &quot;use American dialect&quot; option results in the constant DIALECT_US being defined, a constant which otherwise would not be. Some use options define the constant as a particular value, others simply define it (so that I6 gives this constant the value 0).</p>
<p>New use options can be created as in the following examples, which are found in the Standard Rules:</p>
<!-- START CODE "c9071" -->
<a id="c9071"></a><blockquote class="code"><p class="quoted">
Use American dialect translates as (- Constant DIALECT_US; -).
<br />Use full-length room descriptions translates as (- Constant I7_LOOKMODE = 2; -).
</p></blockquote>
<!-- END CODE -->
<p>Most Inform users will not need to test whether a use option is currently set: after all, they will know whether or not their own story uses American dialect. But an extension does not know what use options apply in the story which is using it. An extension which needs to print a list, using its own formatting, might want to know whether &quot;use serial comma&quot; is set. Or it might want to speak differently in American dialect.</p>
<p>To test for American dialect, we should ideally not use I6 to look for the constant DIALECT_US using #ifdef: there is no guarantee that this constant will not be renamed at some point. Instead we can perform the test directly in I7:</p>
<!-- START CODE "c9072" -->
<a id="c9072"></a><blockquote class="code"><p class="quoted">
if the American dialect option is active, ...
</p></blockquote>
<!-- END CODE -->
<p>and similarly for all other named use options. The adjectives &quot;active&quot; and &quot;inactive&quot; have the obvious meanings for use options. This means it's possible to describe the current options like so:</p>
<!-- START CODE "c9073" -->
<a id="c9073"></a><blockquote class="code"><p class="quoted">
say &quot;We're currently using: [list of active use options].&quot;;
</p></blockquote>
<!-- END CODE -->
<p>The result might be, say,</p>
<!-- START CODE "c9074" -->
<a id="c9074"></a><blockquote class="code"><p class="quoted">
We're currently using: dynamic memory allocation option [8192], maximum text length option [1024], maximum things understood at once option [100], American dialect option and fast route-finding option.
</p></blockquote>
<!-- END CODE -->
<p>This may be useful for testing purposes.</p>
<p>Use options can also allow the writer to raise certain maximum values. If we write an extension which needs some I6 array, say, and therefore has some limitation - for instance a footnotes presenter which can handle at most 100 footnotes before its array space runs out - it would obviously be cleaner to allow this maximum to be raised. We can set this up like so:</p>
<!-- START CODE "c9075" -->
<a id="c9075"></a><blockquote class="code"><p class="quoted">
Use maximum presented footnotes of at least 100 translates as (- Constant MAX_PRESENTED_FOOTNOTES = {N}; -).
</p></blockquote>
<!-- END CODE -->
<p>With such a definition, the number given is the default value, and the I6 source is included whether or not anybody uses the option: the default value being given if nobody does. The text &quot;{N}&quot; is replaced with the value. So the above definition normally results in this being defined:</p>
<!-- START CODE "c9076" -->
<a id="c9076"></a><blockquote class="code"><p class="quoted">
Constant MAX_PRESENTED_FOOTNOTES = 100;
</p></blockquote>
<!-- END CODE -->
<p>but if the user writes</p>
<!-- START CODE "c9077" -->
<a id="c9077"></a><blockquote class="code"><p class="quoted">
Use maximum presented footnotes of at least 350.
</p></blockquote>
<!-- END CODE -->
<p>then instead the I6 inclusion becomes:</p>
<!-- START CODE "c9078" -->
<a id="c9078"></a><blockquote class="code"><p class="quoted">
Constant MAX_PRESENTED_FOOTNOTES = 350;
</p></blockquote>
<!-- END CODE -->
<p>The I6 constant MAX_PRESENTED_FOOTNOTES can then be used as the size of an array, for instance.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s17" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s17" class="standardlink">Back to §27.17. Handling phrase options</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s19" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s19" class="standardlink">Onward to §27.19. Longer extracts of Inform 6 code</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s19"></a>§27.19. Longer extracts of Inform 6 code</p>
<p>Whole routines, object and class definitions (or any other directives) can be pasted in wholesale using sentences like so:</p>
<!-- START CODE "c9079" -->
<a id="c9079"></a><blockquote class="code"><p class="quoted">
Include (-
<br />[ MyInform6Routine a b; return a*b; ];
<br />-).
</p></blockquote>
<!-- END CODE -->
<p>Such inclusions are pasted into the final compiled code at the end of the file, after the I6 grammar has been declared.</p>
<p>In such extracts, we sometimes need to refer to objects, variables or values which can't be described using I6: or rather, which can be described, but we don't know how. To this end, any text in an inclusion written in &quot;(+&quot; and &quot;+)&quot; parentheses is treated as an I7 value, and compiled accordingly, with all type-checking waived for the occasion. For instance:</p>
<!-- START CODE "c9080" -->
<a id="c9080"></a><blockquote class="code"><p class="quoted">
Include (-
<br />Global my_global = (+ the tartan rucksack +);
<br />-).
</p></blockquote>
<!-- END CODE -->
<p>Here &quot;the tartan rucksack&quot; is translated into &quot;O18_tartan_rucksack&quot;, or something similar: the I6 object created to represent the rucksack. Thus the actual line of code produced is</p>
<!-- START CODE "c9081" -->
<a id="c9081"></a><blockquote class="code"><p class="quoted">
Global my_global = O18_tartan_rucksack;
</p></blockquote>
<!-- END CODE -->
<p>The material between &quot;(+&quot; and &quot;+)&quot; is generally treated as a value, and thus compiles to the I6 form of that value. But it could also be a property name, which compiles to the I6 form in question, or a defined adjective, which compiles to the name of the routine to call which tests whether that adjective is true.</p>
<p><span class="boldface">Three warnings.</span> The material in &quot;(-&quot; and &quot;-)&quot; is called template code, and it is not quite treated as literal. That means certain characters cause Inform to react:</p>
<p>1. Beware of accidental &quot;(+&quot; usage - for instance,</p>
<!-- START CODE "c9082" -->
<a id="c9082"></a><blockquote class="code"><p class="quoted">
Include (-
<br />[ MyCleverLoop i; for (++i; i&lt;10; i++) print i; ];
<br />-).
</p></blockquote>
<!-- END CODE -->
<p>looks reasonable, but contains &quot;(+&quot; and &quot;+)&quot;. Spaces around the first &quot;++&quot; would have been enough to avoid this one; &quot;+)&quot; is only significant where it follows a &quot;(+&quot;.</p>
<p>2. Beware of placing an &quot;@&quot; character in the first column, that is, immediately following a new line. (In template code this marks off paragraph divisions.) So for instance,</p>
<!-- START CODE "c9083" -->
<a id="c9083"></a><blockquote class="code"><p class="quoted">
Include (-
<br />[ Set_Stream ret;
<br />@glk 67 ret;
<br />];
<br />-).
</p></blockquote>
<!-- END CODE -->
<p>is tripped up by the Glulx assembly language opcode &quot;@glk&quot; because this occurs in column 1. Indenting it with a little space or a tab is enough to avoid the problem.</p>
<p>3. Be careful if you're creating an I6 variable holding initialised I7 text. For example,</p>
<!-- START CODE "c9084" -->
<a id="c9084"></a><blockquote class="code"><p class="quoted">
Include (-
<br />Global saved_optional_prompt = (+ &quot;!!&gt;&quot; +);
<br />-) after &quot;Definitions.i6t&quot;.
</p></blockquote>
<!-- END CODE -->
<p>looks as if it will work, but doesn't, for reference-counting reasons we needn't go into; instead you need</p>
<!-- START CODE "c9085" -->
<a id="c9085"></a><blockquote class="code"><p class="quoted">
Include (-
<br />Array sop_storage --&gt; PACKED_TEXT_STORAGE &quot;!!&gt;&quot;;
<br />Global saved_optional_prompt = sop_storage;
<br />-) after &quot;Definitions.i6t&quot;.
</p></blockquote>
<!-- END CODE -->
<p>But it's far better to avoid initialising text variables from I6 entirely. The same problems arise with constant lists.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s18" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s18" class="standardlink">Back to §27.18. Making and testing use options</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s20" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s20" class="standardlink">Onward to §27.20. Primitive Inform 6 declarations of rules</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#e395" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_27.html#e395" class="standardlink">Example 452: <img class="asterisk" alt="*" src="images/asterisk.png" /> <b>Status line with centered text, the hard way</b>&#160;&#160;&#160; A status line which has only the name of the location, centered.</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s20"></a>§27.20. Primitive Inform 6 declarations of rules</p>
<p>By writing a sentence like this:</p>
<!-- START CODE "c9086" -->
<a id="c9086"></a><blockquote class="code"><p class="quoted">
The underground rule translates into I6 as &quot;UNDERGROUND_R&quot;.
</p></blockquote>
<!-- END CODE -->
<p>we create a new rule, the &quot;underground rule&quot;, and also notify Inform that it will have no definition as I7 source text: instead, it will be provided as an I6 routine called &quot;UNDERGROUND_R&quot;. We can define this with an Include like so:</p>
<!-- START CODE "c9087" -->
<a id="c9087"></a><blockquote class="code"><p class="quoted">
Include (-
<br />[ UNDERGROUND_R;
<br />&#160;&#160;&#160;&#160;if (real_location hasnt light) { RulebookSucceeds(); rtrue; }
<br />&#160;&#160;&#160;&#160;rfalse;
<br />];
<br />-).
</p></blockquote>
<!-- END CODE -->
<p>The rule should return false if it wants to make no decision, but call either RulebookSucceeds or RulebookFails and return true if it does. These routines can optionally take an argument: which will be the return value from the rulebook.</p>
<p>Note that UNDERGROUND_R itself has no arguments. In the case of an action based rulebook, the I6 variables noun, second and actor can be referred to, while for a value based rulebook the parameter is stored in the I6 global variable parameter_object (which is not necessarily an object, in spite of the name).</p>
<p>We can put this rule into a rulebook in the same way that any named rule can be:</p>
<!-- START CODE "c9088" -->
<a id="c9088"></a><blockquote class="code"><p class="quoted">
The underground rule is listed in the spot danger rules.
</p></blockquote>
<!-- END CODE -->
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s19" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s19" class="standardlink">Back to §27.19. Longer extracts of Inform 6 code</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s21" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s21" class="standardlink">Onward to §27.21. Inform 6 objects and classes</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s21"></a>§27.21. Inform 6 objects and classes</p>
<p>As might be expected, I7 compiles an I6 class for each kind, and an I6 object for each of its own objects. We can meddle with its compilation process here using a further refinement of Include. For instance, suppose we want the I6 class definition for things to come out containing a property like this:</p>
<!-- START CODE "c9089" -->
<a id="c9089"></a><blockquote class="code"><p class="quoted">
Class K2_thing ...
<br />&#160;&#160;&#160;&#160;with marmalade_jar_size 6,
<br />&#160;&#160;&#160;&#160;...
</p></blockquote>
<!-- END CODE -->
<p>How to arrange this? One way is to create an ordinary I7 property, like so:</p>
<!-- START CODE "c9090" -->
<a id="c9090"></a><blockquote class="code"><p class="quoted">
A thing has a number called marmalade jar size. The marmalade jar size of a thing is usually 6. The marmalade jar size property translates into I6 as &quot;marmalade_jar_size&quot;.
</p></blockquote>
<!-- END CODE -->
<p>(Without that last sentence, the property won't get any familiar name.) But sometimes we need more, and want to actually write new material to go into the definition. This can be done like so:</p>
<!-- START CODE "c9091" -->
<a id="c9091"></a><blockquote class="code"><p class="quoted">
Include (- with before [; Go: return 1; ], -) when defining a vehicle.
</p></blockquote>
<!-- END CODE -->
<p>This glues in a new property to the class compiled to represent the I7 kind &quot;vehicle&quot;. (See the DM4 for why. However, since the entire actions machinery is different in the I7 world, note that &quot;after&quot;, &quot;react_before&quot; and &quot;react_after&quot; no longer have any effect, and nor does &quot;before&quot; for rooms.)</p>
<p>And similarly:</p>
<!-- START CODE "c9092" -->
<a id="c9092"></a><blockquote class="code"><p class="quoted">
Include (- has my_funny_attribute, -) when defining the hot air balloon.
</p></blockquote>
<!-- END CODE -->
<p>If we need a particular I7 object or kind to end up with a particular I6 name, we can write:</p>
<!-- START CODE "c9093" -->
<a id="c9093"></a><blockquote class="code"><p class="quoted">
The whatsit object translates into I6 as &quot;whatsit&quot;.
<br />The thingummy kind translates into I6 as &quot;thingummy_class&quot;.
</p></blockquote>
<!-- END CODE -->
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s20" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s20" class="standardlink">Back to §27.20. Primitive Inform 6 declarations of rules</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s22" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s22" class="standardlink">Onward to §27.22. Inform 6 variables, properties, actions, and attributes</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s22"></a>§27.22. Inform 6 variables, properties, actions, and attributes</p>
<p>I7's variables are usually compiled as entries in an array rather than as I6 variables. However, we can instead tell Inform to use an existing I6 variable (either one that we declare ourselves, or one in the I6 template layer). For example:</p>
<!-- START CODE "c9094" -->
<a id="c9094"></a><blockquote class="code"><p class="quoted">
Room description style is a kind of value. The room description styles are Brief, Verbose and Superbrief.
<br />The current room description style is a room description style that varies.
<br />The current room description style variable translates into I6 as &quot;lookmode&quot;.
</p></blockquote>
<!-- END CODE -->
<p>This is a feature provided to help I7 source text to use variables internal to the I6 template code. It can, if really necessary, also be used to give I7 names to entirely new I6-level variables, created like so:</p>
<!-- START CODE "c9095" -->
<a id="c9095"></a><blockquote class="code"><p class="quoted">
Include (- Global my_variable = 0; -) after &quot;Definitions.i6t&quot;.
</p></blockquote>
<!-- END CODE -->
<p>This style of hybrid coding is really not encouraged.</p>
<p>I7's properties are compiled sometimes as I6 properties, sometimes as I6 attributes, sometimes as bits in a bitmap somewhere. However, we can override I7 by telling it that one of its property names is equivalent to an already-existing I6 property or attribute: if so then I7 will use that name and will not compile any directive to create it. For example:</p>
<!-- START CODE "c9096" -->
<a id="c9096"></a><blockquote class="code"><p class="quoted">
The switched on property translates into I6 as &quot;on&quot;.
<br />The initial appearance property translates into I6 as &quot;initial&quot;.
</p></blockquote>
<!-- END CODE -->
<p>We do not need to translate &quot;switched off&quot;, the opposite to &quot;switched on&quot;: I7 will now compile this to &quot;~on&quot;.</p>
<p>Lastly, actions can also be translated (though it's usually better to translate their rules instead and invent new I7 actions covering them):</p>
<!-- START CODE "c9097" -->
<a id="c9097"></a><blockquote class="code"><p class="quoted">
The unlocking it with action translates into I6 as &quot;Unlock&quot;.
</p></blockquote>
<!-- END CODE -->
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s21" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s21" class="standardlink">Back to §27.21. Inform 6 objects and classes</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s23" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s23" class="standardlink">Onward to §27.23. Inform 6 Understand tokens</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s23"></a>§27.23. Inform 6 Understand tokens</p>
<p>The parser which deciphers the player's typed commands is written in I6, and many of the basic tokens of Understand grammar are implemented as &quot;general parsing routines&quot; (GPRs), the specification of which is described fully in the Inform 6 Designer's Manual. I7 translates much of the source text's Understand grammar into GPRs, and once again we can bypass this process and supply an Understand token directly as an I6 GPR. For example:</p>
<!-- START CODE "c9098" -->
<a id="c9098"></a><blockquote class="code"><p class="quoted">
The Understand token squiggle translates into I6 as &quot;SQUIGGLE_TOKEN&quot;.
</p></blockquote>
<!-- END CODE -->
<p>We then have to include a routine of that name into I7's output using the &quot;Include&quot; instruction, on which more later.</p>
<p>This creates a token &quot;[squiggle]&quot;; so for instance if the source text contains:</p>
<!-- START CODE "c9099" -->
<a id="c9099"></a><blockquote class="code"><p class="quoted">
Understand &quot;copy [squiggle]&quot; as ...
</p></blockquote>
<!-- END CODE -->
<p>then Inform would parse the command COPY FIGURE EIGHT by calling the SQUIGGLE_TOKEN routine as a GPR with the word marker at 2, that is, at the word FIGURE.</p>
<p>As always, this should be done only where there seems no better way, or where speed is very important. For any fairly simple range of possibilities, it's better to use the techniques in the Understand chapter, or to use unit specifications.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s22" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s22" class="standardlink">Back to §27.22. Inform 6 variables, properties, actions, and attributes</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s24" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s24" class="standardlink">Onward to §27.24. Inform 6 adjectives</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s24"></a>§27.24. Inform 6 adjectives</p>
<p>There are three ways to specify that an adjective is defined at the I6 level. For example:</p>
<!-- START CODE "c9100" -->
<a id="c9100"></a><blockquote class="code"><p class="quoted">
Definition: a number is prime rather than composite if I6 routine
<br />&#160;&#160;&#160;&#160;&quot;PRIMALITY_TEST&quot; says so (it is greater than 1 and is divisible only by itself and 1).
</p></blockquote>
<!-- END CODE -->
<p>Inform now actually tests if a number N is prime by calling PRIMALITY_TEST(N), and it assumes that we have also included such a routine in the output. The routine is expected to return true or false accordingly.</p>
<p>The text in brackets does nothing functional, but is the text used in the Lexicon dictionary part of the Phrasebook index for the user's benefit; it should be a brief definition. Extension authors are asked to provide these little definitions, so that their users won't be confused by blank lexicon entries.</p>
<p>The second way makes a more capable adjective, since it can not only be tested, but also made true or false using &quot;now&quot;. For example:</p>
<!-- START CODE "c9101" -->
<a id="c9101"></a><blockquote class="code"><p class="quoted">
Definition: a scene is crucial if I6 routine &quot;SceneCrucial&quot; makes it so
<br />&#160;&#160;&#160;&#160;(it is essential to winning).
</p></blockquote>
<!-- END CODE -->
<p>The difference here is &quot;makes it so&quot;, not &quot;says so&quot;, and as this implies, the routine has more power. &quot;SceneCrucial&quot; is called with two arguments: SceneCrucial(S, -1) tests whether the scene is crucial or not and returns true or false; SceneCrucial(S, true) must make it true; and SceneCrucial(S, false) must make it false. Another useful difference is that if the kind of value is one which is stored in block form (e.g. for an adjective applying to text), the routine is given a pointer to the block, not a fresh copy.</p>
<p>A third way to define an adjective, which should be used only if speed is exceptionally important, is to provide a &quot;schema&quot; - a sort of I6 macro, like those provided by the C preprocessor. For example:</p>
<!-- START CODE "c9102" -->
<a id="c9102"></a><blockquote class="code"><p class="quoted">
Definition: a rulebook is exciting if I6 condition
<br />&#160;&#160;&#160;&#160;&quot;excitement_array--&gt;(*1)==1&quot; says so (it is really wild).
</p></blockquote>
<!-- END CODE -->
<p>The escape &quot;*1&quot; is expanded to the value on which the adjective is being tested. (This is usually faster than calling a routine, but in case of side-effects, the &quot;*1&quot; should occur only once in the condition, just as with a C macro.) To repeat: if in doubt, use the I6 routine method above.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s23" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s23" class="standardlink">Back to §27.23. Inform 6 Understand tokens</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s25" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s25" class="standardlink">Onward to §27.25. Naming Unicode characters</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s25"></a>§27.25. Naming Unicode characters</p>
<p>Inform allows the Unicode characters to be identified either with a decimal number or by name, but it has none of the character names built-in, and for efficiency reasons it only learns them when necessary.</p>
<p>Users normally teach these names to Inform by including one of the extensions &quot;Unicode Character Names&quot; or &quot;Unicode Full Character Names&quot;, which consist of many hundreds of sentences like so:</p>
<!-- START CODE "c9103" -->
<a id="c9103"></a><blockquote class="code"><p class="quoted">
anticlockwise open circle arrow translates into Unicode as 8634.
</p></blockquote>
<!-- END CODE -->
<p>Nothing restricts this usage to those extensions.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s24" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s24" class="standardlink">Back to §27.24. Inform 6 adjectives</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s26" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s26" class="standardlink">Onward to §27.26. The template layer</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s26"></a>§27.26. The template layer</p>
<p>When Go is clicked, Inform translates the I7 source text into I6 code, but the directly translated code could not survive on its own: it needs a large body of supporting code, also written in I6, to sustain it. (Just as a program like iTunes or Firefox cannot run on a bare machine, but needs an operating system already up and running to support it.) Until 2008, this supporting code was provided by the I6 library, that is, the standard distribution of useful I6 code supplied with distributions of Inform 6.</p>
<p>However, the supporting code is now generated from a collection of about 35 &quot;segments&quot; of I6 code which together make up &quot;the template layer&quot;. The reason for the term &quot;template&quot; is that the segments are not quite directly copied into I7's output, but instead act as templates from which I7 generates code - the final output contains variations according to what the original source text needs.</p>
<p>Each segment has its own name, which looks like a leafname plus the &quot;.i6t&quot; filename extension (which stands for &quot;I6 template&quot;). Internally, a segment is itself divided up into named parts. For instance, the segment &quot;Relations.i6t&quot; contains a part called &quot;Symmetric One To One Relations&quot; which provides I6 routines for changing and testing such relations. There are more than 600 named parts across the template as a whole; it is quite a large program. An annotated, typeset version of the template - amounting to a roughly 500-page book - is available for download from the Inform website.</p>
<p>The most powerful use of &quot;Include&quot; allows code to included before, instead of or after any named part or segment in the template. For example:</p>
<!-- START CODE "c9104" -->
<a id="c9104"></a><blockquote class="code"><p class="quoted">
Include (- ... -) before &quot;Relations.i6t&quot;.
<br />Include (- ... -) instead of &quot;Relations.i6t&quot;.
<br />Include (- ... -) after &quot;Symmetric One To One Relations&quot; in &quot;Relations.i6t&quot;.
</p></blockquote>
<!-- END CODE -->
<p>Multiple such inclusions can be made for the same segment or part. If so, all will take effect in the case of &quot;before&quot; or &quot;after&quot;, but for &quot;instead of&quot; only the most recent one takes effect. Inclusions requested before, or after, a segment or part which has been replaced with &quot;instead of&quot; will take effect and appear before or after the code which appears instead of it.</p>
<p>The pre-2008 syntax</p>
<!-- START CODE "c9105" -->
<a id="c9105"></a><blockquote class="code"><p class="quoted">
Include (- ... -) before the library.
</p></blockquote>
<!-- END CODE -->
<p>has been withdrawn; the new syntax</p>
<!-- START CODE "c9106" -->
<a id="c9106"></a><blockquote class="code"><p class="quoted">
Include (- ... -) after &quot;Definitions.i6t&quot;.
</p></blockquote>
<!-- END CODE -->
<p>should have the same effect.</p>
<p>Template files are not written in literal I6, but in a marked-up, annotated form of I6 which has special transcription commands embedded into it. These commands should absolutely not be used except in the built-in template files, with one exception:</p>
<!-- START CODE "c9107" -->
<a id="c9107"></a><blockquote class="code"><p class="quoted">
{-segment:Flowers.i6t}
</p></blockquote>
<!-- END CODE -->
<p>places the whole of the template file &quot;Flowers.i6t&quot; in this position. The built-in template does not of course contain &quot;Flowers.i6t&quot;, but Inform allows the optional &quot;I6T&quot; subfolder of the &quot;.materials&quot; folder of a project to hold additional or replacement template files. Thus the project &quot;Botanic Gardens.inform&quot; might store:</p>
<!-- START CODE "c9108" -->
<a id="c9108"></a><blockquote class="code"><p class="quoted">
Botanic Gardens.materials/I6T/Flowers.i6t
</p></blockquote>
<!-- END CODE -->
<p>It could even contain:</p>
<!-- START CODE "c9109" -->
<a id="c9109"></a><blockquote class="code"><p class="quoted">
Botanic Gardens.materials/I6T/Relations.i6t
</p></blockquote>
<!-- END CODE -->
<p>in which case this would automatically be used instead of the built-in copy of &quot;Relations.i6t&quot;, without any change to the I7 source text being needed. In this way, projects can (if they need to) use partly or entirely customised templates.</p>
<p>One application of this might allow for chunks of I6 code generated by external utilities - Perl scripts, lex and yacc, or other code generators - by compiling those to suitable template files in .materials/I6T and then using an inclusion like</p>
<!-- START CODE "c9110" -->
<a id="c9110"></a><blockquote class="code"><p class="quoted">
Include (- {-segment:MyStuff.i6t} -).
</p></blockquote>
<!-- END CODE -->
<p>in the I7 source text.</p>
<p>Template hacking, as it's called, is a last resort. If there is any way to achieve the same ends by writing ordinary I7 source text, then that will always be better. If it is possible to write &quot;Include (- ... -)&quot; without mentioning any segment or part, that's much to be preferred, because it has more chance of continuing to work into the future when the template might have been rewritten.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s25" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s25" class="standardlink">Back to §27.25. Naming Unicode characters</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s27" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s27" class="standardlink">Onward to §27.27. Translating the language of play</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s27"></a>§27.27. Translating the language of play</p>
<p>The &quot;language of play&quot; is the natural language used to communicate with the player at run-time: this is normally English.</p>
<p>That means that it is difficult to write, say, Spanish-language IF using Inform 7, though heroic work by the Spanish IF community has overcome this. Inform 6 provided for translation by isolating its linguistic code in a part of the I6 library called the &quot;language definition file&quot;, which was normally &quot;English.h&quot;. Translations were gradually made to most major European languages, resulting in alternative language definition files called &quot;French.h&quot;, &quot;Italian.h&quot; and so on. Full details on how to write a language definition file were given in the Translations chapter of the DM4, that is, the fourth edition of the Inform 6 Designer's Manual.</p>
<p>In I7 the system is different. We use the template, not a library. Instead of providing a language definition file such as &quot;French.h&quot;, a translator should create an extension called something like &quot;French Language by Jacques Mensonge&quot;. (The language should be named in English, so &quot;French Language by ...&quot;, not &quot;Langue français by ...&quot;) This extension should then contain broadly the same material as an I6 language definition file, but written in a mostly higher-level way. See the extension &quot;English Language by Graham Nelson&quot; supplied with I7, which is included automatically by default.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s26" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s26" class="standardlink">Back to §27.26. The template layer</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s28" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s28" class="standardlink">Onward to §27.28. Segmented substitutions</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s28"></a>§27.28. Segmented substitutions</p>
<p>A &quot;segmented&quot; substitution is a syntax where text is placed between two or more different text substitutions. Examples include:</p>
<!-- START CODE "c9111" -->
<a id="c9111"></a><blockquote class="code"><p class="quoted">
&quot;This hotel is [if the player is female]just awful[otherwise]basic[end if].&quot;
<br />&quot;Annie [one of]dances[or]sulks[or]hangs out at Remo's[at random].&quot;
</p></blockquote>
<!-- END CODE -->
<p>To create such syntaxes, it is not enough just to define how each expands into I6 code: for one thing we may need to know about the later terms in order to expand the earlier ones, which is normally impossible, and for another thing, the individual text substitutions mean nothing in isolation. For instance, Inform produces a problem if the following is tried:</p>
<!-- START CODE "c9112" -->
<a id="c9112"></a><blockquote class="code"><p class="quoted">
&quot;The hotel [at random] is on fire.&quot;
</p></blockquote>
<!-- END CODE -->
<p>because &quot;[at random]&quot; is only legal when closing a &quot;[one of] ...&quot; construction. But if &quot;[at random]&quot; had been defined as just another text substitution, Inform would not have been able to detect such problems.</p>
<p>Inform therefore allows us to mark text substitutions as being any of three special kinds: beginning, in the middle of, or ending a segmented substitution. There can be any number of alternative forms for each of these three variants. The syntax policed is that</p>
<!-- START CODE "c9113" -->
<a id="c9113"></a><blockquote class="code"><p class="quoted">
(a) Any usage must lie entirely within a single say or piece of text.
<br />(b) It must begin with exactly one of the substitutions marked as &quot;beginning&quot;.
<br />(c) It can contain any number, including none, of the substitutions marked as &quot;continuing&quot; (if there are any).
<br />(d) It must end with exactly one of the substitutions marked as &quot;ending&quot;.
</p></blockquote>
<!-- END CODE -->
<p>A simple example:</p>
<!-- START CODE "c9114" -->
<a id="c9114"></a><blockquote class="code"><p class="quoted">
To say emphasis on -- beginning say_emphasis_on: (- style underline; -).
<br />To say emphasis off -- ending say_emphasis_on: (- style roman; -).
</p></blockquote>
<!-- END CODE -->
<p>This creates &quot;[emphasis on]&quot; and &quot;[emphasis off]&quot; such that they can only be used as a pair. The keyword &quot;say_emphasis_on&quot;, which must be a valid I6 identifier (and hence a single word), is never seen by the user: it is simply an ID token so that Inform can identify the construction to which these belong. (We recommend that anybody creating such constructions should choose an ID token which consists of the construction's name but with underscores in place of spaces: this means that the namespace for ID tokens will only clash if the primary definitions would have clashed in any case.)</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s27" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s27" class="standardlink">Back to §27.27. Translating the language of play</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s29" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s29" class="standardlink">Onward to §27.29. Invocation labels, counters and storage</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#e71" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_27.html#e71" class="standardlink">Example 453: <img class="asterisk" alt="*" src="images/asterisk.png" /> <b>Chanel Version 1</b>&#160;&#160;&#160; Making paired italic and boldface tags like those used by HTML for web pages.</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s29"></a>§27.29. Invocation labels, counters and storage</p>
<p>The process of expanding the I6 code which represents a phrase is called &quot;invocation&quot;. As we have seen, when a phrase is defined using a single piece of I6 code, invocation consists of copying out that I6 code, except that tokens in braces &quot;{thus}&quot; are replaced:</p>
<!-- START CODE "c9115" -->
<a id="c9115"></a><blockquote class="code"><p class="quoted">
To say (something - number): (- print {something}; -).
</p></blockquote>
<!-- END CODE -->
<p>Ordinarily the only token names allowed are those matching up with names in the prototype, as here, but we have already seen one special syntax: &quot;{phrase options}&quot;, which expands as a bitmap of the options chosen. And in fact the invocation language is larger still, as a skim through the Standard Rules will show. The notes below deliberately cover only some of its features: those which are likely to remain part of the permanent design of Inform, and which are adaptable to many uses. <span class="boldface">Please do not use any of the undocumented invocation syntaxes: they change frequently, without notice or even mention in the change log.</span></p>
<p>The first special syntaxes are textual tricks. {-delete} deletes the most recent character in the I6 expansion of the phrase so far. {-erase} erases the I6 expansion of the phrase so far. {-open-brace} and {-close-brace} produce literal &quot;{&quot; and &quot;}&quot; characters.</p>
<p>The following:</p>
<!-- START CODE "c9116" -->
<a id="c9116"></a><blockquote class="code"><p class="quoted">
{-counter:NAME}
<br />{-counter-up:NAME}
<br />{-zero-counter:NAME}
<br />{-counter-makes-array:NAME}
</p></blockquote>
<!-- END CODE -->
<p>create (if one does not already exist) a counter called NAME. This is initially zero, and can be reset back to zero using &quot;{-zero-counter:NAME}&quot;, which expands into no text. The token &quot;{-counter:NAME}&quot; expands into the current value of the counter, as a literal decimal number. The token &quot;{-counter-up:NAME}&quot; does the same, but then also increases it by one. Finally, the token &quot;{-counter-makes-array:NAME}&quot; expands to nothing, but tells Inform to create an &quot;--&gt;&quot; array called &quot;I7_ST_NAME&quot; which includes entries from 0 up to the final value of the NAME counter.</p>
<p>This allows each instance in the source text of a given phrase to have both (i) a unique ID number for that invocation, and (ii) its own word of run-time storage, which can allow it to have a state preserved in between times when it is executed. For example:</p>
<!-- START CODE "c9117" -->
<a id="c9117"></a><blockquote class="code"><p class="quoted">
To say once only -- beginning say_once_only:
<br />&#160;&#160;&#160;&#160;(- {-counter-makes-array:say_once_only}if (I7_ST_say_once_only--&gt;{-counter:say_once_only} == false) {-open-brace} I7_ST_say_once_only--&gt;{-counter-up:say_once_only} = true; -).
<br />To say end once only -- ending say_once_only:
<br />&#160;&#160;&#160;&#160;(- {-close-brace} -).
</p></blockquote>
<!-- END CODE -->
<p>To complete the tools available for defining a segmented substitution, we need a way for the definition of the head to know about the middle segments and the tail:</p>
<p>When invoking either the head or the tail, {-segment-count} expands to the literal decimal number of pieces of text in between the two, which is always one more than the number of middle segments, since the text comes in between the segments. When invoking any middle segment, {-segment-count} expands to the number of pieces of text so far -- thus it expands to 1 on the first middle segment invoked, 2 on the next, and so on.</p>
<p>Lastly {-final-segment-marker} expands to the I6 identifier which marks the end segment, or to I6_NULL if the end segment has no marker. The idea of markers is to enable the head's definition to know which of a number of choices has been used for the tail, supposing that this is a construction with a variety of legal endings. For example:</p>
<!-- START CODE "c9118" -->
<a id="c9118"></a><blockquote class="code"><p class="quoted">
To say emphasise -- beginning say_emphasise:
<br />&#160;&#160;&#160;&#160;(- style {-final-segment-marker}; -).
<br />To say with italics -- ending say_emphasise with marker underline:
<br />&#160;&#160;&#160;&#160;(- style roman; -).
<br />To say with fixed space type -- ending say_emphasise with marker fixed:
<br />&#160;&#160;&#160;&#160;(- style roman; -).
</p></blockquote>
<!-- END CODE -->
<p>The markers used for the tails here are &quot;underline&quot; and &quot;fixed&quot;, and when the head is invoked, the marker for its tail is expanded into the argument of I6's &quot;style&quot; statement.</p>
<p>The examples above are all to do with segmented substitutions, which is where they are most useful, but most of the syntaxes above work equally well for ordinary &quot;To...&quot; phrase definitions.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s28" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s28" class="standardlink">Back to §27.28. Segmented substitutions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s30" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_27.html#s30" class="standardlink">Onward to §27.30. To say one of</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s30"></a>§27.30. To say one of</p>
<p>Many of the invocation syntaxes described in the previous section are used in the definition by the Standard Rules of the &quot;[one of] ... [or] ... [purely at random]&quot; construction, so it makes a good example of how they can be used.</p>
<p>First, this is a segmented substitution with a single possible beginning (&quot;[one of]&quot;), a single possible middle (&quot;[or]&quot;) but a choice of many possible endings. Almost everything is compiled by the invocation of the beginning:</p>
<!-- START CODE "c9119" -->
<a id="c9119"></a><blockquote class="code"><p class="quoted">
To say one of -- beginning say_one_of (documented at phs_oneof): (-
<br />&#160;&#160;&#160;&#160;{-counter-makes-array:say_one_of}
<br />&#160;&#160;&#160;&#160;{-counter-makes-array:say_one_flag}
<br />&#160;&#160;&#160;&#160;if (I7_ST_say_one_flag--&gt;{-counter:say_one_flag} == false) {
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;I7_ST_say_one_of--&gt;{-counter:say_one_of} = {-final-segment-marker}(I7_ST_say_one_of--&gt;{-counter:say_one_of},
<br />{-segment-count});
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;I7_ST_say_one_flag--&gt;{-counter:say_one_flag} = true;
<br />&#160;&#160;&#160;&#160;}
<br />&#160;&#160;&#160;&#160;if (say__comp == false) I7_ST_say_one_flag--&gt;{-counter:say_one_flag}{-counter-up:say_one_flag} =
<br />false;
<br />&#160;&#160;&#160;&#160;switch ((I7_ST_say_one_of--&gt;{-counter:say_one_of}{-counter-up:say_one_of})%({-segment-count}+1)-1)
<br />{-open-brace}
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;0: -).
<br />To say or -- continuing say_one_of (documented at phs_or):
<br />&#160;&#160;&#160;&#160;(- @nop; {-segment-count}: -).
<br />To say purely at random -- ending say_one_of with marker I7_SOO_PAR (documented at phs_purelyrandom):
<br />&#160;&#160;&#160;&#160;(- {-close-brace} -).
</p></blockquote>
<!-- END CODE -->
<p>The 3rd invocation of this (say) might compile the following:</p>
<!-- START CODE "c9120" -->
<a id="c9120"></a><blockquote class="code"><p class="quoted">
I7_ST_say_one_of--&gt;2 = I7_SOO_PAR(I7_ST_say_one_of--&gt;2, 4);
<br />switch((I7_ST_say_one_of--&gt;2)%5 - 1) {
<br />&#160;&#160;&#160;&#160;0: ... first text ...
<br />&#160;&#160;&#160;&#160;1: ... second text ...
<br />&#160;&#160;&#160;&#160;2: ... third text ...
<br />&#160;&#160;&#160;&#160;3: ... fourth text ...
<br />}
</p></blockquote>
<!-- END CODE -->
<p>First, we notified Inform that it needs to allocate an array (I7_ST_say_one_of) providing storage associated with the counter &quot;say_one_of&quot;. This we used to count off individual invocations of &quot;[one of]&quot;, so that each would have its own word of storage - for the 3rd invocation, I7_ST_say_one_of--&gt;2. We then call a state-changing routine, in this case I7_SOO_PAR, which is allowed to know the previous state and also the number of options available, and which returns the new state. The state is supposed to be the option chosen last time, but that means that there are not 4, but 5 possibilities: 0 for &quot;there was no last time&quot;, then 1 to 4 for the possible outcomes. We reduce the state mod 5 to obtain the decision this time, and subtract 1 because it happens to be convenient to make the switch statement run from 0 to 3 rather than 1 to 4. (The reason we reduce the state mod 5 is to allow the state-changer to squirrel away secret information in the upper bits of the state, if it wants to. Note that subtracting one means that the switch value might be -1, which results in no text being printed: thus if the state-changer chooses 0, it can decide on none of the above.)</p>
<p>In this design, the marker attached to the choice of ending substitution is the name of the I6 state-changer: here is the I7_SOO_PAR routine.</p>
<!-- START CODE "c9121" -->
<a id="c9121"></a><blockquote class="code"><p class="quoted">
[ I7_SOO_PAR oldval count; if (count &lt;= 1) return count; return random(count); ];
</p></blockquote>
<!-- END CODE -->
<p>As it happens, this ignores the old value: after all, it is meant to be purely at random, and nothing could be less pure than taking the last outcome into consideration when choosing the next.</p>
<p>Note that the counter say_one_of is advanced in invocation of the head. It might seem that the tidier design, somehow, would be to advance the counter in the invocation of the tails, but this is not a good idea. In general it is not safe to assume that the counter will have the same value when the tail is invoked that it had when the head was invoked, because segmented say constructions can legally be nested in Inform strings. Because of this, it is best to deal with a counter entirely in a single invocation, either of the beginning or the ending.</p>
<p>Because &quot;[one of] ... [or] ...&quot; is such a useful construction - switching between alternative forms of text, which writers of IF very often do - the above implementation is intentionally left open for new endings to be added, and the examples below show how easily this can be done.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of Chapter 27: Extensions</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#s29" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_27.html#s29" class="standardlink">Back to §27.29. Invocation labels, counters and storage</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#e40" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_27.html#e40" class="standardlink">Example 454: <img class="asterisk" alt="*" src="images/asterisk.png" /> <b>Blink</b>&#160;&#160;&#160; Making a "by atmosphere" token, allowing us to design our own text variations such as "[one of]normal[or]gloomy[or]scary[by atmosphere]".</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_27.html#e398" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_27.html#e398" class="standardlink">Example 455: <img class="asterisk" alt="*" src="images/asterisk.png" /><img class="asterisk" alt="*" src="images/asterisk.png" /> <b>Uncommon Ground</b>&#160;&#160;&#160; Making a "by viewpoint" token, allowing us to design our own text variations such as "[show to yourself]quaint[to Lolita]thrilling[to everyone else]squalid[end show]" depending on the identity of the player at the moment.</a></td></tr>
</table><hr />
</div>
<div class="bookexamples">
<p class="chapterheading">Examples from Chapter 27: Extensions</p><table class="centredtable"><tr><td class="roadsigndirection"><a href="WI_27.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_27.html" class="standardlink">Start of this chapter</a></td></tr>
<tr><td class="roadsigndirection"><a href="examples_alphabetical.html" class="standardlink"><img alt="arrow-down-right.png" src="images/arrow-down-right.png" /></a></td><td><a href="examples_alphabetical.html" class="standardlink">Indexes of the examples</a></td></tr>
</table><!-- START EXAMPLE "449: Modern Conveniences" "e251" -->
<a id="e251"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_27.html#e251" class="eglink"><b>449</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_27.html#e251" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Modern Conveniences</span></b></a><br />Exemplifying the kind of source we might use in writing extensions for kitchen and bathroom appliances.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_8.html#e251"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example251">
<p>Suppose we want to write an extension or other portable code which defines a &quot;kitchen&quot; kind of room and a &quot;bathroom&quot; kind of room. All kitchen rooms we create in the future will automatically contain standard kitchen appliances: fridge, freezer, sink with taps, counters, cabinets, and a stovetop with built-in oven. Similarly, all bathrooms will have sinks, baths, cabinets, and toilets, and respond to some standard interactions.</p>
<p>We would do this with a standard assembly:</p>
<!-- START CODE "c9122_251" -->
<a id="c9122_251"></a><blockquote class="code"><p class="quoted">
&quot;Modern Conveniences&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9123_251" -->
<a id="c9123_251"></a><blockquote class="code"><p class="quoted">
Section 1 - Kitchens
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9124_251" -->
<a id="c9124_251"></a><blockquote class="code"><p class="quoted">
A kitchen is a kind of room.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9125_251" -->
<a id="c9125_251"></a><blockquote class="code"><p class="quoted">
A refrigerator is a kind of container. A refrigerator is usually closed and openable. A refrigerator is usually fixed in place. A refrigerator is usually scenery. Understand &quot;fridge&quot; as a refrigerator.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9126_251" -->
<a id="c9126_251"></a><blockquote class="code"><p class="quoted">
A freezer compartment is a kind of container. A freezer compartment is usually closed and openable. A freezer compartment is part of every refrigerator.
</p></blockquote>
<!-- END CODE -->
<p>Now: we're going to want many of the items in our kitchen to have switches, and to handle input sensibly regardless of whether the player types TURN ON STOVE or TURN ON STOVE SWITCH. (This is apparently a stove with only one burner.) For convenience, we'll define an &quot;includes&quot; relation:</p>
<!-- START CODE "c9127_251" -->
<a id="c9127_251"></a><blockquote class="code"><p class="quoted">
Inclusion relates a thing (called X) to a thing (called Y) when Y is part of X. The verb to include means the inclusion relation.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9128_251" -->
<a id="c9128_251"></a><blockquote class="code"><p class="quoted">
A stove is a kind of supporter. It is usually scenery.
<br />An oven is a kind of container. An oven is usually openable and closed. One oven is a part of every stove.
<br />A switch is a kind of device. A switch is part of every stove. A switch is part of every oven.
<br />Understand &quot;[something related by reversed incorporation] switch&quot; as a switch.
</p></blockquote>
<!-- END CODE -->
<p>What follows is fairly straightforward, but notice that we are somewhat obsessively naming every rule. This is much more important in extensions (where someone else may need to manipulate our code from within their own source) than it is when we are simply composing source text for ourselves.</p>
<!-- START CODE "c9129_251" -->
<a id="c9129_251"></a><blockquote class="code"><p class="quoted">
Setting action variables for opening a stove (this is the stove-opening rule):
<br />&#160;&#160;&#160;&#160;let relevant oven be a random oven which is part of the noun;
<br />&#160;&#160;&#160;&#160;now the noun is the relevant oven.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9130_251" -->
<a id="c9130_251"></a><blockquote class="code"><p class="quoted">
Setting action variables for switching on something which includes a switch (this is the redirecting switches for switching on rule):
<br />&#160;&#160;&#160;&#160;let relevant switch be a random switch which is part of the noun;
<br />&#160;&#160;&#160;&#160;now the noun is the relevant switch.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9131_251" -->
<a id="c9131_251"></a><blockquote class="code"><p class="quoted">
Setting action variables for switching off something which includes a switch (this is the redirecting switches for switching off rule):
<br />&#160;&#160;&#160;&#160;let relevant switch be a random switch which is part of the noun;
<br />&#160;&#160;&#160;&#160;now the noun is the relevant switch.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9132_251" -->
<a id="c9132_251"></a><blockquote class="code"><p class="quoted">
Before printing the name of a switch (called target) (this is the switch identification rule):
<br />&#160;&#160;&#160;&#160;say &quot;[random thing which includes the target] &quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9133_251" -->
<a id="c9133_251"></a><blockquote class="code"><p class="quoted">
A sink is a kind of container. A sink is usually fixed in place and scenery. A tap is a kind of switch. A tap is part of every sink. Understand &quot;faucet&quot; or &quot;taps&quot; as a tap. Understand &quot;[something related by reversed incorporation] tap/faucet/taps&quot; as a tap.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9134_251" -->
<a id="c9134_251"></a><blockquote class="code"><p class="quoted">
Instead of opening a tap, try switching on the noun. Instead of closing a tap, try switching off the noun.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9135_251" -->
<a id="c9135_251"></a><blockquote class="code"><p class="quoted">
Report switching on a tap (this is the standard report switching taps on rule):
<br />&#160;&#160;&#160;&#160;say &quot;You turn on [the noun].&quot; instead. [since &quot;switch on&quot; sounds weird in this context.]
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9136_251" -->
<a id="c9136_251"></a><blockquote class="code"><p class="quoted">
Report switching off a tap (this is the standard report switching taps off rule):
<br />&#160;&#160;&#160;&#160;say &quot;You turn off [the noun].&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9137_251" -->
<a id="c9137_251"></a><blockquote class="code"><p class="quoted">
After examining something which includes a switched on tap (called relevant tap) (this is the report flowing water rule):
<br />&#160;&#160;&#160;&#160;say &quot;The water is flowing from [the relevant tap].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9138_251" -->
<a id="c9138_251"></a><blockquote class="code"><p class="quoted">
A drain is a kind of container. A drain is part of every sink. Understand &quot;plughole&quot; as the drain. Understand &quot;[something related by reversed incorporation] drain/plughole&quot; as a drain.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9139_251" -->
<a id="c9139_251"></a><blockquote class="code"><p class="quoted">
 Instead of inserting something into a drain (this is the no clogging drains rule), say &quot;Pointless.&quot;
</p></blockquote>
<!-- END CODE -->
<p>This is probably about as far as we want to go in a generic simulation: it is tempting to code up water, drains down which the player can lose objects, sinks that get clogged and overflow, and so on; but the more we embellish in these ways, the more likely the end result would be disruptive to individual games. For right now what we're aiming for is something simple which provides the basic interactions a player might expect in this kind of room, but which does not have any significant implications for the surrounding world model.</p>
<p>A particularly conservative author might even want to make it turn out that the water has been shut off and nothing flows from the taps: in the extension documentation, we might want to include a line or two of example showing how this might be done by changing or removing the relevant rules of our extension.</p>
<!-- START CODE "c9140_251" -->
<a id="c9140_251"></a><blockquote class="code"><p class="quoted">
A cabinet is a kind of container. A cabinet is usually openable and closed. It is scenery.
<br />&#160;&#160;&#160;&#160;Understand &quot;cupboard&quot; or &quot;cupboards&quot; or &quot;cabinets&quot; as a cabinet.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9141_251" -->
<a id="c9141_251"></a><blockquote class="code"><p class="quoted">
A counter is a kind of supporter. It is scenery.
<br />&#160;&#160;&#160;&#160;Understand &quot;countertop&quot; as a counter.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9142_251" -->
<a id="c9142_251"></a><blockquote class="code"><p class="quoted">
A cabinet is in every kitchen.
<br />A counter is in every kitchen.
<br />A refrigerator is in every kitchen.
<br />A sink is in every kitchen.
<br />A stove is in every kitchen.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9143_251" -->
<a id="c9143_251"></a><blockquote class="code"><p class="quoted">
Section 2 - Bathrooms
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9144_251" -->
<a id="c9144_251"></a><blockquote class="code"><p class="quoted">
A bathroom is a kind of room.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9145_251" -->
<a id="c9145_251"></a><blockquote class="code"><p class="quoted">
A toilet is a kind of supporter. Understand &quot;john&quot; as a toilet. A toilet is usually fixed in place and enterable and scenery.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9146_251" -->
<a id="c9146_251"></a><blockquote class="code"><p class="quoted">
A bath is a kind of container. A bath is usually a fixed in place and enterable and scenery. A tap is part of every bath. A drain is part of every bath. Understand &quot;bathtub&quot; or &quot;shower&quot; as a bath.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9147_251" -->
<a id="c9147_251"></a><blockquote class="code"><p class="quoted">
A sink is in every bathroom.
<br />A toilet is in every bathroom.
<br />A bath is in every bathroom.
<br />A cabinet is in every bathroom.
</p></blockquote>
<!-- END CODE -->
<p>If we were feeling particularly ambitious and inclined toward interior decoration, we could add bath mats, mirrors, plungers, toilet brushes, overhead lighting, towel racks, scented candles, boxes of facial tissue, shampoo bottles, scrubbing loofahs, etc. ad nauseam; but we'll keep it relatively simple for now. Of course, if we have a toilet, we pretty much have to accept that the player will try to make use of it:</p>
<!-- START CODE "c9148_251" -->
<a id="c9148_251"></a><blockquote class="code"><p class="quoted">
Understand &quot;flush [toilet]&quot; or &quot;use [toilet]&quot; as a mistake (&quot;You have no need at the moment.&quot;).
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9149_251" -->
<a id="c9149_251"></a><blockquote class="code"><p class="quoted">
Understand &quot;take shower&quot; or &quot;take bath&quot; or &quot;bathe&quot; or &quot;wash&quot; as bathing. Bathing is an action applying to nothing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9150_251" -->
<a id="c9150_251"></a><blockquote class="code"><p class="quoted">
Check bathing (this is the restrict baths to bathrooms rule):
<br />&#160;&#160;&#160;&#160;if the location is not a bathroom, say &quot;This isn't the place.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9151_251" -->
<a id="c9151_251"></a><blockquote class="code"><p class="quoted">
Check bathing (this is the block bathing rule):
<br />&#160;&#160;&#160;&#160;say &quot;You haven't time for a bath.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9152_251" -->
<a id="c9152_251"></a><blockquote class="code"><p class="quoted">
Washing is an action applying to one thing. Understand &quot;clean [something]&quot; or &quot;wet [something]&quot; or &quot;wash [something]&quot; as washing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9153_251" -->
<a id="c9153_251"></a><blockquote class="code"><p class="quoted">
Instead of washing the player, try bathing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9154_251" -->
<a id="c9154_251"></a><blockquote class="code"><p class="quoted">
Check washing (this is the restrict washing to the proximity of sinks rule):
<br />&#160;&#160;&#160;&#160;unless the player can touch a sink, say &quot;This isn't the place.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9155_251" -->
<a id="c9155_251"></a><blockquote class="code"><p class="quoted">
Check washing (this is the block washing rule):
<br />&#160;&#160;&#160;&#160;say &quot;It doesn't seem worth the bother.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<p>Now we might put this to work in a short example.</p>
<p>One slight challenge lies in giving these assembled pieces separate descriptions. When we have an assembly that adds parts to objects, we can then talk about (for instance) &quot;the stove's switch&quot; elsewhere in the code. But items that have been assigned rooms are not named in the same way, so we cannot talk about &quot;the Industrial Kitchen's stove&quot; in our code as a way to assign it a description or special behavior. In quite a simple example, we could make the descriptions of the kind simply be the descriptions we want for the individual items:</p>
<!-- START CODE "c9156_251" -->
<a id="c9156_251"></a><blockquote class="code"><p class="quoted">
Section 3 - An Example We Might Offer
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9157_251" -->
<a id="c9157_251"></a><blockquote class="code"><p class="quoted">
Our Household Kitchen is a kitchen.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9158_251" -->
<a id="c9158_251"></a><blockquote class="code"><p class="quoted">
The Tiny Bathroom is a bathroom. It is west of Our Household Kitchen.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9159_251" -->
<a id="c9159_251"></a><blockquote class="code"><p class="quoted">
The description of a stove is &quot;Scrupulously polished.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9160_251" -->
<a id="c9160_251"></a><blockquote class="code"><p class="quoted">
The description of a refrigerator is &quot;It is baby blue and has the contours of a 50[']s chevy. One of these days it really will break down, but it's been serving your family faithfully since your grandmother's honeymoon.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9161_251" -->
<a id="c9161_251"></a><blockquote class="code"><p class="quoted">
Test me with &quot;x refrigerator / open fridge / x freezer / look in freezer / open freezer / turn on stove / turn on oven / x oven switch / turn off oven switch / turn off stove switch / turn on taps / x sink / w / x sink / turn on sink / take bath / use toilet&quot;.
</p></blockquote>
<!-- END CODE -->
<p>In a game that featured multiple bathrooms and kitchens, this wouldn't be enough; our author might give the stove kind (say) a description that checked its location, as in</p>
<!-- START CODE "c9162_251" -->
<a id="c9162_251"></a><blockquote class="code"><p class="quoted">
The description of a stove is &quot;[if in Industrial Kitchen]A massive stainless steel stove-top with six burners[otherwise]Your standard four-burner item[end if].&quot;
</p></blockquote>
<!-- END CODE -->
<p>or create an</p>
<!-- START CODE "c9163_251" -->
<a id="c9163_251"></a><blockquote class="code"><p class="quoted">
Instead of examining the stove in the Industrial Kitchen: ...
</p></blockquote>
<!-- END CODE -->
<p>sort of rule for those objects he wanted to describe specially; or he might use a when play begins rule to initialize a few things:</p>
<!-- START CODE "c9164_251" -->
<a id="c9164_251"></a><blockquote class="code"><p class="quoted">
When play begins:
<br />&#160;&#160;&#160;&#160;let N be a random stove in the Industrial Kitchen;
<br />&#160;&#160;&#160;&#160;move the boiling pot to N;
<br />&#160;&#160;&#160;&#160;change the description of N to...
</p></blockquote>
<!-- END CODE -->
<p>Or we might even (if we anticipate lots of these kinds of amendments) want to rig up something more complex that finds the descriptions of appliances in a table, rather than relying on their individual description properties. This can all be done, but it is only interesting as long as it remains genuinely labor-saving: that is, as long as the convenience of having the assembly is greater than the annoyance of writing special rules to cover for the automation. In the end, the &quot;kitchen&quot; and &quot;bathroom&quot; room types are likely to be most useful for authors who want to include the standard props but not actually make them a critical part of the game; if stoves and sinks have more of a starring role in the production, authors may be better off coding them or at the very least placing them by hand, as in</p>
<!-- START CODE "c9165_251" -->
<a id="c9165_251"></a><blockquote class="code"><p class="quoted">
The Industrial Kitchen is a room.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9166_251" -->
<a id="c9166_251"></a><blockquote class="code"><p class="quoted">
Thor is a stove in the Industrial Kitchen. It supports a boiling pot.
</p></blockquote>
<!-- END CODE -->
<p>All these quirks are things that we (as the extension author) want to think out in advance: we should ideally warn authors about possible pitfalls in using our extension (if we can think of them) and point out ways of customizing the behavior (if there are interesting ways).</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "450: Tilt 3" "e385" -->
<a id="e385"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_27.html#e385" class="eglink"><b>450</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_27.html#e385" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Tilt 3</span></b></a><br />Displaying the card suits from our deck of cards with red and black colored unicode symbols.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_12.html#e385"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example385">
<p>Books and articles about card-playing traditionally abbreviate card names into a simple two-symbol notation: a number or letter representing the card rank, followed by a symbol indicating the card suit. Suppose that we want to emulate this notation when taking inventory in our poker game.</p>
<p>The trick here is that colored output is done in different ways by the Z-Machine and by Glulx, so we'll need two different versions of the same section in order to produce this output. The relevant source is right at the beginning:</p>
<!-- START CODE "c9167_385" -->
<a id="c9167_385"></a><blockquote class="code"><p class="quoted">
&quot;Tilt&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9168_385" -->
<a id="c9168_385"></a><blockquote class="code"><p class="quoted">
Section 0 - Colored Output in Two Forms
</p></blockquote>
<!-- END CODE -->
<p>For the suit symbols, we'll want the Unicode extension included with Inform:</p>
<!-- START CODE "c9169_385" -->
<a id="c9169_385"></a><blockquote class="code"><p class="quoted">
Include Unicode Character Names by Graham Nelson.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9170_385" -->
<a id="c9170_385"></a><blockquote class="code"><p class="quoted">
Rule for printing the name of a card (called target) while grouping together:
<br />&#160;&#160;&#160;&#160;say &quot;[rank of the target as abbreviated value][suit of the target as symbol]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9171_385" -->
<a id="c9171_385"></a><blockquote class="code"><p class="quoted">
To say (current suit - a suit) as symbol:
<br />&#160;&#160;&#160;&#160;if current suit is diamonds, say &quot;[red letters][unicode black diamond suit][default letters]&quot;;
<br />&#160;&#160;&#160;&#160;if current suit is spades, say &quot;[unicode black spade suit]&quot;;
<br />&#160;&#160;&#160;&#160;if current suit is clubs, say &quot;[unicode black club suit]&quot;;
<br />&#160;&#160;&#160;&#160;if current suit is hearts, say &quot;[red letters][unicode black heart suit][default letters]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9172_385" -->
<a id="c9172_385"></a><blockquote class="code"><p class="quoted">
Section 0Z (for Z-machine only)
</p></blockquote>
<!-- END CODE -->
<p>The Basic Screen Effects extension bundled with Inform includes mechanisms to change the text color, so for the Z-machine, we need only include this:</p>
<!-- START CODE "c9173_385" -->
<a id="c9173_385"></a><blockquote class="code"><p class="quoted">
Include Basic Screen Effects by Emily Short.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9174_385" -->
<a id="c9174_385"></a><blockquote class="code"><p class="quoted">
Section 0G (for Glulx only)
</p></blockquote>
<!-- END CODE -->
<p>Under Glulx, we need slightly more set-up: Glulx requires that we define special user font styles when we plan to make display changes. A fuller discussion of this (and of how to define new colors) appears in the documentation of &quot;Glulx Text Effects&quot;, but an implementation sufficient to our purposes would be</p>
<!-- START CODE "c9175_385" -->
<a id="c9175_385"></a><blockquote class="code"><p class="quoted">
Include Glulx Text Effects by Emily Short.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9176_385" -->
<a id="c9176_385"></a><blockquote class="code"><p class="quoted">
Table of User Styles (continued)
<br /></p></blockquote><table class="codetable">
<tr><td class="quotedtablecell"><p class="quoted">style name</p></td><td class="quotedtablecell"><p class="quoted">glulx color</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">special-style-1</p></td><td class="quotedtablecell"><p class="quoted">g-pure-red</p></td></tr>
</table><blockquote><p>
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9177_385" -->
<a id="c9177_385"></a><blockquote class="code"><p class="quoted">
Table of Common Color Values (continued)
<br /></p></blockquote><table class="codetable">
<tr><td class="quotedtablecell"><p class="quoted">glulx color value</p></td><td class="quotedtablecell"><p class="quoted">assigned number</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">g-pure-red</p></td><td class="quotedtablecell"><p class="quoted">16711680</p></td></tr>
</table><blockquote><p>
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9178_385" -->
<a id="c9178_385"></a><blockquote class="code"><p class="quoted">
To say red letters: say first custom style.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9179_385" -->
<a id="c9179_385"></a><blockquote class="code"><p class="quoted">
To say default letters: say roman type.
</p></blockquote>
<!-- END CODE -->
<p>From here, the rest of the source is mostly as we've seen in previous examples:</p>
<!-- START CODE "c9180_385" -->
<a id="c9180_385"></a><blockquote class="code"><p class="quoted">
Section 1 - Cards
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9181_385" -->
<a id="c9181_385"></a><blockquote class="code"><p class="quoted">
Suit is a kind of value. The suits are hearts, clubs, diamonds, and spades. Understand &quot;heart&quot; as hearts. Understand &quot;club&quot; as clubs. Understand &quot;diamond&quot; as diamonds. Understand &quot;spade&quot; as spades.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9182_385" -->
<a id="c9182_385"></a><blockquote class="code"><p class="quoted">
A card is a kind of thing.  A card has a suit. A card has a number called rank. Understand the suit property as describing a card. Understand the rank property as describing a card.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9183_385" -->
<a id="c9183_385"></a><blockquote class="code"><p class="quoted">
52 cards are in the card repository.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9184_385" -->
<a id="c9184_385"></a><blockquote class="code"><p class="quoted">
To say (count - a number) as a card value:
<br />&#160;&#160;&#160;&#160;choose row count in the Table of Value Names;
<br />&#160;&#160;&#160;&#160;say &quot;[term entry]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9185_385" -->
<a id="c9185_385"></a><blockquote class="code"><p class="quoted">
Rule for printing the name of a card (called target):
<br />&#160;&#160;&#160;&#160;say &quot;[rank of the target as a card value] of [suit of the target]&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9186_385" -->
<a id="c9186_385"></a><blockquote class="code"><p class="quoted">
To say (count - a number) as abbreviated value:
<br />&#160;&#160;&#160;&#160;choose row count in the Table of Value Names;
<br />&#160;&#160;&#160;&#160;say &quot;[abbrev entry]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9187_385" -->
<a id="c9187_385"></a><blockquote class="code"><p class="quoted">
Table of Value Names
<br /></p></blockquote><table class="codetable">
<tr><td class="quotedtablecell"><p class="quoted">term</p></td><td class="quotedtablecell"><p class="quoted">value</p></td><td class="quotedtablecell"><p class="quoted">abbrev</p></td><td class="quotedtablecell"><p class="quoted">topic</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">&quot;ace&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;1&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;A&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;ace/A&quot;</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">&quot;deuce&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;2&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;2&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;deuce/two&quot;</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">&quot;three&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;3&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;3&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;three&quot;</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">&quot;four&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;4&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;4&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;four&quot;</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">&quot;five&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;5&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;5&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;five&quot;</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">&quot;six&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;6&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;6&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;six&quot;</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">&quot;seven&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;7&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;7&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;seven&quot;</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">&quot;eight&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;8&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;8&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;eight&quot;</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">&quot;nine&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;9&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;9&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;nine&quot;</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">&quot;ten&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;10&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;10&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;ten&quot;</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">&quot;jack&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;11&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;J&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;jack/knave/J&quot;</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">&quot;queen&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;12&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;Q&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;queen/Q&quot;</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">&quot;king&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;13&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;K&quot;</p></td><td class="quotedtablecell"><p class="quoted">&quot;king/K&quot;</p></td></tr>
</table><blockquote><p>
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9188_385" -->
<a id="c9188_385"></a><blockquote class="code"><p class="quoted">
After reading a command:
<br />&#160;&#160;&#160;&#160;if the player's command includes &quot;of [suit]&quot;:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;while the player's command includes &quot;of&quot;:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;cut the matched text;
<br />&#160;&#160;&#160;&#160;repeat through the Table of Value Names:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;while the player's command includes topic entry:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;replace the matched text with value entry.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9189_385" -->
<a id="c9189_385"></a><blockquote class="code"><p class="quoted">
When play begins:
<br />&#160;&#160;&#160;&#160;reconstitute deck.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9190_385" -->
<a id="c9190_385"></a><blockquote class="code"><p class="quoted">
To reconstitute deck:
<br />&#160;&#160;&#160;&#160;let current suit be hearts;
<br />&#160;&#160;&#160;&#160;now every card is in the card repository;
<br />&#160;&#160;&#160;&#160;while a card is in the card repository:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;repeat with current rank running from 1 to 13:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let item be a random card in card repository;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now rank of item is current rank;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now suit of item is current suit;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now item is in the deck of cards;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now current suit is the suit after the current suit.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9191_385" -->
<a id="c9191_385"></a><blockquote class="code"><p class="quoted">
Section 2 - The Deck and the Discard Pile
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9192_385" -->
<a id="c9192_385"></a><blockquote class="code"><p class="quoted">
The Empty Room is a room. &quot;Nothing to see here.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9193_385" -->
<a id="c9193_385"></a><blockquote class="code"><p class="quoted">
The deck of cards is in the Empty Room. It is a closed unopenable container. The description is &quot;A standard poker deck.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9194_385" -->
<a id="c9194_385"></a><blockquote class="code"><p class="quoted">
The discard pile is a closed unopenable container. The description is &quot;Cards in this game are discarded face-down, so the discard pile is not very interesting to see. All you can observe is that it currently contains [if the number of cards which are in the discard pile is less than ten][the number of cards which are in the discard pile in words][otherwise]about [the rounded number of cards which are in the discard pile in words][end if] card[s].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9195_385" -->
<a id="c9195_385"></a><blockquote class="code"><p class="quoted">
To decide what number is the rounded number of (described set - a description of objects):
<br />&#160;&#160;&#160;&#160;let N be the number of members of the described set;
<br />&#160;&#160;&#160;&#160;let R be N divided by 5;
<br />&#160;&#160;&#160;&#160;let total be R times 5;
<br />&#160;&#160;&#160;&#160;decide on total.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9196_385" -->
<a id="c9196_385"></a><blockquote class="code"><p class="quoted">
Rule for printing room description details of something: do nothing instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9197_385" -->
<a id="c9197_385"></a><blockquote class="code"><p class="quoted">
Section 3 - Drawing and Discarding Actions
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9198_385" -->
<a id="c9198_385"></a><blockquote class="code"><p class="quoted">
Understand the commands &quot;take&quot; and &quot;carry&quot; and &quot;hold&quot; and &quot;get&quot; and &quot;drop&quot; and &quot;throw&quot; and &quot;discard&quot; as something new.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9199_385" -->
<a id="c9199_385"></a><blockquote class="code"><p class="quoted">
Understand &quot;take [text]&quot; or &quot;get [text]&quot; or &quot;drop [text]&quot; as a mistake (&quot;Here, you only draw and discard. Nothing else matters at the moment.&quot;).
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9200_385" -->
<a id="c9200_385"></a><blockquote class="code"><p class="quoted">
Understand &quot;draw&quot; or &quot;draw card&quot; or &quot;draw a card&quot; as drawing. Drawing is an action applying to nothing. The drawing action has an object called the card drawn.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9201_385" -->
<a id="c9201_385"></a><blockquote class="code"><p class="quoted">
Setting action variables for drawing:
<br />&#160;&#160;&#160;&#160;now the card drawn is a random card which is in the deck of cards.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9202_385" -->
<a id="c9202_385"></a><blockquote class="code"><p class="quoted">
Check drawing:
<br />&#160;&#160;&#160;&#160;if the card drawn is nothing, say &quot;The deck is completely depleted.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9203_385" -->
<a id="c9203_385"></a><blockquote class="code"><p class="quoted">
Check drawing:
<br />&#160;&#160;&#160;&#160;if the number of cards carried by the player is greater than four,
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;This is a five-card game; you must discard something before drawing anything further.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9204_385" -->
<a id="c9204_385"></a><blockquote class="code"><p class="quoted">
Carry out drawing:
<br />&#160;&#160;&#160;&#160;move the card drawn to the player.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9205_385" -->
<a id="c9205_385"></a><blockquote class="code"><p class="quoted">
Report drawing:
<br />&#160;&#160;&#160;&#160;say &quot;You draw [a card drawn].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9206_385" -->
<a id="c9206_385"></a><blockquote class="code"><p class="quoted">
Understand &quot;discard [card]&quot; as discarding. Discarding is an action applying to one thing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9207_385" -->
<a id="c9207_385"></a><blockquote class="code"><p class="quoted">
Check discarding:
<br />&#160;&#160;&#160;&#160;if the player does not carry the noun, say &quot;You can only discard cards from your own hand.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9208_385" -->
<a id="c9208_385"></a><blockquote class="code"><p class="quoted">
Carry out discarding:
<br />&#160;&#160;&#160;&#160;now the noun is in the discard pile;
<br />&#160;&#160;&#160;&#160;if the discard pile is not visible, move the discard pile to the location.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9209_385" -->
<a id="c9209_385"></a><blockquote class="code"><p class="quoted">
Report discarding:
<br />&#160;&#160;&#160;&#160;say &quot;You toss [the noun] nonchalantly onto the discard pile.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9210_385" -->
<a id="c9210_385"></a><blockquote class="code"><p class="quoted">
Section 4 - Assessing Hands
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9211_385" -->
<a id="c9211_385"></a><blockquote class="code"><p class="quoted">
Before listing contents while taking inventory: group cards together.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9212_385" -->
<a id="c9212_385"></a><blockquote class="code"><p class="quoted">
Before grouping together cards:
<br />&#160;&#160;&#160;&#160;if the number of cards carried by the player is 5:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[run paragraph on]&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;follow the hand-ranking rules;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the rule succeeded, say &quot;[the outcome of the rulebook]&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;otherwise say &quot;some random cards&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the outcome of the rulebook is pair outcome, say &quot; of [rank of the first thing held by the player as a card value]s&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[number of cards carried by the player in words] assorted cards&quot;;
<br />&#160;&#160;&#160;&#160;say &quot; (&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9213_385" -->
<a id="c9213_385"></a><blockquote class="code"><p class="quoted">
Rule for grouping together cards:
<br />&#160;&#160;&#160;&#160;say &quot;[list hand]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9214_385" -->
<a id="c9214_385"></a><blockquote class="code"><p class="quoted">
To say list hand:
<br />&#160;&#160;&#160;&#160;let chosen card be the first thing held by the player;
<br />&#160;&#160;&#160;&#160;while chosen card is a card:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[chosen card]&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now chosen card is the next thing held after chosen card;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if chosen card is a card, say &quot;-&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9215_385" -->
<a id="c9215_385"></a><blockquote class="code"><p class="quoted">
After grouping together cards:
<br />&#160;&#160;&#160;&#160;say &quot;)&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9216_385" -->
<a id="c9216_385"></a><blockquote class="code"><p class="quoted">
The hand-ranking rules is a rulebook. The hand-ranking rules have outcomes royal flush, straight flush, four of a kind, full house, flush, straight, three of a kind, two pairs, pair, high card.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9217_385" -->
<a id="c9217_385"></a><blockquote class="code"><p class="quoted">
The hand-ranking rulebook has a truth state called the flushness.
<br />The hand-ranking rulebook has a truth state called the straightness.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9218_385" -->
<a id="c9218_385"></a><blockquote class="code"><p class="quoted">
The hand-ranking rulebook has a number called the pair count.
<br />The hand-ranking rulebook has a number called the triple count.
<br />The hand-ranking rulebook has a number called the quadruple count.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9219_385" -->
<a id="c9219_385"></a><blockquote class="code"><p class="quoted">
A card can be sorted or unsorted. A card is usually unsorted.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9220_385" -->
<a id="c9220_385"></a><blockquote class="code"><p class="quoted">
Definition: a card is high if its rank is 11 or more.
<br />Definition: a card is low if its rank is 4 or less.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9221_385" -->
<a id="c9221_385"></a><blockquote class="code"><p class="quoted">
A hand-ranking rule (this is the initial sort rule):
<br />&#160;&#160;&#160;&#160;now every card is unsorted;
<br />&#160;&#160;&#160;&#160;while the player carries an unsorted card:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let item be the lowest unsorted card held by the player;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;move item to the player;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the item is sorted;
<br />&#160;&#160;&#160;&#160;if sort-debugging is true, say &quot;-- after initial sort: [list hand]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9222_385" -->
<a id="c9222_385"></a><blockquote class="code"><p class="quoted">
A hand-ranking rule (this is the finding flushness rule):
<br />&#160;&#160;&#160;&#160;let called suit be the suit of a random card carried by the player;
<br />&#160;&#160;&#160;&#160;if every card carried by the player is called suit, now flushness is true.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9223_385" -->
<a id="c9223_385"></a><blockquote class="code"><p class="quoted">
A hand-ranking rule (this is the finding straightness rule):
<br />&#160;&#160;&#160;&#160;now straightness is true;
<br />&#160;&#160;&#160;&#160;let N be the rank of the highest card which is carried by the player;
<br />&#160;&#160;&#160;&#160;repeat with current rank running from N - 4 to N:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the test rank is the current rank;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;unless the player carries a matching card:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the current rank is N - 4 and the current rank is 9 and the player carries an ace card, do nothing;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;otherwise now straightness is false.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9224_385" -->
<a id="c9224_385"></a><blockquote class="code"><p class="quoted">
A card can be quadrupled, tripled, paired or uncombined.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9225_385" -->
<a id="c9225_385"></a><blockquote class="code"><p class="quoted">
Test rank is a number that varies. Definition: a card is matching if its rank is the test rank.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9226_385" -->
<a id="c9226_385"></a><blockquote class="code"><p class="quoted">
A hand-ranking rule (this is the counting multiples rule):
<br />&#160;&#160;&#160;&#160;now every card is uncombined;
<br />&#160;&#160;&#160;&#160;repeat with current rank running from 1 to 13:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now test rank is current rank;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let N be the number of matching cards held by the player;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if N is 4:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;increment the quadruple count;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now every matching card held by the player is quadrupled;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if N is 3:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;increment the triple count;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now every matching card held by the player is tripled;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if N is 2:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;increment the pair count;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now every matching card held by the player is paired.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9227_385" -->
<a id="c9227_385"></a><blockquote class="code"><p class="quoted">
A hand-ranking rule (this is the move aces up unless there's a low straight rule):
<br />&#160;&#160;&#160;&#160;unless the straightness is true and the lowest card carried by the player is an ace card and the rank of the highest card carried by the player is 5,
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now every ace card which is carried by the player is carried by the player;
<br />&#160;&#160;&#160;&#160;if sort-debugging is true, say &quot;-- after ace movement rule: [list hand]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9228_385" -->
<a id="c9228_385"></a><blockquote class="code"><p class="quoted">
A hand-ranking rule (this is the move pairs forward rule):
<br />&#160;&#160;&#160;&#160;while the player carries a paired card:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let selection be the lowest paired card which is carried by the player;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;move the selection to the player;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the selection is uncombined;
<br />&#160;&#160;&#160;&#160;if sort-debugging is true, say &quot;-- after pairs movement: [list hand]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9229_385" -->
<a id="c9229_385"></a><blockquote class="code"><p class="quoted">
A hand-ranking rule (this is the raise ace pairs rule):
<br />&#160;&#160;&#160;&#160;if the player carries exactly two ace cards:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;repeat with item running through ace cards which are carried by the player:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;move item to the player;
<br />&#160;&#160;&#160;&#160;if sort-debugging is true, say &quot;-- after paired-ace movement: [list hand]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9230_385" -->
<a id="c9230_385"></a><blockquote class="code"><p class="quoted">
A hand-ranking rule (this is the move multiples forward rule):
<br />&#160;&#160;&#160;&#160;while the player carries a tripled card:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let selection be the lowest tripled card which is carried by the player;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;move the selection to the player;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the selection is uncombined;
<br />&#160;&#160;&#160;&#160;while the player carries a quadrupled card:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let selection be the lowest quadrupled card which is carried by the player;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;move the selection to the player;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the selection is uncombined;
<br />&#160;&#160;&#160;&#160;if sort-debugging is true, say &quot;-- after multiples movement rule: [list hand]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9231_385" -->
<a id="c9231_385"></a><blockquote class="code"><p class="quoted">
Definition: a card is ace if its rank is 1.
<br />Definition: a card is king if its rank is 13.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9232_385" -->
<a id="c9232_385"></a><blockquote class="code"><p class="quoted">
A hand-ranking rule (this is the royal-flush rule):
<br />&#160;&#160;&#160;&#160;if flushness is true and straightness is true and the highest card carried by the player is king and the lowest card carried by the player is ace, royal flush.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9233_385" -->
<a id="c9233_385"></a><blockquote class="code"><p class="quoted">
A hand-ranking rule (this is the straight-flushes rule):
<br />&#160;&#160;&#160;&#160;if flushness is true and straightness is true, straight flush.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9234_385" -->
<a id="c9234_385"></a><blockquote class="code"><p class="quoted">
A hand-ranking rule (this is the four-of-a-kind rule):
<br />&#160;&#160;&#160;&#160;if the quadruple count is 1, four of a kind.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9235_385" -->
<a id="c9235_385"></a><blockquote class="code"><p class="quoted">
A hand-ranking rule (this is the full-house rule):
<br />&#160;&#160;&#160;&#160;if the pair count is 1 and the triple count is 1, full house.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9236_385" -->
<a id="c9236_385"></a><blockquote class="code"><p class="quoted">
A hand-ranking rule (this is the flushes rule):
<br />&#160;&#160;&#160;&#160;if flushness is true, flush.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9237_385" -->
<a id="c9237_385"></a><blockquote class="code"><p class="quoted">
A hand-ranking rule (this is the straights rule):
<br />&#160;&#160;&#160;&#160;if straightness is true, straight.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9238_385" -->
<a id="c9238_385"></a><blockquote class="code"><p class="quoted">
A hand-ranking rule (this is the three-of-a-kind rule):
<br />&#160;&#160;&#160;&#160;if triple count is 1, three of a kind.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9239_385" -->
<a id="c9239_385"></a><blockquote class="code"><p class="quoted">
A hand-ranking rule (this is the two-pair rule):
<br />&#160;&#160;&#160;&#160;if the pair count is 2, two pairs.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9240_385" -->
<a id="c9240_385"></a><blockquote class="code"><p class="quoted">
A hand-ranking rule (this is the pair rule):
<br />&#160;&#160;&#160;&#160;if the pair count is 1, pair.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9241_385" -->
<a id="c9241_385"></a><blockquote class="code"><p class="quoted">
A hand-ranking rule (this is the default rule):
<br />&#160;&#160;&#160;&#160;high card.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9242_385" -->
<a id="c9242_385"></a><blockquote class="code"><p class="quoted">
Sort-debugging is a truth state that varies.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9243_385" -->
<a id="c9243_385"></a><blockquote class="code"><p class="quoted">
Section 5 - Testing hand identification - Not for release
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9244_385" -->
<a id="c9244_385"></a><blockquote class="code"><p class="quoted">
Understand &quot;debug sorting&quot; as debugging hand sorting. Debugging hand sorting is an action out of world.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9245_385" -->
<a id="c9245_385"></a><blockquote class="code"><p class="quoted">
Carry out debugging hand sorting:
<br />&#160;&#160;&#160;&#160;if sort-debugging is false, now sort-debugging is true;
<br />&#160;&#160;&#160;&#160;otherwise now sort-debugging is false.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9246_385" -->
<a id="c9246_385"></a><blockquote class="code"><p class="quoted">
Report debugging hand sorting:
<br />&#160;&#160;&#160;&#160;say &quot;Sort debugging is now [if sort-debugging is true]on[otherwise]off[end if].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9247_385" -->
<a id="c9247_385"></a><blockquote class="code"><p class="quoted">
Test me with &quot;draw / g / g / g / g / force hand / g / g / g / g / g / g / g / g / g / g / g / g&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9248_385" -->
<a id="c9248_385"></a><blockquote class="code"><p class="quoted">
Table of Testing Hands
<br /></p></blockquote><table class="codetable">
<tr><td class="quotedtablecell"><p class="quoted">set suit</p></td><td class="quotedtablecell"><p class="quoted">set rank</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">spades</p></td><td class="quotedtablecell"><p class="quoted">1</p></td><td class="quotedtablecell"><p class="quoted">[royal flush]</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">spades</p></td><td class="quotedtablecell"><p class="quoted">13</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">spades</p></td><td class="quotedtablecell"><p class="quoted">12</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">spades</p></td><td class="quotedtablecell"><p class="quoted">11</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">spades</p></td><td class="quotedtablecell"><p class="quoted">10</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">clubs</p></td><td class="quotedtablecell"><p class="quoted">12</p></td><td class="quotedtablecell"><p class="quoted">[straight flush]</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">clubs</p></td><td class="quotedtablecell"><p class="quoted">11</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">clubs</p></td><td class="quotedtablecell"><p class="quoted">10</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">clubs</p></td><td class="quotedtablecell"><p class="quoted">9</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">clubs</p></td><td class="quotedtablecell"><p class="quoted">8</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">diamonds</p></td><td class="quotedtablecell"><p class="quoted">8</p></td><td class="quotedtablecell"><p class="quoted">[four of a kind]</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">hearts</p></td><td class="quotedtablecell"><p class="quoted">8</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">spades</p></td><td class="quotedtablecell"><p class="quoted">8</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">clubs</p></td><td class="quotedtablecell"><p class="quoted">8</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">clubs</p></td><td class="quotedtablecell"><p class="quoted">3</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">clubs</p></td><td class="quotedtablecell"><p class="quoted">1</p></td><td class="quotedtablecell"><p class="quoted">[full house]</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">spades</p></td><td class="quotedtablecell"><p class="quoted">1</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">hearts</p></td><td class="quotedtablecell"><p class="quoted">10</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">spades</p></td><td class="quotedtablecell"><p class="quoted">10</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">clubs</p></td><td class="quotedtablecell"><p class="quoted">10</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">hearts</p></td><td class="quotedtablecell"><p class="quoted">2</p></td><td class="quotedtablecell"><p class="quoted">[flush]</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">hearts</p></td><td class="quotedtablecell"><p class="quoted">5</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">hearts</p></td><td class="quotedtablecell"><p class="quoted">7</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">hearts</p></td><td class="quotedtablecell"><p class="quoted">11</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">hearts</p></td><td class="quotedtablecell"><p class="quoted">12</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">hearts</p></td><td class="quotedtablecell"><p class="quoted">1</p></td><td class="quotedtablecell"><p class="quoted">[straight]</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">spades</p></td><td class="quotedtablecell"><p class="quoted">13</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">diamonds</p></td><td class="quotedtablecell"><p class="quoted">12</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">clubs</p></td><td class="quotedtablecell"><p class="quoted">11</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">hearts</p></td><td class="quotedtablecell"><p class="quoted">10</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">hearts</p></td><td class="quotedtablecell"><p class="quoted">2</p></td><td class="quotedtablecell"><p class="quoted">[three of a kind]</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">spades</p></td><td class="quotedtablecell"><p class="quoted">2</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">clubs</p></td><td class="quotedtablecell"><p class="quoted">2</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">clubs</p></td><td class="quotedtablecell"><p class="quoted">4</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">spades</p></td><td class="quotedtablecell"><p class="quoted">3</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">diamonds</p></td><td class="quotedtablecell"><p class="quoted">6</p></td><td class="quotedtablecell"><p class="quoted">[two pairs]</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">spades</p></td><td class="quotedtablecell"><p class="quoted">6</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">clubs</p></td><td class="quotedtablecell"><p class="quoted">7</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">diamonds</p></td><td class="quotedtablecell"><p class="quoted">7</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">hearts</p></td><td class="quotedtablecell"><p class="quoted">9</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">diamonds</p></td><td class="quotedtablecell"><p class="quoted">6</p></td><td class="quotedtablecell"><p class="quoted">[two pairs, ace high]</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">spades</p></td><td class="quotedtablecell"><p class="quoted">6</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">clubs</p></td><td class="quotedtablecell"><p class="quoted">1</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">diamonds</p></td><td class="quotedtablecell"><p class="quoted">7</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">hearts</p></td><td class="quotedtablecell"><p class="quoted">1</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">hearts</p></td><td class="quotedtablecell"><p class="quoted">12</p></td><td class="quotedtablecell"><p class="quoted">[pair]</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">spades</p></td><td class="quotedtablecell"><p class="quoted">12</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">diamonds</p></td><td class="quotedtablecell"><p class="quoted">10</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">spades</p></td><td class="quotedtablecell"><p class="quoted">7</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">clubs</p></td><td class="quotedtablecell"><p class="quoted">4</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">diamonds</p></td><td class="quotedtablecell"><p class="quoted">13</p></td><td class="quotedtablecell"><p class="quoted">[high]</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">hearts</p></td><td class="quotedtablecell"><p class="quoted">11</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">spades</p></td><td class="quotedtablecell"><p class="quoted">9</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">clubs</p></td><td class="quotedtablecell"><p class="quoted">7</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">diamonds</p></td><td class="quotedtablecell"><p class="quoted">5</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">hearts</p></td><td class="quotedtablecell"><p class="quoted">1</p></td><td class="quotedtablecell"><p class="quoted">[tricky sorting: low straight]</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">diamonds</p></td><td class="quotedtablecell"><p class="quoted">2</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">spades</p></td><td class="quotedtablecell"><p class="quoted">3</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">diamonds</p></td><td class="quotedtablecell"><p class="quoted">4</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">diamonds</p></td><td class="quotedtablecell"><p class="quoted">5</p></td></tr>
</table><blockquote><p>
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9249_385" -->
<a id="c9249_385"></a><blockquote class="code"><p class="quoted">
Understand &quot;force hand&quot; as forcing a hand. Forcing a hand is an action out of world.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9250_385" -->
<a id="c9250_385"></a><blockquote class="code"><p class="quoted">
Current marker is a number that varies.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9251_385" -->
<a id="c9251_385"></a><blockquote class="code"><p class="quoted">
Carry out forcing a hand:
<br />&#160;&#160;&#160;&#160;repeat with item running through cards which are carried by the player:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;increment current marker;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if current marker is greater than the number of filled rows in the Table of Testing Hands, now current marker is 1;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;choose row current marker in the Table of Testing Hands;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the suit of item is the set suit entry;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the rank of item is the set rank entry.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9252_385" -->
<a id="c9252_385"></a><blockquote class="code"><p class="quoted">
Report forcing a hand:
<br />&#160;&#160;&#160;&#160;try taking inventory.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "451: Pink or Blue" "e168" -->
<a id="e168"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_27.html#e168" class="eglink"><b>451</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_27.html#e168" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><img class="asterisk" alt="*" src="images/asterisk.png" /><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Pink or Blue</span></b></a><br />Asking the player to select a gender to begin play.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_5.html#e168"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example168">
<p>Suppose we would like to allow the player to choose a gender for the main character. We'd also like this to happen at the beginning of the game and outside the main parsing sequence. &quot;When play begins&quot; seems like a good place to put this.</p>
<!-- START CODE "c9253_168" -->
<a id="c9253_168"></a><blockquote class="code"><p class="quoted">
&quot;Pink or Blue&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9254_168" -->
<a id="c9254_168"></a><blockquote class="code"><p class="quoted">
When play begins:
<br />&#160;&#160;&#160;&#160;say &quot;Should your character be male or female? &gt;&quot;;
<br />&#160;&#160;&#160;&#160;if men win, now the player is male;
<br />&#160;&#160;&#160;&#160;otherwise now the player is female;
<br />&#160;&#160;&#160;&#160;say paragraph break.
</p></blockquote>
<!-- END CODE -->
<p>Now a piece of Inform 6 code handles the unusual input. It's not necessary to understand this to use it, and the code should work for any question you'd like to ask the player. The first three words in quotation marks ('male', 'M', 'man'...) correspond to positive feedback; the later three words correspond to negative feedback. So &quot;to decide whether men win&quot; will be true if the player types one of the first three, and false if he types one of the last three.</p>
<!-- START CODE "c9255_168" -->
<a id="c9255_168"></a><blockquote class="code"><p class="quoted">
To decide whether men win:
<br />&#160;&#160;&#160;&#160;(- Question('male','M//','man','female','F//','woman') -)
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9256_168" -->
<a id="c9256_168"></a><blockquote class="code"><p class="quoted">
Include (-
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9257_168" -->
<a id="c9257_168"></a><blockquote class="code"><p class="quoted">
[ Question pos1 pos2 pos3 neg1 neg2 neg3 first_word_typed;
<br />&#160;&#160;&#160;&#160;while (true) {
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;VM_ReadKeyboard(buffer, parse);
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;wn = 1; first_word_typed = NextWordStopped();
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (first_word_typed == pos1 or pos2 or pos3) rtrue;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if (first_word_typed == neg1 or neg2 or neg3) rfalse;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;print &quot;Please choose &quot;, (address) pos1, &quot; or &quot;, (address) neg1, &quot;. &gt; &quot;;
<br />&#160;&#160;&#160;&#160;}
<br />];
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9258_168" -->
<a id="c9258_168"></a><blockquote class="code"><p class="quoted">
-)
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9259_168" -->
<a id="c9259_168"></a><blockquote class="code"><p class="quoted">
Instead of examining the player when the player is female:
<br />&#160;&#160;&#160;&#160;say &quot;Congratulations, you are a girl!&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9260_168" -->
<a id="c9260_168"></a><blockquote class="code"><p class="quoted">
Instead of examining the player when the player is male:
<br />&#160;&#160;&#160;&#160;say &quot;Congratulations, you are a boy!&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9261_168" -->
<a id="c9261_168"></a><blockquote class="code"><p class="quoted">
The Room of Self-Knowledge is a room. &quot;Mirrors cover every available wall-surface of this hexagonal chamber, allowing you to examine yourself from all angles.&quot;
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "452: Status line with centered text, the hard way" "e395" -->
<a id="e395"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_27.html#e395" class="eglink"><b>452</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_27.html#e395" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Status line with centered text, the hard way</span></b></a><br />A status line which has only the name of the location, centered.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_12.html#e395"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example395">
<p>Making major changes to display features, such as the construction of the status line, sometimes requires that we rely on Inform 6 in bulk; here is how we might produce the Trinity-style status line, with the location centered at the top center of the screen.</p>
<!-- START CODE "c9262_395" -->
<a id="c9262_395"></a><blockquote class="code"><p class="quoted">
&quot;Corner of No and Where&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9263_395" -->
<a id="c9263_395"></a><blockquote class="code"><p class="quoted">
No is a room. Where is west of No.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9264_395" -->
<a id="c9264_395"></a><blockquote class="code"><p class="quoted">
Rule for constructing the status line:
<br />&#160;&#160;&#160;&#160;print the location in the center of the status line;
<br />&#160;&#160;&#160;&#160;rule succeeds.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9265_395" -->
<a id="c9265_395"></a><blockquote class="code"><p class="quoted">
To print the location in the center of the status line:
<br />&#160;&#160;&#160;&#160;(- PrintCenteredStatus(); -).
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9266_395" -->
<a id="c9266_395"></a><blockquote class="code"><p class="quoted">
Include (-
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9267_395" -->
<a id="c9267_395"></a><blockquote class="code"><p class="quoted">
Array printed_text --&gt; 64;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9268_395" -->
<a id="c9268_395"></a><blockquote class="code"><p class="quoted">
[ PrintCenteredStatus i j;
<br />&#160;&#160;&#160;&#160;@set_cursor 1 0;
<br />&#160;&#160;&#160;&#160;i = 0-&gt;33;
<br />&#160;&#160;&#160;&#160;spaces(i);
<br />&#160;&#160;&#160;&#160;@output_stream 3 printed_text;
<br />&#160;&#160;&#160;&#160;print (name) location;
<br />&#160;&#160;&#160;&#160;@output_stream -3;
<br />&#160;&#160;&#160;&#160;j = (i - (printed_text--&gt;0))/2;
<br />&#160;&#160;&#160;&#160;@set_cursor 1 j;
<br />&#160;&#160;&#160;&#160;print (name) location;
<br />&#160;&#160;&#160;&#160;spaces j-1;
<br />];
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9269_395" -->
<a id="c9269_395"></a><blockquote class="code"><p class="quoted">
-)
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9270_395" -->
<a id="c9270_395"></a><blockquote class="code"><p class="quoted">
Test me with &quot;w / e&quot;.
</p></blockquote>
<!-- END CODE -->
<p>In fact, as we've already seen, many extra modifications to the display behavior are possible using Basic Screen Effects.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "453: Chanel Version 1" "e71" -->
<a id="e71"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_27.html#e71" class="eglink"><b>453</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_27.html#e71" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Chanel Version 1</span></b></a><br />Making paired italic and boldface tags like those used by HTML for web pages.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_12.html#e71"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example71">
<p>HTML uses angled brackets to achieve effects, and places italicised text between &lt;i&gt; and &lt;/i&gt; tags; and similarly boldface between &lt;b&gt; and &lt;/b&gt;. We can mimic this very easily by setting each up as a segmented substitution:</p>
<!-- START CODE "c9271_71" -->
<a id="c9271_71"></a><blockquote class="code"><p class="quoted">
&quot;Chanel Version 1&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9272_71" -->
<a id="c9272_71"></a><blockquote class="code"><p class="quoted">
To say i  -- beginning say_i -- running on: (- style underline; -).
<br />To say /i  -- ending say_i -- running on: (- style roman; -).
<br />To say b -- beginning say_b -- running on: (- style bold; -).
<br />To say /b -- ending say_b -- running on: (- style roman; -).
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9273_71" -->
<a id="c9273_71"></a><blockquote class="code"><p class="quoted">
Place Vendôme is a room. &quot;[i]Fashion fades, only style remains the same[/i] ([b]Coco Chanel[/b]). And this elegant drawing-room, once a milliner's shop, is a case in point.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9274_71" -->
<a id="c9274_71"></a><blockquote class="code"><p class="quoted">
Instead of going nowhere, say &quot;[i]Don't spend time beating on a wall, hoping to transform it into a door.[/i] ([b]Coco Chanel[/b]) This one is a wall.&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9275_71" -->
<a id="c9275_71"></a><blockquote class="code"><p class="quoted">
Test me with &quot;look / e&quot;.
</p></blockquote>
<!-- END CODE -->
<p>We have had to use square instead of angle brackets, but then, &quot;in order to be irreplaceable one must always be different&quot; (Coco Chanel).</p>
<p>(Marking these as substitutions which run on prevents unexpected paragraph breaks if they should appear immediately after the end of a sentence.)</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "454: Blink" "e40" -->
<a id="e40"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_27.html#e40" class="eglink"><b>454</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_27.html#e40" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Blink</span></b></a><br />Making a "by atmosphere" token, allowing us to design our own text variations such as "[one of]normal[or]gloomy[or]scary[by atmosphere]".</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_2.html#e40"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example40">
<p>Suppose we are writing a game in which the mood of the piece changes, and we would like to have lots of descriptions that vary according to its current state. We might in that case want to create our own &quot;by atmosphere&quot; token, to control text variations, like this:</p>
<!-- START CODE "c9276_40" -->
<a id="c9276_40"></a><blockquote class="code"><p class="quoted">
&quot;Blink&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9277_40" -->
<a id="c9277_40"></a><blockquote class="code"><p class="quoted">
Atmosphere is a kind of value. The atmospheres are normal, melancholy, and creepy.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9278_40" -->
<a id="c9278_40"></a><blockquote class="code"><p class="quoted">
The current atmosphere is an atmosphere that varies.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9279_40" -->
<a id="c9279_40"></a><blockquote class="code"><p class="quoted">
To say by atmosphere -- ending say_one_of with marker I7_SOO_ATM:
<br />&#160;&#160;&#160;&#160;(- {-close-brace} -).
</p></blockquote>
<!-- END CODE -->
<p>Since we're operating within the untyped Inform 6, we can make use of the fact that kinds of value are (internally) just constants, enumerated in the same order in which they were originally defined. In other words, &quot;normal&quot; at the I6 level translates to 1, &quot;melancholy&quot; to 2, and &quot;creepy&quot; to 3; so we can return the value of the current atmosphere, and thereby select option 1, 2, or 3:</p>
<!-- START CODE "c9280_40" -->
<a id="c9280_40"></a><blockquote class="code"><p class="quoted">
Include (-
<br />[ I7_SOO_ATM oldval count;
<br />&#160;&#160;&#160;&#160;if (count &lt; (+ current atmosphere +)) return count;
<br />&#160;&#160;&#160;&#160;return (+ current atmosphere +); ];
<br />-)
</p></blockquote>
<!-- END CODE -->
<p>And that concludes the hard part. Now to test that it works:</p>
<!-- START CODE "c9281_40" -->
<a id="c9281_40"></a><blockquote class="code"><p class="quoted">
The Flat is a room. &quot;A small [one of]but cozy[or]depressing[or]imprisoning[by atmosphere] flat. Outside the window, the sun is [one of][or][or]apparently [by atmosphere]shining and there is a brisk breeze through the leaves of the birch trees. [one of]It would be quite nice weather for a walk[or]The rest of the world apparently has no appreciation of what you suffer[or]It all looks deceptively normal[by atmosphere].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9282_40" -->
<a id="c9282_40"></a><blockquote class="code"><p class="quoted">
Instead of waiting when the current atmosphere is normal:
<br />&#160;&#160;&#160;&#160;say &quot;Everything stretches wide and flat for just a moment, as though all the world around you were painted on a thin rubber sheet that is being [italic type]stretched[roman type]. Then it snaps back into place, leaving your ears ringing. But that little glitch was enough to warn you. Someone is tampering with space-time again. Someone very close by.&quot;;
<br />&#160;&#160;&#160;&#160;now the current atmosphere is creepy.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9283_40" -->
<a id="c9283_40"></a><blockquote class="code"><p class="quoted">
Test me with &quot;look / z / look&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "455: Uncommon Ground" "e398" -->
<a id="e398"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_27.html#e398" class="eglink"><b>455</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_27.html#e398" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Uncommon Ground</span></b></a><br />Making a "by viewpoint" token, allowing us to design our own text variations such as "[show to yourself]quaint[to Lolita]thrilling[to everyone else]squalid[end show]" depending on the identity of the player at the moment.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_5.html#e398"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example398">
<p>A slightly more challenging case than the &quot;by atmosphere&quot; example is one in which we want to create text variations depending on the identity of our player character.</p>
<p>What we want to do is build a switch statement in I6, one that looks something like</p>
<!-- START CODE "c9284_398" -->
<a id="c9284_398"></a><blockquote class="code"><p class="quoted">
switch(player)
<br />{
<br />&#160;&#160;&#160;&#160;yourself: print &quot;quaint&quot;;
<br />&#160;&#160;&#160;&#160;Lolita: print &quot;thrilling&quot;;
<br />&#160;&#160;&#160;&#160;default: print &quot;squalid&quot;;
<br />}
</p></blockquote>
<!-- END CODE -->
<p>out of I7 that looks like this:</p>
<!-- START CODE "c9285_398" -->
<a id="c9285_398"></a><blockquote class="code"><p class="quoted">
say &quot;[show to yourself]quaint[to Lolita]thrilling[to everyone else]squalid[end show]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9286_398" -->
<a id="c9286_398"></a><blockquote class="code"><p class="quoted">
&quot;Uncommon Ground&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9287_398" -->
<a id="c9287_398"></a><blockquote class="code"><p class="quoted">
The Mud Village is a room. &quot;You stand at the center of a [show to yourself]quaint[to Lolita]thrilling[to everyone else]squalid[end show] mud village.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9288_398" -->
<a id="c9288_398"></a><blockquote class="code"><p class="quoted">
Leforge is a man in the Mud Village. Lolita is a woman in the Mud Village.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9289_398" -->
<a id="c9289_398"></a><blockquote class="code"><p class="quoted">
Instead of waiting:
<br />&#160;&#160;&#160;&#160;if the player is Lolita, now the player is Leforge;
<br />&#160;&#160;&#160;&#160;if the player is yourself, now the player is Lolita;
<br />&#160;&#160;&#160;&#160;say &quot;You jump bodies. Whoops!&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9290_398" -->
<a id="c9290_398"></a><blockquote class="code"><p class="quoted">
To say show to (N - a person) -- beginning say_seen_by:
<br />&#160;&#160;&#160;&#160;(-
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;switch(player)
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{-open-brace}
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{N}:
<br />&#160;&#160;&#160;&#160;-).
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9291_398" -->
<a id="c9291_398"></a><blockquote class="code"><p class="quoted">
To say to (N - a person) -- continuing say_seen_by:
<br />&#160;&#160;&#160;&#160;(-
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{N}:
<br />&#160;&#160;&#160;&#160;-).
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9292_398" -->
<a id="c9292_398"></a><blockquote class="code"><p class="quoted">
To say to everyone else -- continuing say_seen_by:
<br />&#160;&#160;&#160;&#160;(-
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;default:
<br />&#160;&#160;&#160;&#160;-)
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9293_398" -->
<a id="c9293_398"></a><blockquote class="code"><p class="quoted">
To say end show -- ending say_seen_by:
<br />&#160;&#160;&#160;&#160;(-
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{-close-brace}
<br />&#160;&#160;&#160;&#160;-)
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c9294_398" -->
<a id="c9294_398"></a><blockquote class="code"><p class="quoted">
Test me with &quot;look / z / look / z / look&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
</body>
</html>
