<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!-- Generated by indoc on 11 Aug 2016 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_WI.css" rel="stylesheet" type="text/css" />
<title>Chapter 21: Lists</title>
</head>
<body class="paper papertint"><p class="chapterheading">Chapter 21: Lists</p>
<p class="chaptercontents"><a href="WI_21.html#s1" class="standardlink"><span class="chaptercontentsitem">§21.1. Lists and entries</span></a>; <a href="WI_21.html#s2" class="standardlink"><span class="chaptercontentsitem">§21.2. Constant lists</span></a>; <a href="WI_21.html#s3" class="standardlink"><span class="chaptercontentsitem">§21.3. Saying lists of values</span></a>; <a href="WI_21.html#s4" class="standardlink"><span class="chaptercontentsitem">§21.4. Testing and iterating over lists</span></a>; <a href="WI_21.html#s5" class="standardlink"><span class="chaptercontentsitem">§21.5. Building lists</span></a>; <a href="WI_21.html#s6" class="standardlink"><span class="chaptercontentsitem">§21.6. Lists of objects</span></a>; <a href="WI_21.html#s7" class="standardlink"><span class="chaptercontentsitem">§21.7. Lists of values matching a description</span></a>; <a href="WI_21.html#s8" class="standardlink"><span class="chaptercontentsitem">§21.8. Sorting, reversing and rotating lists</span></a>; <a href="WI_21.html#s9" class="standardlink"><span class="chaptercontentsitem">§21.9. Accessing entries in a list</span></a>; <a href="WI_21.html#s10" class="standardlink"><span class="chaptercontentsitem">§21.10. Lengthening or shortening a list</span></a>; <a href="WI_21.html#s11" class="standardlink"><span class="chaptercontentsitem">§21.11. Variations: arrays, logs, queues, stacks, sets, sieves and rings</span></a></p><table class="centredtable"><tr><td class="roadsigndirection"><a href="WI_1.html" class="standardlink"><img alt="arrow-up-left.png" src="images/arrow-up-left.png" /></a></td><td><a href="WI_1.html" class="standardlink">Contents of <i>Writing with Inform</i></a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_20.html" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_20.html" class="standardlink">Chapter 20: Advanced Text</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_22.html" class="standardlink">Chapter 22: Advanced Phrases</a></td></tr>
<tr><td class="roadsigndirection"><a href="examples_alphabetical.html" class="standardlink"><img alt="arrow-down-right.png" src="images/arrow-down-right.png" /></a></td><td><a href="examples_alphabetical.html" class="standardlink">Indexes of the examples</a></td></tr>
</table><p class="sectionheading"><a id="s1"></a>§21.1. Lists and entries</p>
<p>Many sections in this book begin by introducing a new kind of value. Reading through in order, the possibilities mount up: numbers, times, texts, and so on. (See the Kinds page of the Index for a convenient list of the options.) This section is a little different: rather than showing a single new kind of value, it shows how to make a new kind out of any existing one.</p>
<p>If K is any kind of value, then &quot;list of K&quot; is also a kind of value. For instance, we could write:</p>
<!-- START CODE "c8332" -->
<a id="c8332"></a><blockquote class="code"><p class="quoted">
let L be a list of numbers;
</p></blockquote>
<!-- END CODE -->
<p>and this would create a new &quot;let&quot; variable, called L, whose kind of value is &quot;list of numbers&quot;. On the other hand, we are not allowed to write:</p>
<!-- START CODE "c8333" -->
<a id="c8333"></a><blockquote class="code"><p class="quoted">
let L be a list;
</p></blockquote>
<!-- END CODE -->
<p>because &quot;list&quot; by itself is not a kind of value. (Inform always needs to know what kinds the values entered in a list are going to have.)</p>
<p>Lists are like flexible-length table columns, but that probably makes them sound more mysterious than they really are. A list is simply a sequence of values, called its &quot;entries&quot;, numbered from 1 upwards. The number of entries is called its &quot;length&quot;. If we try</p>
<!-- START CODE "c8334" -->
<a id="c8334"></a><blockquote class="code"><p class="quoted">
let L be a list of numbers;
<br />say &quot;L has [the number of entries in L] entries.&quot;;
</p></blockquote>
<!-- END CODE -->
<p>then we find</p>
<!-- START CODE "c8335" -->
<a id="c8335"></a><blockquote class="code"><p class="quoted">
L has 0 entries.
</p></blockquote>
<!-- END CODE -->
<p>This is because all lists start out empty when created: that is, they initially have 0 entries. Inform has two built-in adjectives &quot;empty&quot; and &quot;non-empty&quot; which can apply to lists, and they mean just what they ought to mean: a list is empty if its length is 0, and otherwise non-empty.</p>
<p>We can add entries very easily:</p>
<!-- START CODE "c8336" -->
<a id="c8336"></a><blockquote class="code"><p class="quoted">
add 2 to L; add 3 to L; add 5 to L;
</p></blockquote>
<!-- END CODE -->
<p>We can now, for instance, try saying the list:</p>
<!-- START CODE "c8337" -->
<a id="c8337"></a><blockquote class="code"><p class="quoted">
say &quot;L is now [L].&quot;;
</p></blockquote>
<!-- END CODE -->
<p>with the result</p>
<!-- START CODE "c8338" -->
<a id="c8338"></a><blockquote class="code"><p class="quoted">
L is now 2, 3 and 5.
</p></blockquote>
<!-- END CODE -->
<p>Note that only numbers can be added to L: if we try</p>
<!-- START CODE "c8339" -->
<a id="c8339"></a><blockquote class="code"><p class="quoted">
add &quot;clock&quot; to L;
</p></blockquote>
<!-- END CODE -->
<p>Inform will produce a problem message, because L has kind &quot;list of numbers&quot;, whereas &quot;clock&quot; is text. In this way, Inform ensures that a list always contains values of the same kind throughout. So it's not possible to construct a list whose entries are:</p>
<!-- START CODE "c8340" -->
<a id="c8340"></a><blockquote class="code"><p class="quoted">
2, &quot;fish&quot;, 4 and the Entire Game
</p></blockquote>
<!-- END CODE -->
<p>Such a list would be very hazardous to deal with, in any case. If what we need is a combination of different kinds of values, tables are a better option.</p>
<p>Finally, note that since &quot;list of numbers&quot; is a kind of value in its own right, so is &quot;list of lists of numbers&quot;, and so on - though such lists are trickier to deal with, they are sometimes handy.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_21.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_21.html" class="standardlink">Start of Chapter 21: Lists</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_20.html#s9" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_20.html#s9" class="standardlink">Back to Chapter 20: Advanced Text: §20.9. Summary of regular expression notation</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s2" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_21.html#s2" class="standardlink">Onward to §21.2. Constant lists</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s2"></a>§21.2. Constant lists</p>
<p>It is convenient to have a concise way to write down a constant list. Just as we could write &quot;231&quot;, say, or &quot;7:01 AM&quot; to refer to particular number and time constants, so we can write list constants:</p>
<!-- START CODE "c8341" -->
<a id="c8341"></a><blockquote class="code"><p class="quoted">
let L be {1, 2, 3, 4};
</p></blockquote>
<!-- END CODE -->
<p>Inform recognises that &quot;{1, 2, 3, 4}&quot; is a list because of the braces, and looks at the entries inside, sees that they are numbers, and deduces that it is a constant whose kind of value is &quot;list of numbers&quot;. L is then a temporary list variable and we can add to it, remove things, and so on as we please - {1, 2, 3, 4} is merely its initial value.</p>
<p>When constructing lists, it is worth noting that Inform requires spaces after the commas (which seems a little harsh, but is necessary because otherwise many sensible literal specifications for units would be impossible - anyway, the reason isn't important here). So</p>
<!-- START CODE "c8342" -->
<a id="c8342"></a><blockquote class="code"><p class="quoted">
let L be {1,2,3,4};
</p></blockquote>
<!-- END CODE -->
<p>would produce problem messages. But Inform does not require spaces round its braces.</p>
<p>We call this way of writing a list &quot;brace notation&quot;. In mathematics, braces are usually used for sets, and properly speaking these are sequences not sets - so that &quot;{1, 2, 3, 4}&quot; is different from &quot;{4, 3, 2, 1}&quot; - but it is still a familiar notation. Similarly,</p>
<!-- START CODE "c8343" -->
<a id="c8343"></a><blockquote class="code"><p class="quoted">
let L be {&quot;apple&quot;, &quot;pear&quot;, &quot;loganberry&quot;};
</p></blockquote>
<!-- END CODE -->
<p>makes L a list of texts; and</p>
<!-- START CODE "c8344" -->
<a id="c8344"></a><blockquote class="code"><p class="quoted">
The marshmallow, the firework and the stink bomb are in the Scout Hut. The list of prohibited items is a list of objects that varies. The list of prohibited items is {the firework, the stink bomb}.
</p></blockquote>
<!-- END CODE -->
<p>makes a global variable (&quot;list of prohibited items&quot;) with kind of value &quot;list of objects&quot;, and whose initial value is to contain two things: the firework and the stink bomb. More exotically, if we need to make lists of lists:</p>
<!-- START CODE "c8345" -->
<a id="c8345"></a><blockquote class="code"><p class="quoted">
let L be {{1, 2}, {6, 7, 8}};
</p></blockquote>
<!-- END CODE -->
<p>gives L the kind of value &quot;list of lists of numbers&quot;, with (initially) two entries: the list {1, 2} (a list of numbers), then the list {6, 7, 8} (ditto).</p>
<p>Constant lists are convenient, too, when a column in a table needs to contain lists:</p>
<!-- START CODE "c8346" -->
<a id="c8346"></a><blockquote class="code"><p class="quoted">
The duck, the orange, the cider, the cinnamon and the orange are in the Kitchen.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8347" -->
<a id="c8347"></a><blockquote class="code"><p class="quoted">
Table of Requirements
<br /></p></blockquote><table class="codetable">
<tr><td class="quotedtablecell"><p class="quoted">recipe</p></td><td class="quotedtablecell"><p class="quoted">ingredients</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">&quot;duck à l'orange&quot;</p></td><td class="quotedtablecell"><p class="quoted">{the duck, the orange}</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">&quot;spiced cider&quot;</p></td><td class="quotedtablecell"><p class="quoted">{the cider, the cinnamon, the orange}</p></td></tr>
</table><blockquote><p>
</p></blockquote>
<!-- END CODE -->
<p>A special word about the constant list &quot;{ }&quot;. This means the list with no entries - the empty list. If we try to create a new &quot;let&quot; variable M with</p>
<!-- START CODE "c8348" -->
<a id="c8348"></a><blockquote class="code"><p class="quoted">
let M be { };
</p></blockquote>
<!-- END CODE -->
<p>then Inform will produce a problem message, because it cannot tell what sort of list M will be: a list of numbers, or texts, or times, or...? On the other hand, writing</p>
<!-- START CODE "c8349" -->
<a id="c8349"></a><blockquote class="code"><p class="quoted">
let M be { };
</p></blockquote>
<!-- END CODE -->
<p>is fine provided that M already exists, and then does the obvious thing - empties M. Similarly, a table column in which every entry is &quot;{ }&quot; produces a problem message unless the heading for that column spells out the kind of value stored within it: for instance, &quot;ingredients (list of texts)&quot;.</p>
<p>All of this is a notation for constant lists only, not some sort of gluing-things-together operation. So this, for instance:</p>
<!-- START CODE "c8350" -->
<a id="c8350"></a><blockquote class="code"><p class="quoted">
let L be {100, the turn count};
</p></blockquote>
<!-- END CODE -->
<p>is not allowed, even though &quot;the turn count&quot; is a number: because it is a number that varies, the braces do not contain constants, and therefore this is not a list constant.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_21.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_21.html" class="standardlink">Start of Chapter 21: Lists</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s1" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_21.html#s1" class="standardlink">Back to §21.1. Lists and entries</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s3" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_21.html#s3" class="standardlink">Onward to §21.3. Saying lists of values</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s3"></a>§21.3. Saying lists of values</p>
<p>Any list L can be said, provided that its contents can be said. For example:</p>
<!-- START CODE "c8351" -->
<a id="c8351"></a><blockquote class="code"><p class="quoted">
let L1 be {2, 3, 5, 7, 11};
<br />say L1;
</p></blockquote>
<!-- END CODE -->
<p>produces the text &quot;2, 3, 5, 7 and 11&quot; - unless we have &quot;Use serial comma.&quot; set, in which case a comma appears after the 7. We also have the option of using the more formal notation:</p>
<!-- START PHRASE "defn324" -->
<div class="definition"><a id="defn324"></a><p class="defnprototype"><b>say &quot;[</b>(list of values)<b> in brace notation]&quot;</b></p>
<!-- END PHRASE -->
<!-- definition of phs_listbraced -->

<p>This text substitution produces the list in the form of &quot;{&quot;, then a comma-separated list, and then &quot;}&quot;, which looks less like an English sentence but more mathematical. Example:</p>
<!-- START CODE "c8352" -->
<a id="c8352"></a><blockquote class="code"><p class="quoted">
&quot;[list of people in brace notation]&quot;
</p></blockquote>
<!-- END CODE -->
<p>might produce &quot;{ yourself, Mr Darcy, Flashman }&quot;.</p>

<!-- end definition -->
</div>

<p>If we say a list of lists, then the individual entry lists are always printed in brace notation: the ordinary sentence way would be incomprehensible.</p>
<p>Of course, the values in L1 are written out in number form because L1 is a list of numbers: we could alternatively try</p>
<!-- START CODE "c8353" -->
<a id="c8353"></a><blockquote class="code"><p class="quoted">
let L2 be {the piano, the music stand};
<br />say L2;
</p></blockquote>
<!-- END CODE -->
<p>which produces &quot;piano and music stand&quot;. Lists of objects can be said in two additional ways:</p>
<!-- START PHRASE "defn325" -->
<div class="definition"><a id="defn325"></a><p class="defnprototype"><b>say &quot;[</b>(list of objects)<b> with definite articles]&quot;</b></p>
<!-- END PHRASE -->
<!-- definition of phs_listdef -->

<p>This text substitution writes out the list in sentence form, adding the appropriate definite articles. Example:</p>
<!-- START CODE "c8354" -->
<a id="c8354"></a><blockquote class="code"><p class="quoted">
let L be {the piano, the music stand};
<br />say &quot;[L with definite articles]&quot;;
</p></blockquote>
<!-- END CODE -->
<p>says &quot;the piano and the music stand&quot;.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn326" -->
<div class="definition"><a id="defn326"></a><p class="defnprototype"><b>say &quot;[</b>(list of objects)<b> with indefinite articles]&quot;</b></p>
<!-- END PHRASE -->
<!-- definition of phs_listindef -->

<p>This text substitution writes out the list in sentence form, adding the appropriate indefinite articles. Example:</p>
<!-- START CODE "c8355" -->
<a id="c8355"></a><blockquote class="code"><p class="quoted">
let L be {the piano, the music stand};
<br />say &quot;[L with definite articles]&quot;;
</p></blockquote>
<!-- END CODE -->
<p>says &quot;a piano and a music stand&quot;.</p>

<!-- end definition -->
</div>

<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_21.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_21.html" class="standardlink">Start of Chapter 21: Lists</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s2" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_21.html#s2" class="standardlink">Back to §21.2. Constant lists</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s4" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_21.html#s4" class="standardlink">Onward to §21.4. Testing and iterating over lists</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#e279" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_21.html#e279" class="standardlink">Example 425: <img class="asterisk" alt="*" src="images/asterisk.png" /> <b>Oyster Wide Shut</b>&#160;&#160;&#160; Replacing Inform's default printing of properties such as "(closed)", "(open and providing light)", etc., with our own, more flexible variation.</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s4"></a>§21.4. Testing and iterating over lists</p>
<p>If L is a list, we can interrogate it to see whether it does or does not contain (at least one instance of) any compatible value V:</p>
<!-- START PHRASE "defn327" -->
<div class="definition"><a id="defn327"></a><p class="defnprototype"><b>if </b>(value)<b> is listed in </b>(list of values)<b>:</b></p>
<!-- END PHRASE -->
<!-- definition of ph_islistedin -->

<p>This condition is true if the given value, which must be of a compatible kind, is one of those in the list. For instance, if L is our list of the numbers 2, 3, 5, 7 and 11 then 5 is listed in it but 6 is not.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn328" -->
<div class="definition"><a id="defn328"></a><p class="defnprototype"><b>if </b>(value)<b> is not listed in </b>(list of values)<b>:</b></p>
<!-- END PHRASE -->
<!-- definition of ph_isnotlistedin -->

<p>This condition is true if the given value, which must be of a compatible kind, is not one of those in the list.</p>

<!-- end definition -->
</div>

<p>We can also repeat running through a list (just as we can with table rows). Thus:</p>
<!-- START PHRASE "defn329" -->
<div class="definition"><a id="defn329"></a><p class="defnprototype"><b>repeat with </b>(a name not so far used)<b> running through </b>(list of values)<b>:</b></p>
<!-- END PHRASE -->
<!-- definition of ph_repeatlist -->

<p>This phrase causes the block of phrases following it to be repeated once for each item in the given list, storing that value in the named variable. (The variable exists only temporarily, within the repetition.) Example:</p>
<!-- START CODE "c8356" -->
<a id="c8356"></a><blockquote class="code"><p class="quoted">
let L be {2, 3, 5, 7, 11, 13, 17, 19};
<br />repeat with prime running through L:
<br />&#160;&#160;&#160;&#160;...
</p></blockquote>
<!-- END CODE -->
<p>If the list is empty, nothing happens: the &quot;...&quot; phrase(s) are never tried.</p>

<!-- end definition -->
</div>

<p>In the next sections, we shall see that it is possible to change, reorder and resize lists. But it's important never to change a list that's being repeated through. The following:</p>
<!-- START CODE "c8357" -->
<a id="c8357"></a><blockquote class="code"><p class="quoted">
let L1 be {1, 2, 3, 4};
<br />repeat with n running through L1:
<br />&#160;&#160;&#160;&#160;remove n from L1;
</p></blockquote>
<!-- END CODE -->
<p>leaves L1 containing {2, 4}, since the removals from the list cause it to shuffle back even while we repeat through it - a bad, bad idea.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_21.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_21.html" class="standardlink">Start of Chapter 21: Lists</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s3" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_21.html#s3" class="standardlink">Back to §21.3. Saying lists of values</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s5" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_21.html#s5" class="standardlink">Onward to §21.5. Building lists</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s5"></a>§21.5. Building lists</p>
<p>We have already seen &quot;add... to...&quot;. This in fact comes in two forms:</p>
<!-- START PHRASE "defn330" -->
<div class="definition"><a id="defn330"></a><p class="defnprototype"><b>add </b>(value)<b> to </b>(list of values)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_addtolist -->

<p>This phrase adds the given value to the end of the list. Example:</p>
<!-- START CODE "c8358" -->
<a id="c8358"></a><blockquote class="code"><p class="quoted">
let L be {60, 168};
<br />add 360 to L;
</p></blockquote>
<!-- END CODE -->
<p>results in L being {60, 168, 360}. Note that the value is added even if it already occurs somewhere in L; this can be avoided with &quot;if absent&quot;. So:</p>
<!-- START CODE "c8359" -->
<a id="c8359"></a><blockquote class="code"><p class="quoted">
add 168 to L, if absent;
</p></blockquote>
<!-- END CODE -->
<p>would do nothing - it is already there.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn331" -->
<div class="definition"><a id="defn331"></a><p class="defnprototype"><b>add </b>(list of values)<b> to </b>(list of values)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_addlisttolist -->

<p>This phrase adds the first list to the end of the second. Example:</p>
<!-- START CODE "c8360" -->
<a id="c8360"></a><blockquote class="code"><p class="quoted">
let L be {2, 3, 5, 7};
<br />add {11, 13, 17, 19} to L;
</p></blockquote>
<!-- END CODE -->
<p>results in L being {2, 3, 5, 7, 11, 13, 17, 19}.</p>

<!-- end definition -->
</div>

<p>If we don't want to add new entries at the end, we can instead say where they should go:</p>
<!-- START PHRASE "defn332" -->
<div class="definition"><a id="defn332"></a><p class="defnprototype"><b>add </b>(value)<b> at entry </b>(number)<b> in </b>(list of values)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_addatentry -->

<p>This phrase adds the given value so that it becomes the entry with that index number in the list. Example:</p>
<!-- START CODE "c8361" -->
<a id="c8361"></a><blockquote class="code"><p class="quoted">
let L be {1, 2, 3, 4, 8, 24};
<br />add 12 at entry 6 in L;
</p></blockquote>
<!-- END CODE -->
<p>sets L to {1, 2, 3, 4, 8, 12, 24}. If there are N entries in L, then we can add at any of entries 1 up to N+1: adding at entry N+1 means adding at the end. The phrase option &quot;if absent&quot; makes the phrase do nothing if the value already exists anywhere in L.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn333" -->
<div class="definition"><a id="defn333"></a><p class="defnprototype"><b>add </b>(list of values)<b> at entry </b>(number)<b> in </b>(list of values)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_addlistatentry -->

<p>This phrase adds the first list to the second so that it begins at the given position. Example:</p>
<!-- START CODE "c8362" -->
<a id="c8362"></a><blockquote class="code"><p class="quoted">
let L be {1, 2, 3, 4};
<br />add {4, 8, 12} at entry 3 in L;
</p></blockquote>
<!-- END CODE -->
<p>results in L being {1, 2, 4, 8, 12, 3, 4}.</p>

<!-- end definition -->
</div>

<p>A list is allowed to contain duplicates, and the order matters. For instance:</p>
<!-- START CODE "c8363" -->
<a id="c8363"></a><blockquote class="code"><p class="quoted">
let L be {2, 2, 3};
</p></blockquote>
<!-- END CODE -->
<p>makes L into &quot;2, 2 and 3&quot;. This is a different list to the one made by:</p>
<!-- START CODE "c8364" -->
<a id="c8364"></a><blockquote class="code"><p class="quoted">
let M be {2, 3, 2};
</p></blockquote>
<!-- END CODE -->
<p>even though L and M have the same values, repeated the same number of times - for two lists to be equal, they must have the same kind of entry, the same number of entries, and the same entries in each position.</p>
<p>We can also strike out values:</p>
<!-- START PHRASE "defn334" -->
<div class="definition"><a id="defn334"></a><p class="defnprototype"><b>remove </b>(value)<b> from </b>(list of values)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_remfromlist -->

<p>This phrase removes every instance of the given value from the list. Example:</p>
<!-- START CODE "c8365" -->
<a id="c8365"></a><blockquote class="code"><p class="quoted">
let L be {3, 1, 4, 1, 5, 9, 2, 6, 5, 3};
<br />remove 1 from L;
</p></blockquote>
<!-- END CODE -->
<p>results in L being {3, 4, 5, 9, 2, 6, 5, 3}. Ordinarily &quot;remove 7 from L&quot; would produce a run-time problem, since L does not contain the value 7, but using the &quot;if present&quot; option lets us off this: the phrase then does nothing if L does not contain the value to be removed.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn335" -->
<div class="definition"><a id="defn335"></a><p class="defnprototype"><b>remove </b>(list of values)<b> from </b>(list of values)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_remlistfromlist -->

<p>This phrase removes every instance of any value in the first list from the second. Example:</p>
<!-- START CODE "c8366" -->
<a id="c8366"></a><blockquote class="code"><p class="quoted">
let L be {3, 1, 4, 1, 5, 9, 2, 6, 5, 3};
<br />remove {0, 2, 4, 6, 8} from L;
</p></blockquote>
<!-- END CODE -->
<p>results in L being {3, 1, 1, 5, 9, 5, 3}. If both lists are large, this can be a slow process, and we might do better by sorting them and trying a more sophisticated method. But this is convenient for anything reasonable-sized.</p>

<!-- end definition -->
</div>

<p>Again, we can also remove from specific positions:</p>
<!-- START PHRASE "defn336" -->
<div class="definition"><a id="defn336"></a><p class="defnprototype"><b>remove entry </b>(number)<b> from </b>(list of values)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_rementry -->

<p>This phrase removes the entry at the given position, counting from 1 as the first entry. (Once it is removed, the other entries shuffle down.) Example:</p>
<!-- START CODE "c8367" -->
<a id="c8367"></a><blockquote class="code"><p class="quoted">
let L be {3, 1, 4, 1, 5, 9, 2, 6, 5, 3};
<br />remove entry 3 from L;
</p></blockquote>
<!-- END CODE -->
<p>results in L being {3, 1, 1, 5, 9, 2, 6, 5, 3}.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn337" -->
<div class="definition"><a id="defn337"></a><p class="defnprototype"><b>remove entries </b>(number)<b> to </b>(number)<b> from </b>(list of values)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_rementries -->

<p>This phrase removes the entries at the given range of positions, counting from 1 as the first entry. (Once they are removed, the other entries shuffle down.) Example:</p>
<!-- START CODE "c8368" -->
<a id="c8368"></a><blockquote class="code"><p class="quoted">
let L be {3, 1, 4, 1, 5, 9, 2, 6, 5, 3};
<br />remove entries 3 to 6 from L;
</p></blockquote>
<!-- END CODE -->
<p>results in L being {3, 1, 2, 6, 5, 3}.</p>

<!-- end definition -->
</div>

<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_21.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_21.html" class="standardlink">Start of Chapter 21: Lists</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s4" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_21.html#s4" class="standardlink">Back to §21.4. Testing and iterating over lists</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s6" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_21.html#s6" class="standardlink">Onward to §21.6. Lists of objects</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#e326" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_21.html#e326" class="standardlink">Example 426: <img class="asterisk" alt="*" src="images/asterisk.png" /> <b>Robo 1</b>&#160;&#160;&#160; A robot which watches and records the player's actions, then tries to repeat them back in the same order when he is switched into play-back mode.</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s6"></a>§21.6. Lists of objects</p>
<p>Lists can be made of values of any kind (including other lists), but lists of objects are especially useful. We could always make these &quot;by hand&quot;:</p>
<!-- START CODE "c8369" -->
<a id="c8369"></a><blockquote class="code"><p class="quoted">
let L be {the pot plant, the foxglove};
</p></blockquote>
<!-- END CODE -->
<p>But it is usually easier and clearer to use descriptions.</p>
<!-- START PHRASE "defn338" -->
<div class="definition"><a id="defn338"></a><p class="defnprototype"><b>list of </b>(description of values)<b> ... value</b></p>
<!-- END PHRASE -->
<!-- definition of ph_listofdesc -->

<p>This phrase produces the list of all values matching the given description. Inform will issue a problem message if the result would be an infinite list, or one which is impractical to test: for instance &quot;list of even numbers&quot; is not feasible.</p>

<!-- end definition -->
</div>

<p>While that works nicely for many kinds of value (&quot;list of recurring scenes&quot;, say), it's particularly useful for objects:</p>
<!-- START CODE "c8370" -->
<a id="c8370"></a><blockquote class="code"><p class="quoted">
let L be the list of open containers;
<br />add the list of open doors to L;
</p></blockquote>
<!-- END CODE -->
<p>means that L now contains the open containers (if any) followed by the open doors (if any). Or, for example:</p>
<!-- START CODE "c8371" -->
<a id="c8371"></a><blockquote class="code"><p class="quoted">
let L be the list of things;
<br />remove the list of backdrops from L;
</p></blockquote>
<!-- END CODE -->
<p>makes a list of all non-backdrops.</p>
<p>As mentioned above, lists of objects can be said in two additional ways:</p>
<!-- START CODE "c8372" -->
<a id="c8372"></a><blockquote class="code"><p class="quoted">
&quot;[L with definite articles]&quot;
<br />&quot;[L with indefinite articles]&quot;
</p></blockquote>
<!-- END CODE -->
<p>And as mentioned below, they can be sorted in property value order:</p>
<!-- START CODE "c8373" -->
<a id="c8373"></a><blockquote class="code"><p class="quoted">
sort L in P order;
<br />sort L in reverse P order;
</p></blockquote>
<!-- END CODE -->
<p>where P is any value property. In all other respects, lists of objects are no different to other lists.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_21.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_21.html" class="standardlink">Start of Chapter 21: Lists</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s5" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_21.html#s5" class="standardlink">Back to §21.5. Building lists</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s7" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_21.html#s7" class="standardlink">Onward to §21.7. Lists of values matching a description</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#e434" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_21.html#e434" class="standardlink">Example 427: <img class="asterisk" alt="*" src="images/asterisk.png" /> <b>What Makes You Tick</b>&#160;&#160;&#160; Building a fishing pole from several component parts that the player might put together in any order.</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#e156" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_21.html#e156" class="standardlink">Example 428: <img class="asterisk" alt="*" src="images/asterisk.png" /><img class="asterisk" alt="*" src="images/asterisk.png" /> <b>Formicidae</b>&#160;&#160;&#160; Manipulating the order in which items are handled after TAKE ALL.</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s7"></a>§21.7. Lists of values matching a description</p>
<p>The useful &quot;list of ...&quot; syntax can also be used to produce lists of the values matching a description, too. Thus:</p>
<!-- START CODE "c8374" -->
<a id="c8374"></a><blockquote class="code"><p class="quoted">
let L be the list of non-recurring scenes;
<br />let C be the list of colours;
</p></blockquote>
<!-- END CODE -->
<p>There is little to say here except for the usual warning that some kinds of value have a range which is too large to make this possible. For instance, Inform could not sensibly represent:</p>
<!-- START CODE "c8375" -->
<a id="c8375"></a><blockquote class="code"><p class="quoted">
let N be the list of even numbers;
</p></blockquote>
<!-- END CODE -->
<p>It would just be too large to hold. In general, if we can repeat through, or find the number of, values matching a description, then we can also use &quot;list of&quot; to bring them all together. See the chart of kinds of value in the Kinds index for a project for which kinds of value allow this.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_21.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_21.html" class="standardlink">Start of Chapter 21: Lists</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s6" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_21.html#s6" class="standardlink">Back to §21.6. Lists of objects</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s8" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_21.html#s8" class="standardlink">Onward to §21.8. Sorting, reversing and rotating lists</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s8"></a>§21.8. Sorting, reversing and rotating lists</p>
<p>Any list L can be reversed:</p>
<!-- START PHRASE "defn339" -->
<div class="definition"><a id="defn339"></a><p class="defnprototype"><b>reverse </b>(list of values)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_reverselist -->

<p>This phrase puts the list in reverse order. The old entry 1 becomes the new last entry, and so on: reversing an empty list or a list containing only one entry leaves it unchanged. Example:</p>
<!-- START CODE "c8376" -->
<a id="c8376"></a><blockquote class="code"><p class="quoted">
let L be {11, 12, 14, 15, 16, 17};
<br />reverse L;
</p></blockquote>
<!-- END CODE -->
<p>results in L being {17, 16, 15, 14, 12, 11}.</p>

<!-- end definition -->
</div>

<p>And any list can similarly be sorted:</p>
<!-- START PHRASE "defn340" -->
<div class="definition"><a id="defn340"></a><p class="defnprototype"><b>sort </b>(list of values)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_sortlist -->

<p>This phrase puts the list into ascending order. Example:</p>
<!-- START CODE "c8377" -->
<a id="c8377"></a><blockquote class="code"><p class="quoted">
let L be {6 PM, 11:13 AM, 4:21 PM, 9:01 AM};
<br />sort L;
</p></blockquote>
<!-- END CODE -->
<p>results in L being {9:01 AM, 11:13 AM, 4:21 PM, 6 PM}.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn341" -->
<div class="definition"><a id="defn341"></a><p class="defnprototype"><b>sort </b>(list of values)<b> in reverse order</b></p>
<!-- END PHRASE -->
<!-- definition of ph_sortlistreverse -->

<p>This phrase puts the list into descending order. Example:</p>
<!-- START CODE "c8378" -->
<a id="c8378"></a><blockquote class="code"><p class="quoted">
let L be {6 PM, 11:13 AM, 4:21 PM, 9:01 AM};
<br />sort L in reverse order;
</p></blockquote>
<!-- END CODE -->
<p>results in L being {6 PM, 4:21 PM, 11:13 AM, 9:01 AM}.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn342" -->
<div class="definition"><a id="defn342"></a><p class="defnprototype"><b>sort </b>(list of values)<b> in random order</b></p>
<!-- END PHRASE -->
<!-- definition of ph_sortlistrandom -->

<p>This phrase puts the list into a uniformly random order, shuffling it as if it were a pack of cards. Example:</p>
<!-- START CODE "c8379" -->
<a id="c8379"></a><blockquote class="code"><p class="quoted">
let L be {1, 2, 3, 4, 5, 6};
<br />sort L in random order;
</p></blockquote>
<!-- END CODE -->
<p>might result in L being {3, 1, 5, 6, 4, 2}. Or any of 719 other arrangements, including being left as it was.</p>

<!-- end definition -->
</div>

<p>Lists of objects can also be sorted in property value order. For instance,</p>
<!-- START PHRASE "defn343" -->
<div class="definition"><a id="defn343"></a><p class="defnprototype"><b>sort </b>(list of objects)<b> in </b>(property)<b> order</b></p>
<!-- END PHRASE -->
<!-- definition of ph_sortlistproperty -->

<p>This phrase puts the list into ascending order of the values of the given property for the items in the list; this is only allowed if all of those values do have the property in question. Example:</p>
<!-- START CODE "c8380" -->
<a id="c8380"></a><blockquote class="code"><p class="quoted">
let L be the list of people;
<br />sort L in carrying capacity order;
</p></blockquote>
<!-- END CODE -->
<p>would arrange people with weaklings first, titans last.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn344" -->
<div class="definition"><a id="defn344"></a><p class="defnprototype"><b>sort </b>(list of objects)<b> in reverse </b>(property)<b> order</b></p>
<!-- END PHRASE -->
<!-- definition of ph_sortlistpropertyreverse -->

<p>This phrase puts the list into descending order of the values of the given property for the items in the list; this is only allowed if all of those values do have the property in question. Example:</p>
<!-- START CODE "c8381" -->
<a id="c8381"></a><blockquote class="code"><p class="quoted">
let L be the list of people;
<br />sort L in reverse carrying capacity order;
</p></blockquote>
<!-- END CODE -->
<p>would arrange people with titans first, weaklings last.</p>

<!-- end definition -->
</div>

<p>Rotating a list means moving all of its entries along by one place, and then moving the one on the end back to the start. For instance, if L is {1, 2, 3, 4}, then</p>
<!-- START PHRASE "defn345" -->
<div class="definition"><a id="defn345"></a><p class="defnprototype"><b>rotate </b>(list of values)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_rotatelist -->

<p>This phrase shuffles the entries of the list forwards (to the right) by one place, so that the 1st becomes 2nd, the 2nd becomes 3rd, and so on until the last, which becomes the new first entry. Example:</p>
<!-- START CODE "c8382" -->
<a id="c8382"></a><blockquote class="code"><p class="quoted">
let L be { &quot;cow&quot;, &quot;heifer&quot;, &quot;bullock&quot; };
<br />rotate L;
</p></blockquote>
<!-- END CODE -->
<p>results in L being { &quot;bullock&quot;, &quot;cow&quot;, &quot;heifer&quot; }.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn346" -->
<div class="definition"><a id="defn346"></a><p class="defnprototype"><b>rotate </b>(list of values)<b> backwards</b></p>
<!-- END PHRASE -->
<!-- definition of ph_rotatelistback -->

<p>This phrase shuffles the entries of the list backwards (to the left) by one place, so that the 3rd becomes 2nd, the 2nd becomes 1st, and so on; the previous 1st entry becomes the new last entry. Example:</p>
<!-- START CODE "c8383" -->
<a id="c8383"></a><blockquote class="code"><p class="quoted">
let L be { &quot;cow&quot;, &quot;heifer&quot;, &quot;bullock&quot; };
<br />rotate L backwards;
</p></blockquote>
<!-- END CODE -->
<p>results in L being { &quot;heifer&quot;, &quot;bullock&quot;, &quot;cow&quot;}. (This achieves the same effect as &quot;reverse L; rotate L; reverse L;&quot; but is a little faster, and a lot less effort to read.)</p>

<!-- end definition -->
</div>

<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_21.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_21.html" class="standardlink">Start of Chapter 21: Lists</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s7" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_21.html#s7" class="standardlink">Back to §21.7. Lists of values matching a description</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s9" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_21.html#s9" class="standardlink">Onward to §21.9. Accessing entries in a list</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s9"></a>§21.9. Accessing entries in a list</p>
<p>The length of a list can change as values are added or removed, and can in principle be any number from 0 upwards. A list with 0 entries is empty. We can find the length with:</p>
<!-- START PHRASE "defn347" -->
<div class="definition"><a id="defn347"></a><p class="defnprototype"><b>number of entries in</b>/of<b> </b>(list of values)<b> ... number</b></p>
<!-- END PHRASE -->
<!-- definition of ph_numberentries -->

<p>This phrase produces the number of positions in the list. Example:</p>
<!-- START CODE "c8384" -->
<a id="c8384"></a><blockquote class="code"><p class="quoted">
the number of entries in {1, 1, 1, 3, 1}
</p></blockquote>
<!-- END CODE -->
<p>is 5, even though there are only two genuinely different items in the list.</p>

<!-- end definition -->
</div>

<p>If the length is N then the entries are numbered from 1 (the front) to N (the back). These entries can be accessed directly by their numbers. For instance,</p>
<!-- START CODE "c8385" -->
<a id="c8385"></a><blockquote class="code"><p class="quoted">
entry 2 of L
</p></blockquote>
<!-- END CODE -->
<p>refers to the second entry of L: it can be used as a value, or changed, just as if it were a named variable. For instance, we could write:</p>
<!-- START CODE "c8386" -->
<a id="c8386"></a><blockquote class="code"><p class="quoted">
now entry 7 of L is &quot;Spain&quot;;
<br />say &quot;The rain in [entry 7 of L] stays mainly in the plain.&quot;;
</p></blockquote>
<!-- END CODE -->
<p>which would (untruthfully) print &quot;The rain in Spain stays mainly in the plain&quot;, but only if L had an entry 7 to make use of: if L were a list of 5 entries, say, then a run-time problem results. (And if L cannot hold text, a problem message means that we never get as far as run-time.) Because entries number from 1, this is always incorrect:</p>
<!-- START CODE "c8387" -->
<a id="c8387"></a><blockquote class="code"><p class="quoted">
entry 0 of L
</p></blockquote>
<!-- END CODE -->
<p>and if L is currently empty, then there is no entry which can be accessed, so that any use of &quot;entry ... of L&quot; would produce a run-time problem. There are programming languages in the world where accessing entry 100 in a 7-entry list automatically extends it to be 100 entries long: Inform is not one of them. But see the next section for how to change list lengths explicitly.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_21.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_21.html" class="standardlink">Start of Chapter 21: Lists</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s8" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_21.html#s8" class="standardlink">Back to §21.8. Sorting, reversing and rotating lists</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s10" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_21.html#s10" class="standardlink">Onward to §21.10. Lengthening or shortening a list</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#e327" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_21.html#e327" class="standardlink">Example 429: <img class="asterisk" alt="*" src="images/asterisk.png" /><img class="asterisk" alt="*" src="images/asterisk.png" /><img class="asterisk" alt="*" src="images/asterisk.png" /> <b>Robo 2</b>&#160;&#160;&#160; A robot which watches and records the player's actions, then tries to repeat them back in the same order when he is switched into play-back mode.</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s10"></a>§21.10. Lengthening or shortening a list</p>
<p>We can explicitly change the length of a list like so:</p>
<!-- START PHRASE "defn348" -->
<div class="definition"><a id="defn348"></a><p class="defnprototype"><b>change </b>(list of values)<b> to have </b>(number)<b> entries</b>/entry</p>
<!-- END PHRASE -->
<!-- definition of ph_changelength -->

<p>This phrase alters the given list so that it now has exactly the number of entries given. Example:</p>
<!-- START CODE "c8388" -->
<a id="c8388"></a><blockquote class="code"><p class="quoted">
change L to have 21 entries;
</p></blockquote>
<!-- END CODE -->
<p>If L previously had more than 21 entries, they are thrown away (and lost forever); if L previously had fewer, then new entries are created, using the default value for whatever kind of value L holds. So extending a list of numbers will pad it out with 0s, but extending a list of texts will pad it out with the empty text &quot;&quot;, and so on.</p>

<!-- end definition -->
</div>

<p>We can also write the equivalent phrases:</p>
<!-- START PHRASE "defn349" -->
<div class="definition"><a id="defn349"></a><p class="defnprototype"><b>truncate </b>(list of values)<b> to </b>(number)<b> entries</b>/entry</p>
<!-- END PHRASE -->
<!-- definition of ph_truncate -->

<p>This phrase alters the given list so that it now has no more than the number of entries given. Example:</p>
<!-- START CODE "c8389" -->
<a id="c8389"></a><blockquote class="code"><p class="quoted">
truncate L to 8 entries;
</p></blockquote>
<!-- END CODE -->
<p>shortens L to length 8 if it is currently longer than that, trimming entries from the end, but would (for instance) leave a list of length 3 unchanged. Note that</p>
<!-- START CODE "c8390" -->
<a id="c8390"></a><blockquote class="code"><p class="quoted">
truncate L to 0 entries;
</p></blockquote>
<!-- END CODE -->
<p>empties it to { }, the list with nothing in.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn350" -->
<div class="definition"><a id="defn350"></a><p class="defnprototype"><b>truncate </b>(list of values)<b> to the first </b>(number)<b> entries</b>/entry</p>
<!-- END PHRASE -->
<!-- definition of ph_truncatefirst -->

<p>This phrase alters the given list so that it now consists only of the initial part of the list with the given length. Example:</p>
<!-- START CODE "c8391" -->
<a id="c8391"></a><blockquote class="code"><p class="quoted">
truncate L to the first 4 entries;
</p></blockquote>
<!-- END CODE -->
<p>turns {1, 3, 5, 7, 9, 11} to {1, 3, 5, 7}.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn351" -->
<div class="definition"><a id="defn351"></a><p class="defnprototype"><b>truncate </b>(list of values)<b> to the last </b>(number)<b> entries</b>/entry</p>
<!-- END PHRASE -->
<!-- definition of ph_truncatelast -->

<p>This phrase alters the given list so that it now consists only of the final part of the list with the given length. Example:</p>
<!-- START CODE "c8392" -->
<a id="c8392"></a><blockquote class="code"><p class="quoted">
truncate L to the last 4 entries;
</p></blockquote>
<!-- END CODE -->
<p>turns {1, 3, 5, 7, 9, 11} to {5, 7, 9, 11}.</p>

<!-- end definition -->
</div>

<p>But we don't have to truncate: we can also -</p>
<!-- START PHRASE "defn352" -->
<div class="definition"><a id="defn352"></a><p class="defnprototype"><b>extend </b>(list of values)<b> to </b>(number)<b> entries</b>/entry</p>
<!-- END PHRASE -->
<!-- definition of ph_extend -->

<p>This phrase pads out the list with default values as needed so that it now has at least the given length. (If the list is already at least that length, nothing is done.) Example:</p>
<!-- START CODE "c8393" -->
<a id="c8393"></a><blockquote class="code"><p class="quoted">
extend L to 80 entries;
</p></blockquote>
<!-- END CODE -->
<p>lengthens L to length 80 if it is currently shorter than that.</p>

<!-- end definition -->
</div>

<p>For example,</p>
<!-- START CODE "c8394" -->
<a id="c8394"></a><blockquote class="code"><p class="quoted">
To check sorting (N - a number):
<br />&#160;&#160;&#160;&#160;let L be a list of numbers;
<br />&#160;&#160;&#160;&#160;extend L to N entries;
<br />&#160;&#160;&#160;&#160;repeat with X running from 1 to N:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now entry X of L is X;
<br />&#160;&#160;&#160;&#160;say &quot;L unrandomised is [L].&quot;;
<br />&#160;&#160;&#160;&#160;sort L in random order;
<br />&#160;&#160;&#160;&#160;say &quot;L randomised is [L].&quot;;
<br />&#160;&#160;&#160;&#160;sort L;
<br />&#160;&#160;&#160;&#160;say &quot;L in ascending order is [L].&quot;
</p></blockquote>
<!-- END CODE -->
<p>builds a list of N numbers (initially all 0), fills it with the numbers 1, 2, 3, ..., N, then randomly reorders them, then sorts them back again, recovering the original order. The text produced by &quot;check sorting 10&quot; depends partly on chance but might for instance be:</p>
<!-- START CODE "c8395" -->
<a id="c8395"></a><blockquote class="code"><p class="quoted">
L unrandomised is 1, 2, 3, 4, 5, 6, 7, 8, 9 and 10.
<br />L randomised is 6, 2, 9, 3, 10, 1, 7, 4, 8 and 5.
<br />L in ascending order is 1, 2, 3, 4, 5, 6, 7, 8, 9 and 10.
</p></blockquote>
<!-- END CODE -->
<p>As with text in the previous chapter, a project which needs really long lists should use the Glulx virtual machine - &quot;check sorting 10000&quot;, for instance, would break the default memory environment on the Z-machine, which is very tight, but works fine (if not very rapidly) on Glulx.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_21.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_21.html" class="standardlink">Start of Chapter 21: Lists</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s9" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_21.html#s9" class="standardlink">Back to §21.9. Accessing entries in a list</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s11" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_21.html#s11" class="standardlink">Onward to §21.11. Variations: arrays, logs, queues, stacks, sets, sieves and rings</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#e224" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_21.html#e224" class="standardlink">Example 430: <img class="asterisk" alt="*" src="images/asterisk.png" /> <b>Leopard-skin</b>&#160;&#160;&#160; A maze that the player can escape if he performs an exact sequence of actions.</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#e135" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_21.html#e135" class="standardlink">Example 431: <img class="asterisk" alt="*" src="images/asterisk.png" /><img class="asterisk" alt="*" src="images/asterisk.png" /> <b>The Facts Were These</b>&#160;&#160;&#160; Creating a variant GIVE action that lets the player give multiple objects simultaneously with commands like GIVE ALL TO ATTENDANT or GIVE THREE DOLLARS TO ATTENDANT or GIVE PIE AND HAT TO ATTENDANT. The attendant accepts the gifts only if their total combined value matches some minimum amount.</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s11"></a>§21.11. Variations: arrays, logs, queues, stacks, sets, sieves and rings</p>
<p>Lists are highly adaptable, and many other collection-like constructions can be made using them. This section introduces no new material, but simply suggests some of the variations which are possible.</p>
<p>1. The traditional computing term <span class="boldface">array</span> means a list of values accessed by their entry numbers, often used in mathematical computations. The difference between an array and a list is mostly one of attitude, but usually arrays are fixed in length whereas lists can expand or contract.</p>
<p>2. A <span class="boldface">log</span> is a list which records the most recently arrived values, but does not allow itself to grow indefinitely. In the following, which remembers the seven most recently taken items, new values arrive at the end while old ones eventually disappear from the front:</p>
<!-- START CODE "c8396" -->
<a id="c8396"></a><blockquote class="code"><p class="quoted">
The most-recently-taken list is a list of objects that varies.
<br />Carry out taking something (called the item):
<br />&#160;&#160;&#160;&#160;truncate the most-recently-taken list to the last 6 entries;
<br />&#160;&#160;&#160;&#160;add the item to the most-recently-taken list.
<br />After taking:
<br />&#160;&#160;&#160;&#160;say &quot;Taken. (So, your recent acquisitions: [most-recently-taken list].)&quot;
</p></blockquote>
<!-- END CODE -->
<p>Note that the most-recently-taken list begins play as the empty list, grows as the first few items are taken, but then stabilises at length 7 thereafter. If we need to remember recent history, but only <span class="italic">recent</span> history, then a log is better than a list which can grow indefinitely, because there is no risk of speed reduction or memory exhaustion in a very long story.</p>
<p>3. A <span class="boldface">queue</span> is a list of values which are waiting for attention. New values join at the back, while those being dealt with are removed from the front (whereupon the whole queue moves up one). An empty queue means that nobody is waiting for attention: but there is, in principle, no upper limit to the size of a queue, as anyone who has tried to make a couchette reservation at Roma Termini will know.</p>
<p>Queues typically form when two independent processes are at work, but going at different or variable speeds. An empty queue looks just like any other list:</p>
<!-- START CODE "c8397" -->
<a id="c8397"></a><blockquote class="code"><p class="quoted">
The queue is a list of objects that varies.
</p></blockquote>
<!-- END CODE -->
<p>(Invariably people, in what follows, but we'll make it a &quot;list of objects&quot; to allow for other possibilities too.) Once we identify a &quot;new customer&quot;, we can join him to the queue thus:</p>
<!-- START CODE "c8398" -->
<a id="c8398"></a><blockquote class="code"><p class="quoted">
add the new customer to the queue;
</p></blockquote>
<!-- END CODE -->
<p>The process of serving the customers needs to make sure there is actually somebody waiting in the queue before it does anything:</p>
<!-- START CODE "c8399" -->
<a id="c8399"></a><blockquote class="code"><p class="quoted">
Every turn when the number of entries in the queue is not 0:
<br />&#160;&#160;&#160;&#160;let the next customer be entry 1 of the queue;
<br />&#160;&#160;&#160;&#160;say &quot;[The next customer] is served and leaves.&quot;;
<br />&#160;&#160;&#160;&#160;remove entry 1 from the queue.
</p></blockquote>
<!-- END CODE -->
<p>Of course queues can also be constructed which empty from other positions, rather than the front: or we could make what computer scientists sometimes call a <span class="boldface">deque</span>, a &quot;double-ended queue&quot; where new values arrive at both ends.</p>
<p>4. A <span class="boldface">stack</span> is like a queue except that values arrive at, and are removed from, the same end. Stacks are slightly faster if the active end is the back rather than the front, though this will only be noticeable if they grow quite large.</p>
<p>To put a value V onto a stack S (which is known as &quot;pushing&quot;) is simple:</p>
<!-- START CODE "c8400" -->
<a id="c8400"></a><blockquote class="code"><p class="quoted">
add V to S;
</p></blockquote>
<!-- END CODE -->
<p>And to remove a value from the top of the stack (which is known as &quot;pulling&quot;):</p>
<!-- START CODE "c8401" -->
<a id="c8401"></a><blockquote class="code"><p class="quoted">
let N be the number of entries in S;
<br />let V be entry N of S;
<br />remove entry N from S;
</p></blockquote>
<!-- END CODE -->
<p>Note that the middle line, accessing entry N, will fail if N = 0, that is, if the stack is empty: Inform's list routines will produce a run-time problem message.</p>
<p>Stacks are useful if some long-term process is constantly being interrupted by newer and more urgent demands, but they can also be used in planning. If a character has a long-term goal, which needs various short-term goals to be achieved along the way, then a stack can represent the goals currently being pursued. The top of the stack represents what the character is trying to achieve now. If the character realises that it needs to achieve something else first, we put that new goal onto the top of the stack, and it becomes the new current goal. When the character completes a task, it can be removed, and we can go back to trying to finish whatever is now on top. When the stack is empty, the character has achieved the original goal.</p>
<p>5. Notoriously, <span class="boldface">set</span> has 464 distinct meanings in the Oxford English Dictionary, making it the single most ambiguous word in the language. Here we mean not the home of a badger or the Egyptian god of the desert, but the mathematical sense: a collection of values (sometimes called &quot;elements&quot;) without duplicates, and which is normally written in brace notation and in some natural order for the reader's convenience.</p>
<p>The trick here is to maintain the principle that, at all times, our list is sorted in order and contains no duplicates. To provide an example, we start with two sets of numbers:</p>
<!-- START CODE "c8402" -->
<a id="c8402"></a><blockquote class="code"><p class="quoted">
let S be {2, 4, 8, 16, 32, 64};
<br />let T be {2, 4, 6, 10};
</p></blockquote>
<!-- END CODE -->
<p>Here we add an element to T:</p>
<!-- START CODE "c8403" -->
<a id="c8403"></a><blockquote class="code"><p class="quoted">
add 8 to T, if absent; sort T;
</p></blockquote>
<!-- END CODE -->
<p>The &quot;if absent&quot; clause ensures that no duplicate can occur, and by sorting T afterwards, we maintain the principle that a set must remain in order - so T is now {2, 4, 6, 8, 10}, not {2, 4, 6, 10, 8}. (Inform's sorting algorithm is fast on nearly-sorted lists, so frequent sorting is not as inefficient as it might look.)</p>
<p>We next take the union of T and S, that is, the set containing everything which is in either or both:</p>
<!-- START CODE "c8404" -->
<a id="c8404"></a><blockquote class="code"><p class="quoted">
let U be S; add T to U, if absent; sort U;
</p></blockquote>
<!-- END CODE -->
<p>This makes U = {2, 4, 6, 8, 10, 16, 32, 64}, and once again no duplicates occur and we preserve the sorting. The intersection of T and S, the set of elements in both of them, is a little trickier:</p>
<!-- START CODE "c8405" -->
<a id="c8405"></a><blockquote class="code"><p class="quoted">
let I be T;
<br />repeat with the element running through T:
<br />&#160;&#160;&#160;&#160;if the element is not listed in S, remove the element from I.
</p></blockquote>
<!-- END CODE -->
<p>(Faster methods could be devised which exploit the sortedness of T and S, but are not worth it for shortish lists.) This produces I = {2, 4, 8}. Lastly, we can form the set difference, consisting of those elements which are in S but not in T:</p>
<!-- START CODE "c8406" -->
<a id="c8406"></a><blockquote class="code"><p class="quoted">
let D be S; remove T from D, if present;
</p></blockquote>
<!-- END CODE -->
<p>Here, as with intersection, since all we do is to strike out unwanted elements, the surviving ones remain in order and there is no need to sort when we are finished. This produces D = {16, 32, 64}.</p>
<p>6. A <span class="boldface">sieve</span> is used to make a complicated choice where there are many constraints, by ruling out impossible cases to see what is left. The term derives from the kitchen utensil (for sieving fine grains of flour), but via the name of the &quot;sieve of Eratosthenes&quot;, an ancient Greek method for determining the prime numbers.</p>
<p>Using a sieve is much like using a set, and the difference is mainly one of outlook - we are interested in what does not belong, rather than what does.</p>
<p>7. A <span class="boldface">ring</span> is not so much a row of values, more a circle, with the last and first entries thought of as adjacent. One position is usually thought of as special, and is the place where new items are added: this may as well be entry 1. For instance, to add &quot;new item&quot; to the ring:</p>
<!-- START CODE "c8407" -->
<a id="c8407"></a><blockquote class="code"><p class="quoted">
add the item at entry 1 in the ring;
</p></blockquote>
<!-- END CODE -->
<p>To set &quot;item&quot; to the frontmost value and extract it from the ring:</p>
<!-- START CODE "c8408" -->
<a id="c8408"></a><blockquote class="code"><p class="quoted">
let the item be entry 1 of the ring;
<br />remove entry 1 from the ring;
</p></blockquote>
<!-- END CODE -->
<p>And we can rotate the ring in either direction, making a different entry the new entry 1 and therefore the new frontmost value:</p>
<!-- START CODE "c8409" -->
<a id="c8409"></a><blockquote class="code"><p class="quoted">
rotate the ring;
<br />rotate the ring backwards;
</p></blockquote>
<!-- END CODE -->
<p>A last note to conclude the chapter on lists. Lists, like almost all other values in Inform, can be passed to phrases as parameters. However, note that they are genuine values, not what some programming languages call &quot;references&quot; or &quot;pointers&quot;. So the following:</p>
<!-- START CODE "c8410" -->
<a id="c8410"></a><blockquote class="code"><p class="quoted">
To mess with (L - a list of numbers):
<br />&#160;&#160;&#160;&#160;add 7 to L, if absent.
</p></blockquote>
<!-- END CODE -->
<p>does nothing, in practice. If given a list, it adds 7 to the list, but then throws it away again, so the longer list is never seen; it's exactly like</p>
<!-- START CODE "c8411" -->
<a id="c8411"></a><blockquote class="code"><p class="quoted">
To mess with (N - a number):
<br />&#160;&#160;&#160;&#160;now N is 3.
</p></blockquote>
<!-- END CODE -->
<p>which can never affect anything other than its own temporary value &quot;N&quot;, which expires almost immediately in any case.</p>
<p>If we want a phrase which changes a list in a useful way and gives it back to us, we need a phrase which both takes in and gives back:</p>
<!-- START CODE "c8412" -->
<a id="c8412"></a><blockquote class="code"><p class="quoted">
To decide which list of numbers is the extended (L - a list of numbers):
<br />&#160;&#160;&#160;&#160;add 7 to L, if absent;
<br />&#160;&#160;&#160;&#160;decide on L.
</p></blockquote>
<!-- END CODE -->
<p>And then, for example -</p>
<!-- START CODE "c8413" -->
<a id="c8413"></a><blockquote class="code"><p class="quoted">
the extended { 2, 4, 6 };
</p></blockquote>
<!-- END CODE -->
<p>produces:</p>
<!-- START CODE "c8414" -->
<a id="c8414"></a><blockquote class="code"><p class="quoted">
{ 2, 4, 6, 7 }
</p></blockquote>
<!-- END CODE -->
<p>(This may seem surprising since Inform's built-in phrases to adjust lists, like &quot;add ... to ...&quot;, don't work this way. But those are written using Inform 6 code; see the phrase definitions in the Standard Rules for more.)</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_21.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_21.html" class="standardlink">Start of Chapter 21: Lists</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s10" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_21.html#s10" class="standardlink">Back to §21.10. Lengthening or shortening a list</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s1" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_22.html#s1" class="standardlink">Onward to Chapter 22: Advanced Phrases: §22.1. A review of kinds</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#e81" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_21.html#e81" class="standardlink">Example 432: <img class="asterisk" alt="*" src="images/asterisk.png" /> <b>Circle of Misery</b>&#160;&#160;&#160; Retrieving items from an airport luggage carousel is such fun, how can we resist simulating it, using a list as a ring buffer?</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#e133" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_21.html#e133" class="standardlink">Example 433: <img class="asterisk" alt="*" src="images/asterisk.png" /> <b>Eyes, Fingers, Toes</b>&#160;&#160;&#160; A safe with a multi-number combination, meant to be dialed over multiple turns, is implemented using a log of the last three numbers dialed. The log can then be compared to the safe's correct combination.</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#e140" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_21.html#e140" class="standardlink">Example 434: <img class="asterisk" alt="*" src="images/asterisk.png" /> <b>The Fibonacci Sequence</b>&#160;&#160;&#160; The modest Leonardo Fibonacci of Pisa will be only too happy to construct his sequence on request, using an array.</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#e177" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_21.html#e177" class="standardlink">Example 435: <img class="asterisk" alt="*" src="images/asterisk.png" /> <b>I Didn't Come All The Way From Great Portland Street</b>&#160;&#160;&#160; In this fiendishly difficult puzzle, which may perhaps owe some inspiration to a certain BBC Radio panel game (1967-), a list is used as a set of actions to help enforce the rule that the player must keep going for ten turns without hesitation, repetition, or deviating from the subject on the card.</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#e233" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_21.html#e233" class="standardlink">Example 436: <img class="asterisk" alt="*" src="images/asterisk.png" /> <b>Lugubrious Pete's Delicatessen</b>&#160;&#160;&#160; In this evocation of supermarket deli counter life, a list is used as a queue to keep track of who is waiting to be served.</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#e346" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_21.html#e346" class="standardlink">Example 437: <img class="asterisk" alt="*" src="images/asterisk.png" /> <b>Sieve of Eratosthenes</b>&#160;&#160;&#160; The haughty Eratosthenes of Cyrene will nevertheless consent to sieve prime numbers on request.</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#e449" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_21.html#e449" class="standardlink">Example 438: <img class="asterisk" alt="*" src="images/asterisk.png" /> <b>Your Mother Doesn't Work Here</b>&#160;&#160;&#160; Your hard-working mother uses a list as a stack: urgent tasks are added to the end of the list, interrupting longer-term plans.</a></td></tr>
</table><hr />
</div>
<div class="bookexamples">
<p class="chapterheading">Examples from Chapter 21: Lists</p><table class="centredtable"><tr><td class="roadsigndirection"><a href="WI_21.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_21.html" class="standardlink">Start of this chapter</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_22.html" class="standardlink">Chapter 22: Advanced Phrases</a></td></tr>
<tr><td class="roadsigndirection"><a href="examples_alphabetical.html" class="standardlink"><img alt="arrow-down-right.png" src="images/arrow-down-right.png" /></a></td><td><a href="examples_alphabetical.html" class="standardlink">Indexes of the examples</a></td></tr>
</table><!-- START EXAMPLE "425: Oyster Wide Shut" "e279" -->
<a id="e279"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_21.html#e279" class="eglink"><b>425</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_21.html#e279" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Oyster Wide Shut</span></b></a><br />Replacing Inform's default printing of properties such as "(closed)", "(open and providing light)", etc., with our own, more flexible variation.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_6.html#e279"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example279">
<p>As we've seen in earlier examples such as &quot;Equipment List&quot;, it is possible to vary the way Inform creates inventory listings in general (to create lists that look more like paragraphs of prose, lists divided between what the player is wearing and what he isn't, and so on). We can also use activities to alter the printing of specific objects' names and contents, as with the &quot;omit contents in listing&quot; feature after printing the name of something.</p>
<p>We may find, however, that we would like a great deal more control over Inform's printing of inventory details, not just as a special effect for a few items, but throughout the game.</p>
<p>We start by turning off Inform's native property writer:</p>
<!-- START CODE "c8415_279" -->
<a id="c8415_279"></a><blockquote class="code"><p class="quoted">
 &quot;Oyster Wide Shut&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8416_279" -->
<a id="c8416_279"></a><blockquote class="code"><p class="quoted">
Section 1 - Procedure
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8417_279" -->
<a id="c8417_279"></a><blockquote class="code"><p class="quoted">
The print standard inventory rule is not listed in any rulebook.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8418_279" -->
<a id="c8418_279"></a><blockquote class="code"><p class="quoted">
Carry out taking inventory (this is the new print inventory rule):
<br />&#160;&#160;&#160;&#160;say &quot;You are carrying: [line break]&quot;;
<br />&#160;&#160;&#160;&#160;list the contents of the player, with newlines, indented, including contents, with extra indentation.
</p></blockquote>
<!-- END CODE -->
<p>This is very much like the library's standard behavior, but with the exception that &quot;giving inventory information&quot; or even &quot;giving brief inventory information&quot; are omitted. Here's how we supplant it:</p>
<!-- START CODE "c8419_279" -->
<a id="c8419_279"></a><blockquote class="code"><p class="quoted">
After printing the name of something (called target) while taking inventory:
<br />&#160;&#160;&#160;&#160;follow the property-aggregation rules for the target.
</p></blockquote>
<!-- END CODE -->
<p>Now, our property-aggregation rulebook is going to look at a given object and decide on a list of features that should be mentioned in inventory. We'll start by producing something quite similar to Inform's default behavior:</p>
<!-- START CODE "c8420_279" -->
<a id="c8420_279"></a><blockquote class="code"><p class="quoted">
The property-aggregation rules are an object-based rulebook.
<br />The property-aggregation rulebook has a list of text called the tagline.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8421_279" -->
<a id="c8421_279"></a><blockquote class="code"><p class="quoted">
A first property-aggregation rule for an openable open thing (this is the mention open openables rule):
<br />&#160;&#160;&#160;&#160;add &quot;open&quot; to the tagline.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8422_279" -->
<a id="c8422_279"></a><blockquote class="code"><p class="quoted">
A first property-aggregation rule for an openable closed thing (this is the mention closed openables rule):
<br />&#160;&#160;&#160;&#160;add &quot;closed&quot; to the tagline.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8423_279" -->
<a id="c8423_279"></a><blockquote class="code"><p class="quoted">
A property-aggregation rule for a closed transparent container which contains nothing (this is the mention empty transparent containers rule):
<br />&#160;&#160;&#160;&#160;add &quot;empty&quot; to the tagline.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8424_279" -->
<a id="c8424_279"></a><blockquote class="code"><p class="quoted">
A property-aggregation rule for an open container which contains nothing (this is the mention empty open containers rule):
<br />&#160;&#160;&#160;&#160;add &quot;empty&quot; to the tagline.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8425_279" -->
<a id="c8425_279"></a><blockquote class="code"><p class="quoted">
A property-aggregation rule for a lit thing (this is the mention lit objects rule):
<br />&#160;&#160;&#160;&#160;add &quot;providing light&quot; to the tagline.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8426_279" -->
<a id="c8426_279"></a><blockquote class="code"><p class="quoted">
A property-aggregation rule for a thing worn by the player (this is the mention worn objects rule):
<br />&#160;&#160;&#160;&#160;add &quot;being worn&quot; to the tagline.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8427_279" -->
<a id="c8427_279"></a><blockquote class="code"><p class="quoted">
The last property-aggregation rule (this is the print aggregated properties rule):
<br />&#160;&#160;&#160;&#160;if the number of entries in the tagline is greater than 0:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot; ([tagline])&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;rule succeeds;
<br />&#160;&#160;&#160;&#160;rule fails.
</p></blockquote>
<!-- END CODE -->
<p>Notice that we don't need to write any rules about how to print that list of text: because Inform is printing out a list, it will automatically insert commas, spaces, and the word &quot;and&quot; where appropriate; and it will automatically follow the &quot;use serial comma&quot; option, if we have it set.</p>
<p>Now we're free to meddle. Let's give the player a bunch of possessions that will be listed in interesting ways in inventory:</p>
<!-- START CODE "c8428_279" -->
<a id="c8428_279"></a><blockquote class="code"><p class="quoted">
Section 2 - Scenario
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8429_279" -->
<a id="c8429_279"></a><blockquote class="code"><p class="quoted">
The Curved Beach is a room. &quot;White sand stretches away both northeast and northwest, enclosing this attractive little bay. Gentle waves lap at the beach.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8430_279" -->
<a id="c8430_279"></a><blockquote class="code"><p class="quoted">
The player carries a glowing plastic sack. The glowing plastic sack is lit and transparent and openable and open. It contains a rock. It is wearable.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8431_279" -->
<a id="c8431_279"></a><blockquote class="code"><p class="quoted">
The player wears a flashlight lanyard. The flashlight lanyard is a device.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8432_279" -->
<a id="c8432_279"></a><blockquote class="code"><p class="quoted">
Carry out switching on the lanyard: now the noun is lit.
<br />Carry out switching off the lanyard: now the noun is unlit.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8433_279" -->
<a id="c8433_279"></a><blockquote class="code"><p class="quoted">
The player carries an oyster. The oyster contains a pearl. The oyster is openable.
</p></blockquote>
<!-- END CODE -->
<p>Now suppose that we don't want the oyster to say &quot;closed&quot; when it's closed. Instead, we'd like it to say &quot;clamped shut&quot;. As this is the only property the oyster will ever have, we can simply override his whole property-aggregation rulebook:</p>
<!-- START CODE "c8434_279" -->
<a id="c8434_279"></a><blockquote class="code"><p class="quoted">
A property-aggregation rule for the oyster:
<br />&#160;&#160;&#160;&#160;if the oyster is closed:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot; (clamped shut)&quot;;
<br />&#160;&#160;&#160;&#160;rule succeeds.
</p></blockquote>
<!-- END CODE -->
<p>That's fine for the oyster because &quot;clamped shut&quot; is the only property he'll ever have. What if we'd like instead just to revise the way the sack (and only the sack) gets described as providing light?</p>
<!-- START CODE "c8435_279" -->
<a id="c8435_279"></a><blockquote class="code"><p class="quoted">
The sacklight rule is listed after the mention lit objects rule in the property-aggregation rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8436_279" -->
<a id="c8436_279"></a><blockquote class="code"><p class="quoted">
A property-aggregation rule for the plastic sack (this is the sacklight rule):
<br />&#160;&#160;&#160;&#160;if &quot;providing light&quot; is listed in the tagline:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;remove &quot;providing light&quot; from the tagline;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;add &quot;gently glowing&quot; to the tagline.
</p></blockquote>
<!-- END CODE -->
<p>Now the flashlight (and any other regular light sources we might add to the game) will be described as &quot;providing light&quot;, but the sack will only be said to be gently glowing -- a bit more appropriate for its rather fainter gleam.</p>
<p>We might also wish to add a systematic feature across the board to include a new property in the inventory list? Let's say the player can enchant his possessions, and enchanted possessions should thereafter be listed accordingly:</p>
<!-- START CODE "c8437_279" -->
<a id="c8437_279"></a><blockquote class="code"><p class="quoted">
A thing can be magical or non-magical. A thing is usually non-magical.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8438_279" -->
<a id="c8438_279"></a><blockquote class="code"><p class="quoted">
Understand &quot;enchant [something]&quot; as enchanting. Enchanting is an action applying to one thing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8439_279" -->
<a id="c8439_279"></a><blockquote class="code"><p class="quoted">
Carry out enchanting something:
<br />&#160;&#160;&#160;&#160;now the noun is magical.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8440_279" -->
<a id="c8440_279"></a><blockquote class="code"><p class="quoted">
Report enchanting something:
<br />&#160;&#160;&#160;&#160;say &quot;Ding! You turn [the noun] magical.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8441_279" -->
<a id="c8441_279"></a><blockquote class="code"><p class="quoted">
A property-aggregation rule for a magical thing:
<br />&#160;&#160;&#160;&#160;add &quot;enchanted&quot; to the tagline.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8442_279" -->
<a id="c8442_279"></a><blockquote class="code"><p class="quoted">
Test me with &quot;i / close oyster / i  / turn on flashlight / i / take off flashlight / i / turn off flashlight / i / close sack / i / open sack / i / take all from sack / i / close sack / i  / wear sack / i / enchant sack / i / open sack / put all in sack / i / close sack / i&quot;.
</p></blockquote>
<!-- END CODE -->
<p>Further variations are possible as well: if we used a &quot;before printing the name...&quot; rather than an &quot;after printing the name...&quot; rule, we could automatically generate lines like &quot;an open and empty phosphorescent plastic sack&quot;, removing some of the artificiality of the parentheses.</p>
<p>Or we could add more logic to the rules about which properties are mentioned, so that some features of objects were mentioned in inventory only if the player was wearing the correct detection device, like so:</p>
<!-- START CODE "c8443_279" -->
<a id="c8443_279"></a><blockquote class="code"><p class="quoted">
The player wears enchantment-detecting goggles.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8444_279" -->
<a id="c8444_279"></a><blockquote class="code"><p class="quoted">
A property-aggregation rule for a magical thing:
<br />&#160;&#160;&#160;&#160;if the player is wearing the goggles:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;add &quot;enchanted&quot; to the tagline.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "426: Robo 1" "e326" -->
<a id="e326"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_21.html#e326" class="eglink"><b>426</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_21.html#e326" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Robo 1</span></b></a><br />A robot which watches and records the player's actions, then tries to repeat them back in the same order when he is switched into play-back mode.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_7.html#e326"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example326">
<!-- START CODE "c8445_326" -->
<a id="c8445_326"></a><blockquote class="code"><p class="quoted">
&quot;Robo&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8446_326" -->
<a id="c8446_326"></a><blockquote class="code"><p class="quoted">
The Experimentation Chamber is a room. Robo is a man in the Experimentation Chamber. &quot;Robo, your prototype tin companion, stands awkwardly beside you. In the middle of his chest is a red enamel button[if the red button is switched on], currently depressed[otherwise], currently un-depressed[end if].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8447_326" -->
<a id="c8447_326"></a><blockquote class="code"><p class="quoted">
The red button is a device. It is part of Robo. Instead of pushing the red button: if the red button is switched off, try switching on the red button; otherwise try switching off the red button.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8448_326" -->
<a id="c8448_326"></a><blockquote class="code"><p class="quoted">
After switching on the red button:
<br />&#160;&#160;&#160;&#160;say &quot;CLICK! Robo is now in play-back mode.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8449_326" -->
<a id="c8449_326"></a><blockquote class="code"><p class="quoted">
After switching off the red button:
<br />&#160;&#160;&#160;&#160;say &quot;CLACK! Robo is now in observation mode.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8450_326" -->
<a id="c8450_326"></a><blockquote class="code"><p class="quoted">
Definition: Robo is watching if the red button is switched off.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8451_326" -->
<a id="c8451_326"></a><blockquote class="code"><p class="quoted">
The current instruction set is a list of stored actions that varies.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8452_326" -->
<a id="c8452_326"></a><blockquote class="code"><p class="quoted">
After doing something when Robo is watching and Robo can see the player:
<br />&#160;&#160;&#160;&#160;now the actor is Robo;
<br />&#160;&#160;&#160;&#160;add the current action to the current instruction set;
<br />&#160;&#160;&#160;&#160;now the actor is the player;
<br />&#160;&#160;&#160;&#160;say &quot;Robo watches you [the current action][one of], his yellow eyes lamp-like and observant[or]. In his metal head, gears whirr[or], his brushed-copper handlebar moustaches twitching[or] impassively[at random].&quot;;
<br />&#160;&#160;&#160;&#160;continue the action.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8453_326" -->
<a id="c8453_326"></a><blockquote class="code"><p class="quoted">
Every turn when Robo is not watching:
<br />&#160;&#160;&#160;&#160;if the number of entries in the current instruction set is 0:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;Robo has run out of behavior and grinds to an (expectant) halt.&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the red button is switched off;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let the next task be entry 1 of the current instruction set;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;try the next task;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;remove entry 1 from the current instruction set.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8454_326" -->
<a id="c8454_326"></a><blockquote class="code"><p class="quoted">
The red block and the blue cylinder are things in the Experimentation Chamber. The counter is a supporter in the Experimentation Chamber. The counter is scenery.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8455_326" -->
<a id="c8455_326"></a><blockquote class="code"><p class="quoted">
Report Robo examining Robo:
<br />&#160;&#160;&#160;&#160;say &quot;Robo examines each of his hands in turn, then each of his legs (bending over mostly double in the middle to do this).&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8456_326" -->
<a id="c8456_326"></a><blockquote class="code"><p class="quoted">
Report Robo examining the player:
<br />&#160;&#160;&#160;&#160;say &quot;Robo stares at you, unblinkingly, for several seconds together[if a random chance of 1 in 7 succeeds]. His left moustache-bar twitches infinitesimally upward[end if].&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8457_326" -->
<a id="c8457_326"></a><blockquote class="code"><p class="quoted">
Report Robo taking the cylinder:
<br />&#160;&#160;&#160;&#160;say &quot;[one of][Robo] needs several attempts to get his metal fingers around [the cylinder] -- they are not designed for grasping small objects elegantly. But at last he succeeds[or]Once again, Robo struggles a bit before picking up [the cylinder][stopping].&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8458_326" -->
<a id="c8458_326"></a><blockquote class="code"><p class="quoted">
Test me with &quot;z / take cylinder / take block / put cylinder on counter / put block on counter / x robo / x me / get block / drop block / press red button / z / z / z / z / z / z / z / z / z / z&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "427: What Makes You Tick" "e434" -->
<a id="e434"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_21.html#e434" class="eglink"><b>427</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_21.html#e434" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">What Makes You Tick</span></b></a><br />Building a fishing pole from several component parts that the player might put together in any order.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_9.html#e434"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example434">
<p>Suppose we want to let the player build a fishing pole out of three parts: a hook, a string, and a stick.</p>
<p>There are several things we must account for here. One is that our combination verb should be insensitive to ordering: it shouldn't matter whether the player types COMBINE STICK WITH STRING or COMBINE STRING WITH STICK.</p>
<p>Second, we need to make sure that our implementation handles intervening stages of assembly gracefully. The player should be able to combine string and hook first, or string and stick first, and be able to complete the assembly in either case.</p>
<p>Our implementation here uses a table of lists to determine which combinations of inputs should produce which result object. Because we sort our lists before comparing them, we guarantee that the player's ordering doesn't matter: COMBINE STICK WITH STRING will have the same effect as COMBINE STRING WITH STICK.</p>
<p>What's more, our implementation could be expanded to account for many other assemblages, if we wanted object-building to be a running theme of puzzles in our game.</p>
<!-- START CODE "c8459_434" -->
<a id="c8459_434"></a><blockquote class="code"><p class="quoted">
 &quot;What Makes You Tick&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8460_434" -->
<a id="c8460_434"></a><blockquote class="code"><p class="quoted">
Understand &quot;combine [something] with [something]&quot; as combining it with. Combining it with is an action applying to two carried things. Understand the command &quot;connect&quot; as &quot;combine&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8461_434" -->
<a id="c8461_434"></a><blockquote class="code"><p class="quoted">
Understand the command &quot;attach&quot; as something new. Understand &quot;attach [something] to [something]&quot; as combining it with.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8462_434" -->
<a id="c8462_434"></a><blockquote class="code"><p class="quoted">
The combining it with action has an object called the item built.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8463_434" -->
<a id="c8463_434"></a><blockquote class="code"><p class="quoted">
Setting action variables for combining something with something:
<br />&#160;&#160;&#160;&#160;let X be a list of objects;
<br />&#160;&#160;&#160;&#160;add the noun to X;
<br />&#160;&#160;&#160;&#160;add the second noun to X;
<br />&#160;&#160;&#160;&#160;sort X;
<br />&#160;&#160;&#160;&#160;repeat through the Table of Outcome Objects:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let Y be the component list entry;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sort Y;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if X is Y:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the item built is the result entry.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8464_434" -->
<a id="c8464_434"></a><blockquote class="code"><p class="quoted">
Check combining it with:
<br />&#160;&#160;&#160;&#160;if the item built is nothing or the item built is not in limbo,
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You can't combine [the noun] and [the second noun] into anything useful.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8465_434" -->
<a id="c8465_434"></a><blockquote class="code"><p class="quoted">
Carry out combining it with:
<br />&#160;&#160;&#160;&#160;move the item built to the holder of the noun;
<br />&#160;&#160;&#160;&#160;now the noun is nowhere;
<br />&#160;&#160;&#160;&#160;now the second noun is nowhere.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8466_434" -->
<a id="c8466_434"></a><blockquote class="code"><p class="quoted">
Report combining it with:
<br />&#160;&#160;&#160;&#160;say &quot;You now have [an item built].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8467_434" -->
<a id="c8467_434"></a><blockquote class="code"><p class="quoted">
Limbo is a container. Limbo contains a hookless fishing pole, a hooked line, and a complete fishing pole.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8468_434" -->
<a id="c8468_434"></a><blockquote class="code"><p class="quoted">
Streamside is a room. The player carries a stick, a wire hook, and a string.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8469_434" -->
<a id="c8469_434"></a><blockquote class="code"><p class="quoted">
Table of Outcome Objects
<br /></p></blockquote><table class="codetable">
<tr><td class="quotedtablecell"><p class="quoted">component list</p></td><td class="quotedtablecell"><p class="quoted">result</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">{stick, string}</p></td><td class="quotedtablecell"><p class="quoted">hookless fishing pole</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">{wire hook, string}</p></td><td class="quotedtablecell"><p class="quoted">hooked line</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">{hooked line, stick}</p></td><td class="quotedtablecell"><p class="quoted">complete fishing pole</p></td></tr>
<tr><td class="quotedtablecell"><p class="quoted">{hookless fishing pole, wire hook}</p></td><td class="quotedtablecell"><p class="quoted">complete fishing pole</p></td></tr>
</table><blockquote><p>
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8470_434" -->
<a id="c8470_434"></a><blockquote class="code"><p class="quoted">
Test me with &quot;combine stick with string / i / combine pole with hook / i&quot;.
</p></blockquote>
<!-- END CODE -->
<p>This kind of implementation makes sense if we don't intend the player to take the fishing pole apart again, or to refer to any of its component parts once it is built. For an alternate approach that does allow assembled objects to be taken apart again, see &quot;Some Assembly Required&quot;.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "428: Formicidae" "e156" -->
<a id="e156"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_21.html#e156" class="eglink"><b>428</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_21.html#e156" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Formicidae</span></b></a><br />Manipulating the order in which items are handled after TAKE ALL.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_6.html#e156"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example156">
<p>Suppose we have an item that produces an interesting result the first time the player lifts it -- a rock with dangerous ants revealed underneath. The effect of the surprise is a little weakened, though, if the player sees that response as the result of a TAKE ALL, when it might be printed like this:</p>
<!-- START CODE "c8471_156" -->
<a id="c8471_156"></a><blockquote class="code"><p class="quoted">
&gt;[3] get all
<br />tent peg: Taken.
<br />water flask: Taken.
<br />trading permit: Taken.
<br />innocent-looking rock: You reach for the rock and turn it over to reveal a thriving colony of flesh-eating ants. Needless to say, you drop the rock and jump back with a decidedly effeminate scream. They can probably hear you all the way back in the base camp.
<br />rusty nail: Taken.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8472_156" -->
<a id="c8472_156"></a><blockquote class="code"><p class="quoted">
[Your score has just gone down by two points.]
</p></blockquote>
<!-- END CODE -->
<p>The calm response to &quot;rusty nail&quot; looks odd now, and the score change is disconnected from the event that caused it.</p>
<p>To manage this, we might institute a system so that interesting objects are handled last in their list, like so:</p>
<!-- START CODE "c8473_156" -->
<a id="c8473_156"></a><blockquote class="code"><p class="quoted">
&quot;Formicidae&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8474_156" -->
<a id="c8474_156"></a><blockquote class="code"><p class="quoted">
Use scoring.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8475_156" -->
<a id="c8475_156"></a><blockquote class="code"><p class="quoted">
Section 1 - Procedure
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8476_156" -->
<a id="c8476_156"></a><blockquote class="code"><p class="quoted">
The magic rule is listed before the generate action rule in the turn sequence rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8477_156" -->
<a id="c8477_156"></a><blockquote class="code"><p class="quoted">
A thing has a number called dramatic potential.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8478_156" -->
<a id="c8478_156"></a><blockquote class="code"><p class="quoted">
This is the magic rule:
<br />&#160;&#160;&#160;&#160;let L be the multiple object list;
<br />&#160;&#160;&#160;&#160;if the number of entries in L is greater than 1:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sort L in dramatic potential order;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;alter the multiple object list to L.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8479_156" -->
<a id="c8479_156"></a><blockquote class="code"><p class="quoted">
Section 2 - Scenario
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8480_156" -->
<a id="c8480_156"></a><blockquote class="code"><p class="quoted">
The Foothills is a room. &quot;The land has become hilly; though the soil is still mostly coarse yellow sand, clumps of grass are able to grow in the shadier places. Deep wagon ruts running from the southwest towards the mountains in the northeast show where generations of caravans have already passed.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8481_156" -->
<a id="c8481_156"></a><blockquote class="code"><p class="quoted">
The water flask, the tent peg, and the trading permit are things in Foothills.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8482_156" -->
<a id="c8482_156"></a><blockquote class="code"><p class="quoted">
The rock is a thing in Foothills. Before printing the name of the rock when the rock is not handled: say &quot;innocent-looking &quot;. The dramatic potential of the rock is 10.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8483_156" -->
<a id="c8483_156"></a><blockquote class="code"><p class="quoted">
The rusty nail is a thing in Foothills.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8484_156" -->
<a id="c8484_156"></a><blockquote class="code"><p class="quoted">
The ant colony is a fixed in place thing. &quot;A busy group of ants are crawling to and fro in the unaccustomed sun.&quot; Rule for deciding whether all includes the ant colony while taking: it does not.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8485_156" -->
<a id="c8485_156"></a><blockquote class="code"><p class="quoted">
Instead of taking the rock when the rock is handled:
<br />&#160;&#160;&#160;&#160;say &quot;It might still have a stray ant or two on it.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8486_156" -->
<a id="c8486_156"></a><blockquote class="code"><p class="quoted">
After taking the rock:
<br />&#160;&#160;&#160;&#160;now the rock is handled;
<br />&#160;&#160;&#160;&#160;move ant colony to the location;
<br />&#160;&#160;&#160;&#160;move the rock to the location;
<br />&#160;&#160;&#160;&#160;say &quot;You reach for the rock and turn it over to reveal a thriving colony of flesh-eating ants. Needless to say, you drop the rock and jump back with a decidedly effeminate scream. They can probably hear you all the way back in the base camp.&quot;;
<br />&#160;&#160;&#160;&#160;decrease score by 2.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8487_156" -->
<a id="c8487_156"></a><blockquote class="code"><p class="quoted">
Test me with &quot;get peg / drop peg / get all / get rock&quot;.
</p></blockquote>
<!-- END CODE -->
<p>Note that while one could also manipulate the object list to add or remove items at this stage, there's a simpler way to control what Inform considers &quot;ALL&quot; to mean in commands: see the activity &quot;Deciding whether all includes&quot; in the activities chapter.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "429: Robo 2" "e327" -->
<a id="e327"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_21.html#e327" class="eglink"><b>429</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_21.html#e327" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><img class="asterisk" alt="*" src="images/asterisk.png" /><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Robo 2</span></b></a><br />A robot which watches and records the player's actions, then tries to repeat them back in the same order when he is switched into play-back mode.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_7.html#e327"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example327">
<p>We have seen how we can make a robot that watches the player, then plays back the same actions again. A slightly more adventurous implementation would be to let the player create a whole series of named scripts which the robot will run on command.</p>
<p>To do this, we'll need each program to have a command that sets it off (stored as text, since this is the best way to capture and preserve arbitrary text entered by the player) and then the script of actions that must result:</p>
<!-- START CODE "c8488_327" -->
<a id="c8488_327"></a><blockquote class="code"><p class="quoted">
&quot;Robo 2&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8489_327" -->
<a id="c8489_327"></a><blockquote class="code"><p class="quoted">
Use dynamic memory allocation of at least 16384.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8490_327" -->
<a id="c8490_327"></a><blockquote class="code"><p class="quoted">
Chapter 1 - Programming
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8491_327" -->
<a id="c8491_327"></a><blockquote class="code"><p class="quoted">
Section 1 - The Programs Themselves
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8492_327" -->
<a id="c8492_327"></a><blockquote class="code"><p class="quoted">
The hard drive is a container. A program is a kind of thing. 15 programs are in hard drive. A program has some text called the starter command. A program has a list of stored actions called the script. Understand the starter command property as describing a program.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8493_327" -->
<a id="c8493_327"></a><blockquote class="code"><p class="quoted">
Rule for printing the name of a program (called the target) which is not blank:
<br />&#160;&#160;&#160;&#160;say &quot;[starter command of the target in upper case]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8494_327" -->
<a id="c8494_327"></a><blockquote class="code"><p class="quoted">
Definition: a program is blank if the number of entries in its script is 0.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8495_327" -->
<a id="c8495_327"></a><blockquote class="code"><p class="quoted">
The current instruction name is some text that varies. The current instruction set is a list of stored actions that varies.
</p></blockquote>
<!-- END CODE -->
<p>Now, we want to let Robo learn new programs; for this purpose, we'll emulate the code from our previous implementation, so that Robo watches what the player does and stores those actions in his script:</p>
<!-- START CODE "c8496_327" -->
<a id="c8496_327"></a><blockquote class="code"><p class="quoted">
Section 2 - Learning New Programs
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8497_327" -->
<a id="c8497_327"></a><blockquote class="code"><p class="quoted">
Understand &quot;learn [text]&quot; as learning. Learning is an action applying to one topic.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8498_327" -->
<a id="c8498_327"></a><blockquote class="code"><p class="quoted">
Check learning:
<br />&#160;&#160;&#160;&#160;say &quot;You have already learned all you need to know. Robo, however, remains to be trained.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8499_327" -->
<a id="c8499_327"></a><blockquote class="code"><p class="quoted">
Check Robo learning:
<br />&#160;&#160;&#160;&#160;if Robo is watching, say &quot;Robo is already recording '[the current instruction name]'.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8500_327" -->
<a id="c8500_327"></a><blockquote class="code"><p class="quoted">
Carry out Robo learning:
<br />&#160;&#160;&#160;&#160;truncate the current instruction set to 0 entries;
<br />&#160;&#160;&#160;&#160;now the current instruction name is the topic understood;
<br />&#160;&#160;&#160;&#160;now Robo is watching.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8501_327" -->
<a id="c8501_327"></a><blockquote class="code"><p class="quoted">
Report Robo learning:
<br />&#160;&#160;&#160;&#160;say &quot;'Learning [the current instruction name in upper case],' Robo replies.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8502_327" -->
<a id="c8502_327"></a><blockquote class="code"><p class="quoted">
After doing something when Robo is watching and Robo can see the player:
<br />&#160;&#160;&#160;&#160;now the actor is Robo;
<br />&#160;&#160;&#160;&#160;add the current action to the current instruction set;
<br />&#160;&#160;&#160;&#160;now the actor is the player;
<br />&#160;&#160;&#160;&#160;say &quot;Robo watches you [the current action][one of], his yellow eyes lamp-like and observant[or]. In his metal head, gears whirr[or], his brushed-copper handlebar moustaches twitching[or] impassively[at random].&quot;;
<br />&#160;&#160;&#160;&#160;continue the action.
</p></blockquote>
<!-- END CODE -->
<p>Of course, we also need to be able to switch learning mode off, and store any script learned this way. We'll also use the same STOP command to make Robo terminate a program he's in the middle of running.</p>
<!-- START CODE "c8503_327" -->
<a id="c8503_327"></a><blockquote class="code"><p class="quoted">
Section 3 - Returning to Standby Mode
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8504_327" -->
<a id="c8504_327"></a><blockquote class="code"><p class="quoted">
Understand &quot;stop&quot; as stopping. Stopping is an action applying to nothing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8505_327" -->
<a id="c8505_327"></a><blockquote class="code"><p class="quoted">
Check stopping:
<br />&#160;&#160;&#160;&#160;say &quot;The command is useful only for Robo.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8506_327" -->
<a id="c8506_327"></a><blockquote class="code"><p class="quoted">
Check Robo stopping:
<br />&#160;&#160;&#160;&#160;if Robo is standing by, stop the action.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8507_327" -->
<a id="c8507_327"></a><blockquote class="code"><p class="quoted">
Carry out Robo stopping when Robo is watching:
<br />&#160;&#160;&#160;&#160;let N be a random blank program;
<br />&#160;&#160;&#160;&#160;if N is a program:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the starter command of N is the current instruction name;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the script of N is the current instruction set;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;'Stored [current instruction name in upper case].'&quot;;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;FAILURE: no program slots remaining.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8508_327" -->
<a id="c8508_327"></a><blockquote class="code"><p class="quoted">
Carry out Robo stopping:
<br />&#160;&#160;&#160;&#160;now Robo is standing by.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8509_327" -->
<a id="c8509_327"></a><blockquote class="code"><p class="quoted">
Report Robo stopping:
<br />&#160;&#160;&#160;&#160;say &quot;Robo is now standing by.&quot;
</p></blockquote>
<!-- END CODE -->
<p>Next, we need to be able to play these programs back again. We'll give Robo a &quot;current program&quot; to store which program he's currently working on, and a number called &quot;stage&quot; which will record where he is in the script. Our previous implementation simply had Robo erase entries from his script list as he performed them, but this time we would like Robo to be able to remember and rerun the same scripts over and over, so we need something a little more subtle.</p>
<!-- START CODE "c8510_327" -->
<a id="c8510_327"></a><blockquote class="code"><p class="quoted">
Section 4 - Running Learned Programs
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8511_327" -->
<a id="c8511_327"></a><blockquote class="code"><p class="quoted">
Understand &quot;run [any program]&quot; as running. Running is an action applying to one visible thing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8512_327" -->
<a id="c8512_327"></a><blockquote class="code"><p class="quoted">
Check running:
<br />&#160;&#160;&#160;&#160;say &quot;Only Robo can perform Robo's programs.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8513_327" -->
<a id="c8513_327"></a><blockquote class="code"><p class="quoted">
Check Robo running:
<br />&#160;&#160;&#160;&#160;if Robo is not standing by, stop the action.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8514_327" -->
<a id="c8514_327"></a><blockquote class="code"><p class="quoted">
Unsuccessful attempt by Robo running:
<br />&#160;&#160;&#160;&#160;say &quot;'ERROR: Robo can launch new programs only when on standby.'&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8515_327" -->
<a id="c8515_327"></a><blockquote class="code"><p class="quoted">
Carry out Robo running:
<br />&#160;&#160;&#160;&#160;now the current program of Robo is the noun;
<br />&#160;&#160;&#160;&#160;now the stage of Robo is 1;
<br />&#160;&#160;&#160;&#160;now Robo is replaying.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8516_327" -->
<a id="c8516_327"></a><blockquote class="code"><p class="quoted">
Report Robo running:
<br />&#160;&#160;&#160;&#160;say &quot;'Running [the starter command in upper case],' Robo confirms.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8517_327" -->
<a id="c8517_327"></a><blockquote class="code"><p class="quoted">
Every turn when Robo is replaying:
<br />&#160;&#160;&#160;&#160;let the chosen script be the script of the current program of Robo;
<br />&#160;&#160;&#160;&#160;let maximum be the number of entries in the chosen script;
<br />&#160;&#160;&#160;&#160;let N be the stage of Robo;
<br />&#160;&#160;&#160;&#160;let the next step be entry N of the chosen script;
<br />&#160;&#160;&#160;&#160;try the next step;
<br />&#160;&#160;&#160;&#160;increment the stage of Robo;
<br />&#160;&#160;&#160;&#160;if the stage of Robo is greater than the maximum:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;Robo's program ends, and he reverts to stand-by mode.&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now Robo is standing by;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the stage of Robo is 1.
</p></blockquote>
<!-- END CODE -->
<p>For the player's sanity, we should also provide a way to find out which programs Robo has stored in memory and what they do, so we design two listing commands:</p>
<!-- START CODE "c8518_327" -->
<a id="c8518_327"></a><blockquote class="code"><p class="quoted">
Section 5 - Listing Learned Programs
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8519_327" -->
<a id="c8519_327"></a><blockquote class="code"><p class="quoted">
Understand &quot;list programs&quot; as requesting program list. Requesting program list is an action applying to nothing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8520_327" -->
<a id="c8520_327"></a><blockquote class="code"><p class="quoted">
Check requesting program list:
<br />&#160;&#160;&#160;&#160;say &quot;You will have to ask Robo to list programs.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8521_327" -->
<a id="c8521_327"></a><blockquote class="code"><p class="quoted">
Carry out Robo requesting program list:
<br />&#160;&#160;&#160;&#160;say &quot;'The available program[if more than one program is not blank]s[end if] [is-are list of programs which are not blank].'&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8522_327" -->
<a id="c8522_327"></a><blockquote class="code"><p class="quoted">
Understand &quot;describe [any program]&quot; or &quot;list [any program]&quot; as requesting script of. Requesting script of is an action applying to one visible thing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8523_327" -->
<a id="c8523_327"></a><blockquote class="code"><p class="quoted">
Check requesting script of:
<br />&#160;&#160;&#160;&#160;say &quot;You will have to ask Robo to give you the script.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8524_327" -->
<a id="c8524_327"></a><blockquote class="code"><p class="quoted">
Carry out Robo requesting script of:
<br />&#160;&#160;&#160;&#160;say &quot;The script of [noun] is: [script of the noun].&quot;
</p></blockquote>
<!-- END CODE -->
<p>And to complete the suite, in case the player runs into Robo's fifteen-program limit:</p>
<!-- START CODE "c8525_327" -->
<a id="c8525_327"></a><blockquote class="code"><p class="quoted">
Section 6 - Deleting Learned Programs
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8526_327" -->
<a id="c8526_327"></a><blockquote class="code"><p class="quoted">
Understand &quot;delete [any program]&quot; as deleting. Deleting is an action applying to one visible thing. Understand the command &quot;erase&quot; as &quot;delete&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8527_327" -->
<a id="c8527_327"></a><blockquote class="code"><p class="quoted">
Check deleting:
<br />&#160;&#160;&#160;&#160;say &quot;You will have to instruct Robo to delete [the noun].&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8528_327" -->
<a id="c8528_327"></a><blockquote class="code"><p class="quoted">
Check Robo deleting (this is the can't delete except in standby rule):
<br />&#160;&#160;&#160;&#160;if Robo is not standing by, stop the action.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8529_327" -->
<a id="c8529_327"></a><blockquote class="code"><p class="quoted">
Unsuccessful attempt by Robo deleting:
<br />&#160;&#160;&#160;&#160;say &quot;'ERROR: programs may only be deleted while Robo is in stand-by mode.'&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8530_327" -->
<a id="c8530_327"></a><blockquote class="code"><p class="quoted">
Carry out Robo deleting:
<br />&#160;&#160;&#160;&#160;truncate the script of the noun to 0 entries;
<br />&#160;&#160;&#160;&#160;now the starter command of the noun is &quot;&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8531_327" -->
<a id="c8531_327"></a><blockquote class="code"><p class="quoted">
Report Robo deleting:
<br />&#160;&#160;&#160;&#160;say &quot;'Program deleted.'&quot;
</p></blockquote>
<!-- END CODE -->
<p>Now we use pretty much the same set-up as before to test Robo's abilities:</p>
<!-- START CODE "c8532_327" -->
<a id="c8532_327"></a><blockquote class="code"><p class="quoted">
Chapter 2 - The Scenario
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8533_327" -->
<a id="c8533_327"></a><blockquote class="code"><p class="quoted">
The Experimentation Chamber is a room.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8534_327" -->
<a id="c8534_327"></a><blockquote class="code"><p class="quoted">
Robo is a man in the Experimentation Chamber. &quot;Robo, your prototype tin companion, stands awkwardly beside you[if watching], watching[end if].&quot; Robo can be watching, replaying, or standing by. Robo is standing by. Robo has a program called the current program. Robo has a number called the stage.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8535_327" -->
<a id="c8535_327"></a><blockquote class="code"><p class="quoted">
Persuasion rule: persuasion succeeds.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8536_327" -->
<a id="c8536_327"></a><blockquote class="code"><p class="quoted">
The red block and the blue cylinder are things in the Experimentation Chamber. The counter is a supporter in the Experimentation Chamber. The counter is scenery.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8537_327" -->
<a id="c8537_327"></a><blockquote class="code"><p class="quoted">
Report Robo examining Robo:
<br />&#160;&#160;&#160;&#160;say &quot;Robo examines each of his hands in turn, then each of his legs (bending over mostly double in the middle to do this).&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8538_327" -->
<a id="c8538_327"></a><blockquote class="code"><p class="quoted">
Report Robo examining the player:
<br />&#160;&#160;&#160;&#160;say &quot;Robo stares at you, unblinkingly, for several seconds together[if a random chance of 1 in 7 succeeds]. His left moustache-bar twitches infinitesimally upward[end if].&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8539_327" -->
<a id="c8539_327"></a><blockquote class="code"><p class="quoted">
Report Robo taking the cylinder:
<br />&#160;&#160;&#160;&#160;say &quot;[one of][Robo] needs several attempts to get his metal fingers around [the cylinder] -- they are not designed for grasping small objects elegantly. But at last he succeeds[or]Once again, Robo struggles a bit before picking up [the cylinder][stopping].&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8540_327" -->
<a id="c8540_327"></a><blockquote class="code"><p class="quoted">
Test me with &quot;test chocolate / test vanilla&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8541_327" -->
<a id="c8541_327"></a><blockquote class="code"><p class="quoted">
Test chocolate with &quot;learn chocolate / stop / list programs / Robo, learn chocolate / take red / put all on counter / Robo, stop / Robo, list programs / Robo, run chocolate / z / Robo, run chocolate / Robo, stop / z&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8542_327" -->
<a id="c8542_327"></a><blockquote class="code"><p class="quoted">
Test vanilla with &quot;Robo, learn vanilla / take all / i / drop all / x robo / x me / Robo, stop / Robo, list programs / Robo, list vanilla / Robo, run vanilla / z / z / robo, delete vanilla / robo, stop / robo, list vanilla / robo, delete vanilla / robo, list programs&quot;.
</p></blockquote>
<!-- END CODE -->
<p>We could also have written this so that Robo learns new scripts by accepting the player's instructions, so that</p>
<!-- START CODE "c8543_327" -->
<a id="c8543_327"></a><blockquote class="code"><p class="quoted">
&gt;ROBO, LEARN LIBRARY THEFT
<br />&gt;ROBO, TAKE BOOK
<br />&gt;ROBO, EAST
<br />&gt;ROBO, STOP
</p></blockquote>
<!-- END CODE -->
<p>...would store the script 'library theft' with the actions taking the book and going east. The implementation there would have been mostly identical, except that instead of an &quot;after doing something...&quot; rule, we would have captured commands as we asked Robo to perform them, and added those to the command list in progress. The alternative code might look something like this:</p>
<!-- START CODE "c8544_327" -->
<a id="c8544_327"></a><blockquote class="code"><p class="quoted">
Before Robo doing something other than stopping when Robo is watching:
<br />&#160;&#160;&#160;&#160;add the current action to the current instruction set;
<br />&#160;&#160;&#160;&#160;say &quot;'CHECK: [current action] added to script,' says Robo.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8545_327" -->
<a id="c8545_327"></a><blockquote class="code"><p class="quoted">
Unsuccessful attempt by Robo doing something when Robo is watching:
<br />&#160;&#160;&#160;&#160;say &quot;He does not actually perform the action.&quot;
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "430: Leopard-skin" "e224" -->
<a id="e224"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_21.html#e224" class="eglink"><b>430</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_21.html#e224" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Leopard-skin</span></b></a><br />A maze that the player can escape if he performs an exact sequence of actions.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_6.html#e224"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example224">
<p>Suppose (as in Infocom's Leather Goddesses of Phobos) that we have a maze that the player can escape only by performing the correct sequence of actions in the correct order. One way to do this would be to keep a list of the player's most recent actions, and see whether these match up with the combination we have established as the maze's solution.</p>
<p>For instance:</p>
<!-- START CODE "c8546_224" -->
<a id="c8546_224"></a><blockquote class="code"><p class="quoted">
 &quot;Leopard-skin&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8547_224" -->
<a id="c8547_224"></a><blockquote class="code"><p class="quoted">
The Fur-Lined Maze is a room. &quot;This seemingly endless sequence of rooms is decorated in a tasteful selection of exotic furs and gilded fixtures.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8548_224" -->
<a id="c8548_224"></a><blockquote class="code"><p class="quoted">
Clapping is an action applying to nothing. Understand &quot;clap&quot; as clapping.
<br />Kweepaing is an action applying to nothing. Understand &quot;kweepa&quot; as kweepaing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8549_224" -->
<a id="c8549_224"></a><blockquote class="code"><p class="quoted">
Carry out clapping:
<br />&#160;&#160;&#160;&#160;say &quot;You clap.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8550_224" -->
<a id="c8550_224"></a><blockquote class="code"><p class="quoted">
Carry out kweepaing:
<br />&#160;&#160;&#160;&#160;say &quot;You holler 'KWEEPA!' triumphantly.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8551_224" -->
<a id="c8551_224"></a><blockquote class="code"><p class="quoted">
The maze-sequence is a list of stored actions that varies.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8552_224" -->
<a id="c8552_224"></a><blockquote class="code"><p class="quoted">
When play begins:
<br />&#160;&#160;&#160;&#160;add jumping to the maze-sequence;
<br />&#160;&#160;&#160;&#160;add clapping to the maze-sequence;
<br />&#160;&#160;&#160;&#160;add kweepaing to the maze-sequence.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8553_224" -->
<a id="c8553_224"></a><blockquote class="code"><p class="quoted">
The attempted-sequence is a list of stored actions that varies.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8554_224" -->
<a id="c8554_224"></a><blockquote class="code"><p class="quoted">
Every turn when the player is in the Fur-Lined Maze:
<br />&#160;&#160;&#160;&#160;truncate the attempted-sequence to the last two entries;
<br />&#160;&#160;&#160;&#160;add the current action to the attempted-sequence;
<br />&#160;&#160;&#160;&#160;if the attempted-sequence is the maze-sequence:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;That does it! You are instantly transported from the maze!&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end the story finally.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8555_224" -->
<a id="c8555_224"></a><blockquote class="code"><p class="quoted">
Test me with &quot;hop / clap / clap / hop / kweepa / hop / clap / kweepa&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "431: The Facts Were These" "e135" -->
<a id="e135"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_21.html#e135" class="eglink"><b>431</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_21.html#e135" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">The Facts Were These</span></b></a><br />Creating a variant GIVE action that lets the player give multiple objects simultaneously with commands like GIVE ALL TO ATTENDANT or GIVE THREE DOLLARS TO ATTENDANT or GIVE PIE AND HAT TO ATTENDANT. The attendant accepts the gifts only if their total combined value matches some minimum amount.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_6.html#e135"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example135">
<p>Occasionally it happens that we want to process an action on multiple items differently than we would if the player had just typed each of the individual actions separately. In this example, the reason is that we can only successfully GIVE items when their combined value passes a certain threshold amount; otherwise the recipient will reject them.</p>
<p>This works as an implementation of money, if we give value only to cash objects (though several other implementations of cash are available, most of which are simpler and more efficient). We could also imagine a mechanic like this being used for a bargaining or auction game as well, given a society that deals in objects rather than credits.</p>
<p>In order to consider all the items in the gift at once, we create an action that applies to multiple objects, but will in fact test the whole object collection during the first pass and print a definitive answer to whether the action succeeded. All subsequent times the game consults the rulebook will be stopped at the very beginning. No further processing will occur or output be printed.</p>
<!-- START CODE "c8556_135" -->
<a id="c8556_135"></a><blockquote class="code"><p class="quoted">
&quot;The Facts Were These&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8557_135" -->
<a id="c8557_135"></a><blockquote class="code"><p class="quoted">
Section 1 - Procedure
</p></blockquote>
<!-- END CODE -->
<p>We start by creating the idea that everything in the game has a monetary value:</p>
<!-- START CODE "c8558_135" -->
<a id="c8558_135"></a><blockquote class="code"><p class="quoted">
A price is a kind of value. $10 specifies a price. A thing has a price.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8559_135" -->
<a id="c8559_135"></a><blockquote class="code"><p class="quoted">
Understand &quot;give [things preferably held] to [someone]&quot; as multiply-giving it to. Understand &quot;give [things] to [someone]&quot; as multiply-giving it to.  Multiply-giving it to is an action applying to two things.
</p></blockquote>
<!-- END CODE -->
<p>A subtlety here: we say &quot;things preferably held&quot; to prefer items that the player is holding (so if the player has two dollars in hand and a third lies on the ground, he will use just the two he has).</p>
<p>The second grammar line allows Inform to match things that aren't held if it can't make up the list from things that are. If all three dollars are on the ground, the player can pick them up before spending them.</p>
<p>We do not, however, make multiply-giving apply to a &quot;carried&quot; item, because that will generate implicit takes of those items in a way that will mess up our action reporting. Instead, we're going to build the implicit takes into the system in a different way, one that permits us to collate the reports more attractively and print a short, one-sentence list of anything that the player had to pick up.</p>
<!-- START CODE "c8560_135" -->
<a id="c8560_135"></a><blockquote class="code"><p class="quoted">
A thing can be given or ungiven. A thing is usually ungiven.
</p></blockquote>
<!-- END CODE -->
<p>This is for record-keeping purposes so that we can print an attractive list of what was given at the end of the turn.</p>
<!-- START CODE "c8561_135" -->
<a id="c8561_135"></a><blockquote class="code"><p class="quoted">
First check multiply-giving it to:
<br />&#160;&#160;&#160;&#160;if already gave at the office is true:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;stop the action.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8562_135" -->
<a id="c8562_135"></a><blockquote class="code"><p class="quoted">
Already gave at the office is a truth state that varies.
</p></blockquote>
<!-- END CODE -->
<p>&quot;Already gave at the office&quot; is the perhaps-excessively-named flag that keeps track of whether we've already done this action once.</p>
<!-- START CODE "c8563_135" -->
<a id="c8563_135"></a><blockquote class="code"><p class="quoted">
Check multiply-giving something to the player:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You can hardly bribe yourself.[paragraph break]&quot; instead;
</p></blockquote>
<!-- END CODE -->
<p>The following rule is longish because it processes the entire list at once, generating implicit takes if necessary (but processing those implicit takes silently according to its own special rule, so that the output can be managed attractively). We are also, at the same time, calculating the total value of the player's offer.</p>
<!-- START CODE "c8564_135" -->
<a id="c8564_135"></a><blockquote class="code"><p class="quoted">
Check multiply-giving it to:
<br />&#160;&#160;&#160;&#160;let L be the multiple object list;
<br />&#160;&#160;&#160;&#160;let bribe-price be $0;
<br />&#160;&#160;&#160;&#160;repeat with item running through L:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the player does not carry the item:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;abide by the ungivability rules for the item;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;carry out the implicitly taking activity with the item;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the player does not carry the item:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You can't include [the item] in your bribe, since you're not holding [them]![paragraph break]&quot; instead;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;increase bribe-price by the price of item;
<br />&#160;&#160;&#160;&#160;if the number of entries in the recently-collected list is greater than 0:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;repeat with item running through the recently-collected list:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now item is marked for listing;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You pick up [the list of marked for listing things] and make your offer. [run paragraph on]&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now everything is unmarked for listing;
<br />&#160;&#160;&#160;&#160;if the bribe-price is less than the price of the second noun:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[The second noun] angrily rejects your piffling bribe.[paragraph break]&quot; instead.
</p></blockquote>
<!-- END CODE -->
<p>The bit about making some items &quot;marked for listing&quot;, above, rather than printing the list directly, is that using the &quot;[the list of....]&quot; syntax guarantees that Inform will respect grouping rules in writing its description. For instance, if the player has automatically taken all three dollars, the output will say &quot;the three dollars&quot; instead of &quot;the dollar, the dollar, and the dollar.&quot;</p>
<!-- START CODE "c8565_135" -->
<a id="c8565_135"></a><blockquote class="code"><p class="quoted">
Carry out multiply-giving it to:
<br />&#160;&#160;&#160;&#160;let L be the multiple object list;
<br />&#160;&#160;&#160;&#160;repeat with item running through L:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the second noun carries the item;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the item is given;
<br />&#160;&#160;&#160;&#160;now already gave at the office is true;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8566_135" -->
<a id="c8566_135"></a><blockquote class="code"><p class="quoted">
Report multiply-giving it to:
<br />&#160;&#160;&#160;&#160;say &quot;[The second noun] rather shamefacedly tucks [the list of given things] away into a pocket.[paragraph break]&quot;.
</p></blockquote>
<!-- END CODE -->
<p>Now we create our own variation of implicitly taking in order to customize the output for the multiply-giving action. The &quot;ungivability rules&quot; should disallow any object that the player absolutely cannot take, because we want &quot;carry out the implicitly taking activity&quot; to succeed every time -- and therefore not print out any less-attractive results from implicit takes that don't succeed. Otherwise, the player's GIVE TREE AND DOG TO ATTENDANT might produce the reply &quot;That's fixed in place&quot; -- without specifying which object is fixed in place.</p>
<p>Because of the way this works, we will want to be careful: if we have any &quot;instead of taking...&quot; rules for special objects in the game, we should be sure to mirror those with an ungivability rule to print something more suitable in the case that the player tries taking that object as part of the multiple giving action.</p>
<!-- START CODE "c8567_135" -->
<a id="c8567_135"></a><blockquote class="code"><p class="quoted">
The ungivability rules are an object-based rulebook.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8568_135" -->
<a id="c8568_135"></a><blockquote class="code"><p class="quoted">
An ungivability rule for a person:
<br />&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;say &quot;Slavery is illegal.[paragraph break]&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8569_135" -->
<a id="c8569_135"></a><blockquote class="code"><p class="quoted">
An ungivability rule for something (called the item) which is enclosed by someone who is not the player:
<br />&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;say &quot;[The item] [aren't] yours to give.[paragraph break]&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8570_135" -->
<a id="c8570_135"></a><blockquote class="code"><p class="quoted">
An ungivability rule for something which encloses the player:
<br />&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;say &quot;You don't want to end up as part of the gift.[paragraph break]&quot; instead;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8571_135" -->
<a id="c8571_135"></a><blockquote class="code"><p class="quoted">
An ungivability rule for something (called the item) which is part of something:
<br />&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;say &quot;[The item] [are] attached to [a random thing which incorporates the item][paragraph break]&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8572_135" -->
<a id="c8572_135"></a><blockquote class="code"><p class="quoted">
An ungivability rule for something (called the item) which is scenery:
<br />&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;say &quot;[The item] [are] unremovable.[paragraph break]&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8573_135" -->
<a id="c8573_135"></a><blockquote class="code"><p class="quoted">
An ungivability rule for something (called the item) which is fixed in place:
<br />&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;say &quot;[The item] [are] fixed in place.[paragraph break]&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8574_135" -->
<a id="c8574_135"></a><blockquote class="code"><p class="quoted">
An ungivability rule for a direction (called the item):
<br />&#160;&#160;&#160;&#160;now already gave at the office is true;
<br />&#160;&#160;&#160;&#160;say &quot;[The item] [are] not susceptible to giving.[paragraph break]&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8575_135" -->
<a id="c8575_135"></a><blockquote class="code"><p class="quoted">
Rule for implicitly taking something (called target) while multiply-giving:
<br />&#160;&#160;&#160;&#160;silently try taking the target;
<br />&#160;&#160;&#160;&#160;if the player carries the target:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;add the target to the recently-collected list.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8576_135" -->
<a id="c8576_135"></a><blockquote class="code"><p class="quoted">
The recently-collected list is a list of objects that varies.
</p></blockquote>
<!-- END CODE -->
<p>And since we don't want to list the individual objects separately:</p>
<!-- START CODE "c8577_135" -->
<a id="c8577_135"></a><blockquote class="code"><p class="quoted">
The selectively announce items from multiple object lists rule is listed instead of the announce items from multiple object lists rule in the action-processing rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8578_135" -->
<a id="c8578_135"></a><blockquote class="code"><p class="quoted">
This is the selectively announce items from multiple object lists rule:
<br />&#160;&#160;&#160;&#160;if multiply-giving:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;do nothing;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the current item from the multiple object list is not nothing:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[current item from the multiple object list]: [run paragraph on]&quot;.
</p></blockquote>
<!-- END CODE -->
<p>And now, since this ought to work symmetrically if the player provides just one high-value item:</p>
<!-- START CODE "c8579_135" -->
<a id="c8579_135"></a><blockquote class="code"><p class="quoted">
Check giving something to someone:
<br />&#160;&#160;&#160;&#160;if the price of the noun is less than the price of the second noun:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;[The second noun] angrily rejects your piffling bribe.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<p>As we've seen elsewhere, the giving action by default returns a refusal, but is also written to start working if we remove the blockage. So we do that here, and revise the report rule to match the report rule we have for multiple giving.</p>
<!-- START CODE "c8580_135" -->
<a id="c8580_135"></a><blockquote class="code"><p class="quoted">
The block giving rule is not listed in any rulebook.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8581_135" -->
<a id="c8581_135"></a><blockquote class="code"><p class="quoted">
The new report giving rule is listed instead of the standard report giving rule in the report giving it to rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8582_135" -->
<a id="c8582_135"></a><blockquote class="code"><p class="quoted">
This is the new report giving rule:
<br />&#160;&#160;&#160;&#160;say &quot;[The second noun] rather shamefacedly tucks [the noun] away into a pocket.&quot;
</p></blockquote>
<!-- END CODE -->
<p>After each instance of the multiply-giving action, we need to clear the variables we used to track its state. We could do this in &quot;Before reading a command&quot;, but that's unsafe because the player might type GIVE PIE AND CAP TO ATTENDANT. GIVE DOLLARS TO ATTENDANT. all on a single line, and we would like to be able to clear the variables between one action and the next. The correct place to attach this behavior is immediately before the generate action rule, thus:</p>
<!-- START CODE "c8583_135" -->
<a id="c8583_135"></a><blockquote class="code"><p class="quoted">
The before-generation rule is listed before the generate action rule in the turn sequence rules.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8584_135" -->
<a id="c8584_135"></a><blockquote class="code"><p class="quoted">
This is the before-generation rule:
<br />&#160;&#160;&#160;&#160;now every thing is ungiven;
<br />&#160;&#160;&#160;&#160;now already gave at the office is false;
<br />&#160;&#160;&#160;&#160;truncate the recently-collected list to 0 entries.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8585_135" -->
<a id="c8585_135"></a><blockquote class="code"><p class="quoted">
Section 2 - Scenario
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8586_135" -->
<a id="c8586_135"></a><blockquote class="code"><p class="quoted">
The Morgue Office is a room. &quot;This is not the Morgue itself; this is only its outer office. The familiar room full of silver drawers and cold air lies beyond.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8587_135" -->
<a id="c8587_135"></a><blockquote class="code"><p class="quoted">
The Morgue Attendant is a man in the Morgue Office. &quot;The Attendant has seen you come through a number of times, and is becoming suspicious of your abiding interest in dead people.&quot; The description is &quot;The Morgue Attendant is fifty-four years, six months, five days, and three minutes old.&quot; The price of the Morgue Attendant is $3.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8588_135" -->
<a id="c8588_135"></a><blockquote class="code"><p class="quoted">
A dollar is a kind of thing. The player carries three dollars.  The price of a dollar is always $1.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8589_135" -->
<a id="c8589_135"></a><blockquote class="code"><p class="quoted">
The player carries a miniature rhubarb pie. The price of the miniature rhubarb pie is $5.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8590_135" -->
<a id="c8590_135"></a><blockquote class="code"><p class="quoted">
The player carries a knitted cap. The price of the knitted cap is $2.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8591_135" -->
<a id="c8591_135"></a><blockquote class="code"><p class="quoted">
Test me with &quot;test dollars / purloin three dollars / test multi-line / purloin three dollars / purloin pie / purloin cap / test specificity / purloin three dollars / test largesse / test mixed-gift&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8592_135" -->
<a id="c8592_135"></a><blockquote class="code"><p class="quoted">
Test multi-line with &quot;give dollar and pie to attendant. give dollars and cap to attendant&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8593_135" -->
<a id="c8593_135"></a><blockquote class="code"><p class="quoted">
Test dollars with &quot;drop all / give dollar to Morgue Attendant / give dollars to Morgue Attendant / get dollars / give dollars to morgue attendant / purloin three dollars / drop dollars / give dollars to Morgue Attendant&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8594_135" -->
<a id="c8594_135"></a><blockquote class="code"><p class="quoted">
Test specificity with &quot;give three dollars to Morgue Attendant&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8595_135" -->
<a id="c8595_135"></a><blockquote class="code"><p class="quoted">
Test largesse with &quot;give pie to Morgue Attendant&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8596_135" -->
<a id="c8596_135"></a><blockquote class="code"><p class="quoted">
Test mixed-gift with &quot;give dollar and cap to Morgue Attendant / get cap / give dollar and cap to morgue attendant / give me and dollar to attendant&quot;.
</p></blockquote>
<!-- END CODE -->
<p>PURLOIN, used in the tests here, is a special debugging command that allows the player to acquire objects that wouldn't otherwise be possible to take. It is only active in non-release versions of the story. For more about debugging commands, see the chapter on Testing and Debugging.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "432: Circle of Misery" "e81" -->
<a id="e81"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_21.html#e81" class="eglink"><b>432</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_21.html#e81" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Circle of Misery</span></b></a><br />Retrieving items from an airport luggage carousel is such fun, how can we resist simulating it, using a list as a ring buffer?</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_8.html#e81"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example81">
<p>The only point we need to be careful about is that the carousel is simulated twice over, in the following text: once in the built-in way that objects are inside other objects, so that the luggage items are objects contained in the carousel object; but then again by the &quot;circle of misery&quot; list, a ring buffer keeping track of what order things are in. We need to be careful that these two records do not fall out of synchrony: anything put into the carousel must be added to the list, anything taken out must be removed. (In fact we forbid things to be added, for simplicity's sake.)</p>
<!-- START CODE "c8597_81" -->
<a id="c8597_81"></a><blockquote class="code"><p class="quoted">
&quot;Circle Of Misery&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8598_81" -->
<a id="c8598_81"></a><blockquote class="code"><p class="quoted">
Luggage item is a kind of thing. The blue golf bag, the leopardskin suitcase, the green rucksack and the Lufthansa shoulder-bag are luggage items.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8599_81" -->
<a id="c8599_81"></a><blockquote class="code"><p class="quoted">
Heathrow Baggage Claim is a room. The carousel is a container in Heathrow. &quot;The luggage carousel, a scaly rubbered ring, does for the roundabout what Heathrow Airport does for the dream of flight: that is, turns the purest magic into the essence of boredom, only with extra stress. [if the number of entries in the circle of misery is 0]For once it stands idle. Perhaps it's broken.[otherwise]The baggage approaching you now: [the circle of misery with indefinite articles].&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8600_81" -->
<a id="c8600_81"></a><blockquote class="code"><p class="quoted">
The circle of misery is a list of objects that varies.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8601_81" -->
<a id="c8601_81"></a><blockquote class="code"><p class="quoted">
When play begins:
<br />&#160;&#160;&#160;&#160;now all the luggage items are in the carousel;
<br />&#160;&#160;&#160;&#160;add the list of luggage items to the circle of misery.
</p></blockquote>
<!-- END CODE -->
<p>The list &quot;circle of misery&quot; is our ring, in which entry 1 is considered to be the position of whichever bag is currently frontmost. And here it goes, round and round:</p>
<!-- START CODE "c8602_81" -->
<a id="c8602_81"></a><blockquote class="code"><p class="quoted">
Every turn when the number of entries in the circle of misery is not 0:
<br />&#160;&#160;&#160;&#160;rotate the circle of misery;
<br />&#160;&#160;&#160;&#160;let the bag be entry 1 of the circle of misery;
<br />&#160;&#160;&#160;&#160;say &quot;The carousel trundles on, bringing [a bag] to within reach.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8603_81" -->
<a id="c8603_81"></a><blockquote class="code"><p class="quoted">
After taking a luggage item (called the bag):
<br />&#160;&#160;&#160;&#160;remove the bag from the circle of misery, if present;
<br />&#160;&#160;&#160;&#160;say &quot;Taken.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8604_81" -->
<a id="c8604_81"></a><blockquote class="code"><p class="quoted">
Before doing something with a luggage item (called the bag) which is in the carousel:
<br />&#160;&#160;&#160;&#160;if the bag is not entry 1 of the circle of misery, say &quot;[The bag] is maddeningly out of range. You'll have to wait for it to come round.&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8605_81" -->
<a id="c8605_81"></a><blockquote class="code"><p class="quoted">
Instead of inserting something into the carousel, say &quot;In recent years, the authorities have tended to frown upon depositing bags in random places at airports.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8606_81" -->
<a id="c8606_81"></a><blockquote class="code"><p class="quoted">
Test me with &quot;get suitcase / get suitcase / get suitcase / get suitcase / look / get golf bag / look / get golf bag&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "433: Eyes, Fingers, Toes" "e133" -->
<a id="e133"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_21.html#e133" class="eglink"><b>433</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_21.html#e133" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Eyes, Fingers, Toes</span></b></a><br />A safe with a multi-number combination, meant to be dialed over multiple turns, is implemented using a log of the last three numbers dialed. The log can then be compared to the safe's correct combination.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_9.html#e133"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example133">
<p>It is not difficult to implement a safe which can be set to a single number to open; but a more common scenario in the real world is for the safe to open on a sequence of numbers when they have been dialed in the right order.</p>
<p>For IF, this means that we have to keep running track of the last N digits the player has dialed, dropping the first digit and adding a new one to the end each time the player re-dials the safe. This is a perfect occasion for lists:</p>
<!-- START CODE "c8607_133" -->
<a id="c8607_133"></a><blockquote class="code"><p class="quoted">
&quot;Eyes, Fingers, Toes&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8608_133" -->
<a id="c8608_133"></a><blockquote class="code"><p class="quoted">
The Addams Wine Cellar is a room. It contains a closed lockable locked container called a safe.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8609_133" -->
<a id="c8609_133"></a><blockquote class="code"><p class="quoted">
The safe has a list of numbers called the current combination.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8610_133" -->
<a id="c8610_133"></a><blockquote class="code"><p class="quoted">
The safe has a list of numbers called the true combination. The true combination of the safe is {2, 10, 11}.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8611_133" -->
<a id="c8611_133"></a><blockquote class="code"><p class="quoted">
Understand &quot;set [something] to [a number]&quot; as setting it numerically to. Setting it numerically to is an action applying to one thing and one number.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8612_133" -->
<a id="c8612_133"></a><blockquote class="code"><p class="quoted">
Instead of examining the safe:
<br />&#160;&#160;&#160;&#160;if the number of entries in the current combination of the safe is 0,
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You haven't dialed the safe to any combination yet.&quot;;
<br />&#160;&#160;&#160;&#160;otherwise say &quot;You have dialed the safe to [the current combination of the safe].&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8613_133" -->
<a id="c8613_133"></a><blockquote class="code"><p class="quoted">
Check setting something numerically to (this is the block setting numerically rule):
<br />&#160;&#160;&#160;&#160;say &quot;[The noun] cannot be set.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8614_133" -->
<a id="c8614_133"></a><blockquote class="code"><p class="quoted">
Instead of setting the safe numerically to the number understood:
<br />&#160;&#160;&#160;&#160;truncate the current combination of the safe to the last 2 entries;
<br />&#160;&#160;&#160;&#160;add the number understood to the current combination of the safe;
<br />&#160;&#160;&#160;&#160;if the safe is locked and the current combination of the safe is the true combination of the safe:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You dial [the number understood], and [the safe] gives a joyous CLICK.&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the safe is unlocked;
<br />&#160;&#160;&#160;&#160;otherwise if safe is unlocked and the safe is closed and the current combination of the safe is not the true combination of the safe:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You spin the dial, and [the safe] snicks locked.&quot;;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;now the safe is locked;
<br />&#160;&#160;&#160;&#160;otherwise:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;You dial [the number understood] on the safe.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8615_133" -->
<a id="c8615_133"></a><blockquote class="code"><p class="quoted">
Test me with &quot;x safe / set safe to 10 / x safe / set safe to 29 / x safe / set safe to 2 / x safe / set safe to 10 / x safe / set safe to 11 / open safe / set safe to 14 / close safe / set safe to 15 / open safe&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "434: The Fibonacci Sequence" "e140" -->
<a id="e140"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_21.html#e140" class="eglink"><b>434</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_21.html#e140" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">The Fibonacci Sequence</span></b></a><br />The modest Leonardo Fibonacci of Pisa will be only too happy to construct his sequence on request, using an array.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_10.html#e140"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example140">
<p>Fibonacci (a posthumous nickname) spread Arabic mathematical learning across Europe in the 13th century, and it's curious that his name lives on only for a single sequence.</p>
<!-- START CODE "c8616_140" -->
<a id="c8616_140"></a><blockquote class="code"><p class="quoted">
&quot;The Fibonacci Sequence&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8617_140" -->
<a id="c8617_140"></a><blockquote class="code"><p class="quoted">
Pisa is a room. Leonardo Fibonacci is a man in Pisa. &quot;The modest Italian mathematician, Leonardo Fibonacci (1170-1250), beams at you.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8618_140" -->
<a id="c8618_140"></a><blockquote class="code"><p class="quoted">
Sequencing is an action applying to one number. Understand &quot;sequence [number]&quot; as sequencing.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8619_140" -->
<a id="c8619_140"></a><blockquote class="code"><p class="quoted">
Instead of sequencing, say &quot;You make a feeble attempt, sketching in the sand, but it goes nowhere. Leonardo is sympathetic. 'Often goes wrong for me, too, actually. I didn't even invent the thing - the ancient Indians knew about it first.'&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8620_140" -->
<a id="c8620_140"></a><blockquote class="code"><p class="quoted">
Persuasion rule for asking Leonardo to try sequencing: persuasion succeeds.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8621_140" -->
<a id="c8621_140"></a><blockquote class="code"><p class="quoted">
Report Leonardo sequencing:
<br />&#160;&#160;&#160;&#160;let N be the number understood;
<br />&#160;&#160;&#160;&#160;say &quot;Leonardo scratches his head and makes self-deprecating remarks, before coming up with [the first N terms of the Fibonacci sequence].&quot;
</p></blockquote>
<!-- END CODE -->
<p> An array need not be fixed in length, as the following example shows:</p>
<!-- START CODE "c8622_140" -->
<a id="c8622_140"></a><blockquote class="code"><p class="quoted">
To decide what list of numbers is the first (F - a number) terms of the Fibonacci sequence:
<br />&#160;&#160;&#160;&#160;let the Fibonacci sequence be {1, 1};
<br />&#160;&#160;&#160;&#160;let N be 3;
<br />&#160;&#160;&#160;&#160;while N &lt; F:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let the last term be entry (N - 1) of the Fibonacci sequence;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let the penultimate term be entry (N - 2) of the Fibonacci sequence;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let the next term be the last term plus the penultimate term;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;add the next term to the Fibonacci sequence;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;increment N;
<br />&#160;&#160;&#160;&#160;decide on the Fibonacci sequence.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8623_140" -->
<a id="c8623_140"></a><blockquote class="code"><p class="quoted">
Test me with &quot;sequence 20 / leonardo, sequence 20&quot;.
</p></blockquote>
<!-- END CODE -->
<p>The result of &quot;the first 20 terms of the Fibonacci sequence&quot; is &quot;1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987, 1597, 2584 and 4181&quot;. This is a sequence which has a knack of turning up in odd places - it was found in the 1970s to be related to the rings of florets in a sunflower, for instance - and here it is in a book about interactive fiction.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "435: I Didn't Come All The Way From Great Portland Street" "e177" -->
<a id="e177"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_21.html#e177" class="eglink"><b>435</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_21.html#e177" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">I Didn't Come All The Way From Great Portland Street</span></b></a><br />In this fiendishly difficult puzzle, which may perhaps owe some inspiration to a certain BBC Radio panel game (1967-), a list is used as a set of actions to help enforce the rule that the player must keep going for ten turns without hesitation, repetition, or deviating from the subject on the card.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_6.html#e177"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example177">
<p>There is very little to this, in fact. The tricky rule to enforce is Repetition: the player is forbidden to repeat any previously tried action. We keep track of this by keeping a set of past actions, which for want of a better term is called the &quot;tally&quot;. All we need to do is:</p>
<!-- START CODE "c8624_177" -->
<a id="c8624_177"></a><blockquote class="code"><p class="quoted">
if the current action is listed in the tally, challenge for &quot;Repetition of [the current action]!&quot;;
<br />otherwise add the current action to the tally.
</p></blockquote>
<!-- END CODE -->
<p>Note that the tally can never contain duplicates, and that when, at the end of the round, we print it out, we sort it first - this makes a more natural-looking sentence. (Sorting a list of actions uses the natural order for actions: compare the sequence on the Actions page of the Index.) The full text, then, is:</p>
<!-- START CODE "c8625_177" -->
<a id="c8625_177"></a><blockquote class="code"><p class="quoted">
&quot;I Didn't Come All The Way From Great Portland Street&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8626_177" -->
<a id="c8626_177"></a><blockquote class="code"><p class="quoted">
The Paris Theatre is a room. An instrument is a kind of thing. The violin, the tuba, the xylophone and the triangle are instruments. The violin is inside the case. The tuba, the xylophone, the radish, the case, the bust of Nicholas Parsons, the purple felt hat and the triangle are in the Paris Theatre.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8627_177" -->
<a id="c8627_177"></a><blockquote class="code"><p class="quoted">
The Round is a scene. The Round begins when play begins. The Round ends when the turn count is 10.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8628_177" -->
<a id="c8628_177"></a><blockquote class="code"><p class="quoted">
The tally is a list of stored actions that varies.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8629_177" -->
<a id="c8629_177"></a><blockquote class="code"><p class="quoted">
When the Round begins:
<br />&#160;&#160;&#160;&#160;say &quot;'And the subject on the card is... musical instruments. Will you carry out for us something to do with that, please, for ten turns starting - now!'&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8630_177" -->
<a id="c8630_177"></a><blockquote class="code"><p class="quoted">
When the Round ends:
<br />&#160;&#160;&#160;&#160;sort the tally;
<br />&#160;&#160;&#160;&#160;say &quot;Phweeep![paragraph break]'So, when the whistle goes ten turns are up, you get a point for acting when the whistle blows, and in that round you entertained us by [the tally], and you also get a bonus point for keeping going until the whistle went.'&quot;;
<br />&#160;&#160;&#160;&#160;end the story finally.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8631_177" -->
<a id="c8631_177"></a><blockquote class="code"><p class="quoted">
To challenge for (infraction - text):
<br />&#160;&#160;&#160;&#160;say &quot;Bzzzzt! 'And [one of]Clement Freud[or]Derek Nimmo[or]Kenneth Williams[or]Peter Jones[at random] has challenged.'[paragraph break]'[infraction]'[paragraph break]'Well, as it's your first time playing the game, and the audience was enjoying your contribution so much, I will disallow the challenge, you have [10 minus the turn count] turn[s] left on musical instruments, starting... now!&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8632_177" -->
<a id="c8632_177"></a><blockquote class="code"><p class="quoted">
Before doing something:
<br />&#160;&#160;&#160;&#160;if the current action is listed in the tally, challenge for &quot;Repetition of [the current action]!&quot; instead;
<br />&#160;&#160;&#160;&#160;otherwise add the current action to the tally;
<br />&#160;&#160;&#160;&#160;if waiting, challenge for &quot;Hesitation!&quot; instead;
<br />&#160;&#160;&#160;&#160;if not looking and not waiting and the noun is not an instrument and the second noun is not an instrument, challenge for &quot;Deviation!&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8633_177" -->
<a id="c8633_177"></a><blockquote class="code"><p class="quoted">
Test me with &quot;look / wait / examine bust / take tuba / get triangle / hit xylophone / get tuba / examine tuba / get violin&quot;.
</p></blockquote>
<!-- END CODE -->
<p>(The Paris Theatre in Lower Regent Street, London, was for many years the home of BBC radio panel games.)</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "436: Lugubrious Pete's Delicatessen" "e233" -->
<a id="e233"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_21.html#e233" class="eglink"><b>436</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_21.html#e233" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Lugubrious Pete's Delicatessen</span></b></a><br />In this evocation of supermarket deli counter life, a list is used as a queue to keep track of who is waiting to be served.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_7.html#e233"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example233">
<p>First, to set the scene:</p>
<!-- START CODE "c8634_233" -->
<a id="c8634_233"></a><blockquote class="code"><p class="quoted">
&quot;Lugubrious Pete's Delicatessen&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8635_233" -->
<a id="c8635_233"></a><blockquote class="code"><p class="quoted">
The Supermarket is west of the Delicatessen Counter. Lugubrious Pete is in the Delicatessen. &quot;Lugubrious Pete, dolefully slicing meats and cheeses, serves at the counter.&quot; Alice, Beth, Gemma, Delia, and Eliza are women in the Supermarket.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8636_233" -->
<a id="c8636_233"></a><blockquote class="code"><p class="quoted">
The deli queue is a list of objects that varies.
</p></blockquote>
<!-- END CODE -->
<p>Two processes compete here: one that fills the queue, the other which will empty it. The first process is the one which brings shoppers in to the counter, joining the back of the queue, which is where &quot;add ... to ...&quot; puts new entries by default:</p>
<!-- START CODE "c8637_233" -->
<a id="c8637_233"></a><blockquote class="code"><p class="quoted">
Every turn when a woman is in the Supermarket and a random chance of 2 in 3 succeeds (this is the customer arriving rule):
<br />&#160;&#160;&#160;&#160;let the customer be a random woman in the Supermarket;
<br />&#160;&#160;&#160;&#160;now the customer is in the Delicatessen;
<br />&#160;&#160;&#160;&#160;if the player is in the Supermarket, say &quot;[The customer] walks into the Delicatessen.&quot;;
<br />&#160;&#160;&#160;&#160;if the player is in the Delicatessen, say &quot;[The customer] comes in from the Supermarket, and [if the number of entries in the deli queue is 0]can't believe her luck. The counter is free![otherwise]resignedly queues behind [the deli queue].&quot;;
<br />&#160;&#160;&#160;&#160;add the customer to the deli queue.
</p></blockquote>
<!-- END CODE -->
<p>The competing process is the one which serves shoppers and thus gets rid of them again: unfortunately, it is slower. But Pete is fair if inefficient, and serves the customers in strict order of arrival. Each served customer is removed from the front of the list, and the others therefore all move up a place.</p>
<!-- START CODE "c8638_233" -->
<a id="c8638_233"></a><blockquote class="code"><p class="quoted">
Every turn when the number of entries in the deli queue is not 0 and a random chance of 1 in 3 succeeds (this is the customer being served rule):
<br />&#160;&#160;&#160;&#160;let the customer be entry 1 of the deli queue;
<br />&#160;&#160;&#160;&#160;if the player is in the Delicatessen, say &quot;Pete gives a droopy expression as he serves [customer], who nevertheless brightens and leaves.&quot;;
<br />&#160;&#160;&#160;&#160;if the player is in the Supermarket, say &quot;[customer] emerges cheerfully from the Delicatessen Counter, and goes about her regular shopping.&quot;;
<br />&#160;&#160;&#160;&#160;now the customer is in the Supermarket;
<br />&#160;&#160;&#160;&#160;remove entry 1 from the deli queue.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8639_233" -->
<a id="c8639_233"></a><blockquote class="code"><p class="quoted">
Instead of waiting in the Delicatessen when the number of entries in the deli queue is not 0, say &quot;Time passes, for [deli queue] quite as much as for yourself.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8640_233" -->
<a id="c8640_233"></a><blockquote class="code"><p class="quoted">
Test me with &quot;wait / wait / wait / east / wait / wait / wait / wait / wait&quot;.
</p></blockquote>
<!-- END CODE -->
<p>That completes the example, but here is a variation to show that queues need not empty from the front. The Deli already looks a pretty sexist establishment, with the customers all being women, but it is about to get a whole lot worse:</p>
<!-- START CODE "c8641_233" -->
<a id="c8641_233"></a><blockquote class="code"><p class="quoted">
Modesty is a kind of value. The modesties are positively prim, buttoned up, modest, flirty, revealing and downright immodest. Every woman has a modesty. Alice is positively prim. Beth is downright immodest. Gemma is modest. Delia is flirty. Eliza is revealing.
</p></blockquote>
<!-- END CODE -->
<p>We could then rewrite the service rule like so:</p>
<!-- START CODE "c8642_233" -->
<a id="c8642_233"></a><blockquote class="code"><p class="quoted">
Every turn when the number of entries in the deli queue is not 0 and a random chance of 1 in 3 succeeds (this is the customer being served rule):
<br />&#160;&#160;&#160;&#160;let Pete's preference be the deli queue;
<br />&#160;&#160;&#160;&#160;sort Pete's preference in reverse modesty order;
<br />&#160;&#160;&#160;&#160;let the customer be entry 1 of Pete's preference;
<br />&#160;&#160;&#160;&#160;let the first in line be entry 1 of the deli queue;
<br />&#160;&#160;&#160;&#160;if the player is in the Delicatessen, say &quot;[if the customer is the first in line]Pete gives a droopy expression as he serves [the customer], who nevertheless brightens and leaves.[otherwise]Outrageously, Pete scans the queue, notices [the customer] in her [modesty of the customer] clothes, and serves her next, while [the first in line] glares at him.&quot;;
<br />&#160;&#160;&#160;&#160;if the player is in the Supermarket, say &quot;[The customer] emerges cheerfully from the Delicatessen Counter, and goes about her regular shopping.&quot;;
<br />&#160;&#160;&#160;&#160;now the customer is in the Supermarket;
<br />&#160;&#160;&#160;&#160;remove the customer from the deli queue.
</p></blockquote>
<!-- END CODE -->
<p>It is now heartbreakingly difficult for Alice to obtain her sliced chorizo sausage.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "437: Sieve of Eratosthenes" "e346" -->
<a id="e346"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_21.html#e346" class="eglink"><b>437</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_21.html#e346" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Sieve of Eratosthenes</span></b></a><br />The haughty Eratosthenes of Cyrene will nevertheless consent to sieve prime numbers on request.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_10.html#e346"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example346">
<p>In the words of Wikipedia: &quot;Eratosthenes of Cyrene (Greek Eρατοσθένης; 276 BC-194 BC) was a Greek mathematician, poet, athlete, geographer and astronomer.&quot; In the words of Tom Lehrer: &quot;It's people like that who make you realise how little you've achieved in life.&quot;</p>
<p>A prime number is a number greater than 1 which is not a multiple of anything, so we can find the primes by starting with all the numbers and sieving out all the multiples of 2, then all the multiples of 3, and so on. Here we make our sieve of the unacceptable numbers (the &quot;composite&quot; or non-prime ones) first, then form a list of all the numbers, then sieve out the composites: what are left must be the primes.</p>
<!-- START CODE "c8643_346" -->
<a id="c8643_346"></a><blockquote class="code"><p class="quoted">
&quot;Sieve of Eratosthenes&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8644_346" -->
<a id="c8644_346"></a><blockquote class="code"><p class="quoted">
Alexandria is a room. Eratosthenes is a man in Alexandria. &quot;The haughty Greek mathematician, Eratosthenes, glowers at you.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8645_346" -->
<a id="c8645_346"></a><blockquote class="code"><p class="quoted">
Sieving is an action applying to one number. Understand &quot;sieve [number]&quot; as sieving.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8646_346" -->
<a id="c8646_346"></a><blockquote class="code"><p class="quoted">
Instead of sieving, say &quot;You make a feeble attempt, sketching in the sand, but it goes nowhere. Eratosthenes smirks. 'I expect your friends call you gamma, then?'&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8647_346" -->
<a id="c8647_346"></a><blockquote class="code"><p class="quoted">
Persuasion rule for asking Eratosthenes to try sieving: persuasion succeeds.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8648_346" -->
<a id="c8648_346"></a><blockquote class="code"><p class="quoted">
Report Eratosthenes sieving:
<br />&#160;&#160;&#160;&#160;let N be the number understood;
<br />&#160;&#160;&#160;&#160;let the composites be a list of numbers;
<br />&#160;&#160;&#160;&#160;let I be 2;
<br />&#160;&#160;&#160;&#160;while I times I is at most N:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if I is not listed in the composites:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let J be I times 2;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;while J is at most N:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;add J to the composites, if absent;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;increase J by I;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;increment I;
<br />&#160;&#160;&#160;&#160;sort the composites;
<br />&#160;&#160;&#160;&#160;let the primes be a list of numbers;
<br />&#160;&#160;&#160;&#160;repeat with P running from 2 to N:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;add P to the primes;
<br />&#160;&#160;&#160;&#160;remove the composites from the primes;
<br />&#160;&#160;&#160;&#160;say &quot;Eratosthenes sketches lines in the sand with the air of much practice. 'The primes up to [N] are [the primes]. The composites are [the composites].'&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8649_346" -->
<a id="c8649_346"></a><blockquote class="code"><p class="quoted">
Test me with &quot;sieve 10 / eratosthenes, sieve 100&quot;.
</p></blockquote>
<!-- END CODE -->
<p>While this could all be done more efficiently with an array, that's only because what we are sieving are numbers: sieving is a technique which can be used for non-numerical decisions, too.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
<!-- START EXAMPLE "438: Your Mother Doesn't Work Here" "e449" -->
<a id="e449"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_21.html#e449" class="eglink"><b>438</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_21.html#e449" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Your Mother Doesn't Work Here</span></b></a><br />Your hard-working mother uses a list as a stack: urgent tasks are added to the end of the list, interrupting longer-term plans.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_7.html#e449"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example449">
<p>Suppose the player's mother is supposed to be cleaning the living room, but she can be interrupted by the need to pick up things the player has dropped. New tasks are added to the end of her &quot;current plan&quot; list; every turn, she attempts to do whatever is the last entry on that list.</p>
<!-- START CODE "c8650_449" -->
<a id="c8650_449"></a><blockquote class="code"><p class="quoted">
 &quot;Your Mother Doesn't Work Here&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8651_449" -->
<a id="c8651_449"></a><blockquote class="code"><p class="quoted">
A person has a list of stored actions called the current plan.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8652_449" -->
<a id="c8652_449"></a><blockquote class="code"><p class="quoted">
Every turn:
<br />&#160;&#160;&#160;&#160;repeat with culprit running through people who are not the player:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if the number of entries in current plan of the culprit is greater than 0:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let N be the number of entries in the current plan of the culprit;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;try entry N of the current plan of the culprit;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;remove entry N from the current plan of the culprit.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8653_449" -->
<a id="c8653_449"></a><blockquote class="code"><p class="quoted">
The Living Room is a room. It contains a somewhat muddy Persian rug. Your mother is a woman in the Living Room.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8654_449" -->
<a id="c8654_449"></a><blockquote class="code"><p class="quoted">
West of the Living Room is the Kitchen.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8655_449" -->
<a id="c8655_449"></a><blockquote class="code"><p class="quoted">
Instead of your mother rubbing the rug:
<br />&#160;&#160;&#160;&#160;say &quot;Your mother scrubs the stained areas of the rug, muttering to herself.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8656_449" -->
<a id="c8656_449"></a><blockquote class="code"><p class="quoted">
Instead of taking something:
<br />&#160;&#160;&#160;&#160;say &quot;Nah, Mom'll get that.&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8657_449" -->
<a id="c8657_449"></a><blockquote class="code"><p class="quoted">
Report your mother taking something:
<br />&#160;&#160;&#160;&#160;say &quot;Your mother picks up [the noun][one of], sighing deeply[or], jaw tight[or], with assorted comments on your manners[or]; to judge from her comments, she is also indulging in a pleasant fantasy about Swiss boarding schools[stopping].&quot; instead.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8658_449" -->
<a id="c8658_449"></a><blockquote class="code"><p class="quoted">
When play begins:
<br />&#160;&#160;&#160;&#160;add mother going west to the current plan of mother;
<br />&#160;&#160;&#160;&#160;add mother rubbing the rug to the current plan of mother.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8659_449" -->
<a id="c8659_449"></a><blockquote class="code"><p class="quoted">
Every turn:
<br />&#160;&#160;&#160;&#160;if mother is not in the Living Room, end the story finally.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8660_449" -->
<a id="c8660_449"></a><blockquote class="code"><p class="quoted">
Carry out dropping something:
<br />&#160;&#160;&#160;&#160;add mother taking the noun to the current plan of mother.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8661_449" -->
<a id="c8661_449"></a><blockquote class="code"><p class="quoted">
The player carries some dirty socks, some dirty shoes, a dirty hat, a pair of dirty trousers, and a backpack.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8662_449" -->
<a id="c8662_449"></a><blockquote class="code"><p class="quoted">
Test me with &quot;drop socks / z / drop shoes / drop hat / drop all / z / z&quot;.
</p></blockquote>
<!-- END CODE -->
<p>As goal-seeking goes, this is fairly rudimentary; &quot;Boston Cream&quot; provides an alternative (and slightly more sophisticated approach), but for really complex goal-seeking characters, it is probably best to turn to the character extensions designed for Inform.</p>
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
</body>
</html>
