<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!-- Generated by indoc on 11 Aug 2016 -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="indoc_WI.css" rel="stylesheet" type="text/css" />
<title>Chapter 22: Advanced Phrases</title>
</head>
<body class="paper papertint"><p class="chapterheading">Chapter 22: Advanced Phrases</p>
<p class="chaptercontents"><a href="WI_22.html#s1" class="standardlink"><span class="chaptercontentsitem">§22.1. A review of kinds</span></a>; <a href="WI_22.html#s2" class="standardlink"><span class="chaptercontentsitem">§22.2. Descriptions as values</span></a>; <a href="WI_22.html#s3" class="standardlink"><span class="chaptercontentsitem">§22.3. Phrases as values</span></a>; <a href="WI_22.html#s4" class="standardlink"><span class="chaptercontentsitem">§22.4. Default values for phrase kinds</span></a>; <a href="WI_22.html#s5" class="standardlink"><span class="chaptercontentsitem">§22.5. Map, filter and reduce</span></a>; <a href="WI_22.html#s6" class="standardlink"><span class="chaptercontentsitem">§22.6. Generic phrases</span></a>; <a href="WI_22.html#s7" class="standardlink"><span class="chaptercontentsitem">§22.7. Kind variables</span></a>; <a href="WI_22.html#s8" class="standardlink"><span class="chaptercontentsitem">§22.8. Matching the names of kinds</span></a>; <a href="WI_22.html#s9" class="standardlink"><span class="chaptercontentsitem">§22.9. In what order?</span></a>; <a href="WI_22.html#s10" class="standardlink"><span class="chaptercontentsitem">§22.10. Ambiguities</span></a></p><table class="centredtable"><tr><td class="roadsigndirection"><a href="WI_1.html" class="standardlink"><img alt="arrow-up-left.png" src="images/arrow-up-left.png" /></a></td><td><a href="WI_1.html" class="standardlink">Contents of <i>Writing with Inform</i></a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_21.html" class="standardlink">Chapter 21: Lists</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_23.html" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_23.html" class="standardlink">Chapter 23: Figures, Sounds and Files</a></td></tr>
<tr><td class="roadsigndirection"><a href="examples_alphabetical.html" class="standardlink"><img alt="arrow-down-right.png" src="images/arrow-down-right.png" /></a></td><td><a href="examples_alphabetical.html" class="standardlink">Indexes of the examples</a></td></tr>
</table><p class="sectionheading"><a id="s1"></a>§22.1. A review of kinds</p>
<p>Most of the time, what's created in an Inform source text will have a name which can be used as a value - sometimes openly so, sometimes not. In this book, we haven't gone out of our way to make that point, because there was no real need to do so. It's possible to make heavy use of rulebooks and write large-scale Inform projects without ever needing to use a rulebook's name as a value in its own right, for example. But if we want to create sophisticated extensions to Inform, or to use modern techniques such as functional and generic programming, we need to be fluent in the language of kinds.</p>
<p>Inform's language of kinds has four ingredients: base kinds, constructions, kind variables and kinds of kinds.</p>
<p><span class="boldface">1. Base kinds.</span> Inform provides the following base kinds for values:</p>
<!-- START CODE "c8663" -->
<a id="c8663"></a><blockquote class="code"><p class="quoted">
object, number, real number, time, truth state, text, snippet, Unicode character, action, scene, table name, equation name, use option, action name, figure name, sound name, external file, rulebook outcome, parser error
</p></blockquote>
<!-- END CODE -->
<p>together with a few others, such as &quot;response&quot; and &quot;verb&quot;, to do with linguistic features.</p>
<p>And Inform allows us to create new base kinds either by making more specialised kinds of object:</p>
<!-- START CODE "c8664" -->
<a id="c8664"></a><blockquote class="code"><p class="quoted">
A geographical layout is a kind of object.
<br />A marmoset is a kind of animal.
</p></blockquote>
<!-- END CODE -->
<p>Or by making new enumerations or arithmetical kinds:</p>
<!-- START CODE "c8665" -->
<a id="c8665"></a><blockquote class="code"><p class="quoted">
Distance is a kind of value. 10km specifies a distance.
<br />Colour is a kind of value. Red, green and blue are colours.
</p></blockquote>
<!-- END CODE -->
<p><span class="boldface">2. Constructions.</span> These are ways to make new kinds from existing ones.  The construction most often used is &quot;list of...&quot;. For any kind K, there is a kind called list of K. So the range of possible kinds in Inform is actually infinite, because:</p>
<!-- START CODE "c8666" -->
<a id="c8666"></a><blockquote class="code"><p class="quoted">
number
<br />list of numbers
<br />list of lists of numbers
<br />list of lists of lists of numbers
<br />...
</p></blockquote>
<!-- END CODE -->
<p>are all different from each other. Inform has nine constructions, as follows:</p>
<!-- START CODE "c8667" -->
<a id="c8667"></a><blockquote class="code"><p class="quoted">
list of K
<br />description of K
<br />relation of K to L
<br />K based rule producing L
<br />K based rulebook producing L
<br />activity on K
<br />phrase K -&gt; L
<br />K valued property
<br />K valued table column
</p></blockquote>
<!-- END CODE -->
<p>Some of these have appeared in previous chapters, but in abbreviated form. For example, &quot;rulebook&quot; abbreviates &quot;action based rulebook producing nothing&quot;, and &quot;either/or property&quot; is a synonym for &quot;truth state valued property&quot;. The kinds of descriptions and phrases haven't been covered yet, but are coming up in the sections following.</p>
<p>These constructions can of course be combined:</p>
<!-- START CODE "c8668" -->
<a id="c8668"></a><blockquote class="code"><p class="quoted">
phrase (relation of numbers to colours, number) -&gt; list of colours
</p></blockquote>
<!-- END CODE -->
<p>Brackets can be used to clarify matters:</p>
<!-- START CODE "c8669" -->
<a id="c8669"></a><blockquote class="code"><p class="quoted">
phrase (phrase number -&gt; (phrase number -&gt; number)) -&gt; nothing
</p></blockquote>
<!-- END CODE -->
<p>Nothing will make that a simple idea, but it's unambiguous and can be puzzled out with practice.</p>
<p><span class="boldface">3. Variables.</span> In a way, that's everything: there are just base kinds and constructions on them, and those construct every possible kind in Inform. But the language we use to describe kinds is larger than that, because it allows us to describe many kinds at once, in the same way that Inform reads the word &quot;something&quot; as applying to many objects at once, not as a single object.</p>
<p>Kind variables will be covered later in the chapter, but the idea is that:</p>
<!-- START CODE "c8670" -->
<a id="c8670"></a><blockquote class="code"><p class="quoted">
To hunt for (needle - value of kind K) in (haystack - list of Ks): ...
</p></blockquote>
<!-- END CODE -->
<p>allows us to describe the kinds acceptable in a phrase so that a wide range of possibilities are allowed. The above matches both:</p>
<!-- START CODE "c8671" -->
<a id="c8671"></a><blockquote class="code"><p class="quoted">
hunt for 4 in { 2, 3, 4, 5 };
<br />hunt for &quot;fish&quot; in { &quot;lemon sauce&quot;, &quot;fish&quot;, &quot;garden peas&quot; };
</p></blockquote>
<!-- END CODE -->
<p>The letter K in the definition stood for any kind; in the first use of &quot;hunt&quot; here, K turned out to be &quot;number&quot;, and in the second it was &quot;text&quot;. On the other hand Inform would reject:</p>
<!-- START CODE "c8672" -->
<a id="c8672"></a><blockquote class="code"><p class="quoted">
hunt for 4 in { containment relation, support relation };
</p></blockquote>
<!-- END CODE -->
<p>because there is no kind K which can make this match the definition.</p>
<p>There are potentially 26 kind variables, A to Z, though it's customary to use them in the order K, L, M, ..., and it's very rare to need more than two at a time.</p>
<p><span class="boldface">4. Kinds of kind.</span> Inform understands several names which look as if they are kinds, but actually aren't:</p>
<!-- START CODE "c8673" -->
<a id="c8673"></a><blockquote class="code"><p class="quoted">
value, arithmetic value, enumerated value, sayable value
</p></blockquote>
<!-- END CODE -->
<p>(Again, these are built in to Inform.) They are not kinds because they're just too loose and vague. Instead, they can be used in phrase definitions to match against multiple possibilities:</p>
<!-- START CODE "c8674" -->
<a id="c8674"></a><blockquote class="code"><p class="quoted">
To announce (X - sayable value): say &quot;I declare that [X] has arrived.&quot;
</p></blockquote>
<!-- END CODE -->
<p>This makes &quot;announce X&quot; work for any value X which can be said. All the same, &quot;sayable value&quot; is not a kind. It could never be safe for this to be the kind of a variable, because Inform would never know what could be done with the contents (except that it could be printed out).</p>
<p><span class="boldface">5. Secret inner workings.</span> There isn't a fifth ingredient, but if there were, it would be a handful of names used in matching some of the core built-in phrases of Inform which have so-called inline I6 definitions. These are not intended for anyone else to use, and are just an internal convenience; they aren't publicly documented and might change without notice. They don't describe kinds at all, because they tell the matcher to look for something else instead. For instance, there's one called &quot;condition&quot;, which means &quot;match a condition rather than a value&quot;. They appear in red ink in the Phrasebook index.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_22.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_22.html" class="standardlink">Start of Chapter 22: Advanced Phrases</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_21.html#s11" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_21.html#s11" class="standardlink">Back to Chapter 21: Lists: §21.11. Variations: arrays, logs, queues, stacks, sets, sieves and rings</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s2" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_22.html#s2" class="standardlink">Onward to §22.2. Descriptions as values</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s2"></a>§22.2. Descriptions as values</p>
<p>In the chapter on Descriptions, we saw that a description can be any source text which describes one or more objects: it might be as simple as &quot;the Corn Market&quot;, or as complicated as &quot;open containers which are in dark rooms&quot;. More or less the only restriction is that it must be unambiguous as to what counts and what does not: &quot;three containers&quot; is ambiguous as a description because it does not say which three.</p>
<p>We've now seen several interesting tricks with descriptions. In fact, if D is a description, then</p>
<!-- START CODE "c8675" -->
<a id="c8675"></a><blockquote class="code"><p class="quoted">
say &quot;You gaze mournfully at [the list of D].&quot;;
<br />let the tally be the number of D;
<br />let the surprise prize be a random D;
<br />repeat with item running through D:
<br />&#160;&#160;&#160;&#160;...
</p></blockquote>
<!-- END CODE -->
<p>are all standard things to do. These examples make it look as if it must be possible to define phrases which act on descriptions, and in fact it is, because a description can be a value in itself. For example,</p>
<!-- START CODE "c8676" -->
<a id="c8676"></a><blockquote class="code"><p class="quoted">
even numbers
<br />open containers which are in dark rooms
</p></blockquote>
<!-- END CODE -->
<p>are values of kind &quot;description of numbers&quot; and &quot;description of objects&quot; respectively. In general, if K is any kind then &quot;description of K&quot; is also a kind. Here is how we might make use of that:</p>
<!-- START CODE "c8677" -->
<a id="c8677"></a><blockquote class="code"><p class="quoted">
To enumerate (collection - a description of objects):
<br />&#160;&#160;&#160;&#160;repeat with the item running through the collection:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;-- [The item].&quot;
</p></blockquote>
<!-- END CODE -->
<p>This makes &quot;enumerate lighted rooms&quot; run off a list of lighted rooms in a textual format different from the standard one produced by &quot;say the list of lighted rooms&quot;. Inside the definition, &quot;collection&quot; can be used wherever a description might be used: here, for instance, we use it as the range for the repeat loop. (That's only possible because the range is limited in size: Inform wouldn't have allowed us to range through, say, all texts.)</p>
<p>Purely as a convenience, we can also write &quot;member of&quot; or &quot;members of&quot; in this context. For instance, in the enumerate definition, it would have been just as good to write &quot;...running through the members of the collection...&quot; in the repeat. (Similarly, we could write &quot;number of members of the collection&quot; or &quot;a random member of the collection&quot;, which looks grammatically tidier than writing &quot;number of the collection&quot; or &quot;random of the collection&quot; - though in fact both of these do work.)</p>
<p>Finally, it's sometimes useful in an abstract situation to test</p>
<!-- START PHRASE "defn353" -->
<div class="definition"><a id="defn353"></a><p class="defnprototype"><b>if </b>(value)<b> matches </b>(description of values)<b>:</b></p>
<!-- END PHRASE -->
<!-- definition of ph_valuematch -->

<p>This condition is true if the value matches the description; the kinds must be compatible, or Inform will issue a problem message. There is no point using this for cases where the description is given explicitly:</p>
<!-- START CODE "c8678" -->
<a id="c8678"></a><blockquote class="code"><p class="quoted">
if 4 matches even numbers, ...
</p></blockquote>
<!-- END CODE -->
<p>because it is easier to write just:</p>
<!-- START CODE "c8679" -->
<a id="c8679"></a><blockquote class="code"><p class="quoted">
if 4 is an even number, ...
</p></blockquote>
<!-- END CODE -->
<p>So this condition is only useful when the description is stored in some variable, and its identity is not known.</p>

<!-- end definition -->
</div>

<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_22.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_22.html" class="standardlink">Start of Chapter 22: Advanced Phrases</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s1" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_22.html#s1" class="standardlink">Back to §22.1. A review of kinds</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s3" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_22.html#s3" class="standardlink">Onward to §22.3. Phrases as values</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#e100" class="standardlink"><img alt="arrow-down.png" src="images/arrow-down.png" /></a></td><td><a href="WI_22.html#e100" class="standardlink">Example 439: <img class="asterisk" alt="*" src="images/asterisk.png" /> <b>Curare</b>&#160;&#160;&#160; A phrase that chooses and names the least-recently selected item from the collection given, allowing the text to cycle semi-randomly through a group of objects.</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s3"></a>§22.3. Phrases as values</p>
<p>Given any two kinds K and L, the kind &quot;phrase K -&gt; L&quot; is now a kind. (This is meant to look like a mathematical function arrow.) For example, the phrase defined by</p>
<!-- START CODE "c8680" -->
<a id="c8680"></a><blockquote class="code"><p class="quoted">
To decide which number is the square of (N - a number): ...
</p></blockquote>
<!-- END CODE -->
<p>has the kind &quot;phrase number -&gt; number&quot;. Brackets and commas are used if the phrase combines several values, so</p>
<!-- START CODE "c8681" -->
<a id="c8681"></a><blockquote class="code"><p class="quoted">
To decide which text is (T - text) repeated (N - a number) times: ...
</p></blockquote>
<!-- END CODE -->
<p>has the kind &quot;phrase (text, number) -&gt; text&quot;. The word &quot;nothing&quot; is used if there are no values in, or no value out - thus</p>
<!-- START CODE "c8682" -->
<a id="c8682"></a><blockquote class="code"><p class="quoted">
To decide which number is the magic target: ...
</p></blockquote>
<!-- END CODE -->
<p>has kind &quot;phrase nothing -&gt; number&quot;, and</p>
<!-- START CODE "c8683" -->
<a id="c8683"></a><blockquote class="code"><p class="quoted">
To dig (eastward - length) by (northward - length): ...
</p></blockquote>
<!-- END CODE -->
<p>has the kind &quot;phrase (length, length) -&gt; nothing&quot;.</p>
<p>But how are we to get at these values? The answer is that we need to give a phrase a name in order to do so. For example:</p>
<!-- START CODE "c8684" -->
<a id="c8684"></a><blockquote class="code"><p class="quoted">
To decide what number is double (N - a number) (this is doubling):
<br />&#160;&#160;&#160;&#160;decide on N plus N.
</p></blockquote>
<!-- END CODE -->
<p>This is the same syntax used to name rules, and the idea is the same. If we</p>
<p>try &quot;showme doubling&quot;, the result is</p>
<!-- START CODE "c8685" -->
<a id="c8685"></a><blockquote class="code"><p class="quoted">
phrase number -&gt; number: doubling
</p></blockquote>
<!-- END CODE -->
<p>The main thing we want to do with a phrase is to apply it. So:</p>
<!-- START CODE "c8686" -->
<a id="c8686"></a><blockquote class="code"><p class="quoted">
showme doubling applied to 2;
</p></blockquote>
<!-- END CODE -->
<p>produces</p>
<!-- START CODE "c8687" -->
<a id="c8687"></a><blockquote class="code"><p class="quoted">
&quot;doubling applied to 2&quot; = number: 4
</p></blockquote>
<!-- END CODE -->
<p>There are versions of &quot;applied to&quot; for phrases applied to 0 to 3 values:</p>
<!-- START PHRASE "defn354" -->
<div class="definition"><a id="defn354"></a><p class="defnprototype"><b></b>(phrase nothing -&gt; value)<b> applied ... value</b></p>
<!-- END PHRASE -->
<!-- definition of ph_applied0 -->

<p>This phrase produces the result of applying the given phrase, which must be one which takes no values itself.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn355" -->
<div class="definition"><a id="defn355"></a><p class="defnprototype"><b></b>(phrase value -&gt; value)<b> applied to </b>(value)<b> ... value</b></p>
<!-- END PHRASE -->
<!-- definition of ph_applied1 -->

<p>This phrase produces the result of applying the given phrase, which must be one which takes one value itself.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn356" -->
<div class="definition"><a id="defn356"></a><p class="defnprototype"><b></b>(phrase (value, value) -&gt; value)<b> applied to </b>(value)<b> and </b>(value)<b> ... value</b></p>
<!-- END PHRASE -->
<!-- definition of ph_applied2 -->

<p>This phrase produces the result of applying the given phrase, which must be one which takes two values itself.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn357" -->
<div class="definition"><a id="defn357"></a><p class="defnprototype"><b></b>(phrase (value, value, value) -&gt; value)<b> applied to </b>(value)<b> and </b>(value)<b> and </b>(value)<b> ... value</b></p>
<!-- END PHRASE -->
<!-- definition of ph_applied3 -->

<p>This phrase produces the result of applying the given phrase, which must be one which takes three values itself.</p>

<!-- end definition -->
</div>

<p>So for example:</p>
<!-- START CODE "c8688" -->
<a id="c8688"></a><blockquote class="code"><p class="quoted">
F applied
<br />F applied to V
<br />F applied to V and W
<br />F applied to V and W and X
</p></blockquote>
<!-- END CODE -->
<p>For phrases which do not produce a value, we use &quot;apply&quot;:</p>
<!-- START PHRASE "defn358" -->
<div class="definition"><a id="defn358"></a><p class="defnprototype"><b>apply </b>(phrase nothing -&gt; nothing)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_apply0 -->

<p>This phrase causes the given phrase to be applied. It must be one which takes no values itself.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn359" -->
<div class="definition"><a id="defn359"></a><p class="defnprototype"><b>apply </b>(phrase value -&gt; nothing)<b> to </b>(value)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_apply1 -->

<p>This phrase causes the given phrase to be applied. It must be one which takes one value itself.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn360" -->
<div class="definition"><a id="defn360"></a><p class="defnprototype"><b>apply </b>(phrase (value, value) -&gt; nothing)<b> to </b>(value)<b> and </b>(value)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_apply2 -->

<p>This phrase causes the given phrase to be applied. It must be one which takes two values itself.</p>

<!-- end definition -->
</div>

<!-- START PHRASE "defn361" -->
<div class="definition"><a id="defn361"></a><p class="defnprototype"><b>apply </b>(phrase (value, value, value) -&gt; nothing)<b> to </b>(value)<b> and </b>(value)<b> and </b>(value)<b></b></p>
<!-- END PHRASE -->
<!-- definition of ph_apply3 -->

<p>This phrase causes the given phrase to be applied. It must be one which takes three values itself.</p>

<!-- end definition -->
</div>

<p>Thus:</p>
<!-- START CODE "c8689" -->
<a id="c8689"></a><blockquote class="code"><p class="quoted">
apply F;
<br />apply F to V;
<br />apply F to V and W;
<br />apply F to V and W and X;
</p></blockquote>
<!-- END CODE -->
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_22.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_22.html" class="standardlink">Start of Chapter 22: Advanced Phrases</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s2" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_22.html#s2" class="standardlink">Back to §22.2. Descriptions as values</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s4" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_22.html#s4" class="standardlink">Onward to §22.4. Default values for phrase kinds</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s4"></a>§22.4. Default values for phrase kinds</p>
<p>The default value for &quot;phrase K -&gt; nothing&quot; is a phrase which does nothing. For example, if we write:</p>
<!-- START CODE "c8690" -->
<a id="c8690"></a><blockquote class="code"><p class="quoted">
let S be a phrase numbers -&gt; nothing;
</p></blockquote>
<!-- END CODE -->
<p>then S is created holding the default phrase numbers -&gt; nothing, and if we then try it out with:</p>
<!-- START CODE "c8691" -->
<a id="c8691"></a><blockquote class="code"><p class="quoted">
apply S to 17;
</p></blockquote>
<!-- END CODE -->
<p>we will indeed find that nothing happens.</p>
<p>The default value for &quot;phrase K -&gt; L&quot; is a phrase which, no matter what value of K it applies to, always produces the default value of L. (It's a sort of equivalent of the zero function in mathematics - indeed that's exactly what it is, if L is &quot;number&quot;.) So:</p>
<!-- START CODE "c8692" -->
<a id="c8692"></a><blockquote class="code"><p class="quoted">
let Q be a phrase numbers -&gt; times;
<br />showme Q;
<br />showme Q applied to 4;
<br />showme Q applied to -7;
</p></blockquote>
<!-- END CODE -->
<p>produces:</p>
<!-- START CODE "c8693" -->
<a id="c8693"></a><blockquote class="code"><p class="quoted">
&quot;q&quot; = phrase number -&gt; time: default value of phrase number -&gt; time
<br />&quot;q applied to 4&quot; = time: 9:00 am
<br />&quot;q applied to -7&quot; = time: 9:00 am
</p></blockquote>
<!-- END CODE -->
<p>Here Q is set to the default phrase because we didn't give it any other value; it has the name we might expect (&quot;default value of phrase number -&gt; time&quot;) and it works as advertised, producing 9:00 am no matter what number is fed in.</p>
<p>More ambitiously, and supposing that we have a kind called &quot;colour&quot; whose first possible value is &quot;red&quot;:</p>
<!-- START CODE "c8694" -->
<a id="c8694"></a><blockquote class="code"><p class="quoted">
let R be a phrase numbers -&gt; (phrase numbers -&gt; colours);
<br />showme R;
<br />showme R applied to 3;
<br />showme (R applied to 3) applied to 2;
</p></blockquote>
<!-- END CODE -->
<p>produces:</p>
<!-- START CODE "c8695" -->
<a id="c8695"></a><blockquote class="code"><p class="quoted">
&quot;r&quot; = phrase number -&gt; (phrase number -&gt; colour): default value of phrase
<br />number -&gt; (phrase number -&gt; colour)
<br />&quot;r applied to 3&quot; = phrase number -&gt; colour: default value of phrase number
<br />-&gt; colour
<br />&quot;( r applied to 3 ) applied to 2&quot; = colour: red
</p></blockquote>
<!-- END CODE -->
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_22.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_22.html" class="standardlink">Start of Chapter 22: Advanced Phrases</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s3" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_22.html#s3" class="standardlink">Back to §22.3. Phrases as values</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s5" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_22.html#s5" class="standardlink">Onward to §22.5. Map, filter and reduce</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s5"></a>§22.5. Map, filter and reduce</p>
<p>When a mass of computations has to be done, the traditional approach is to work through them in a &quot;repeat&quot; loop. One modern alternative, growing in popularity, is to form a list of inputs; then apply the same computation to each input in turn to form a list of results (this is called &quot;mapping&quot;); throw out any bad or unwanted results (&quot;filtering&quot;); and then combine the surviving results into a single composite answer (&quot;reducing&quot;, though some programming languages call this &quot;folding&quot; or &quot;accumulation&quot;; it's a much-reinvented idea).</p>
<p>Inform provides all three of these fundamental list-processing operations. There is no special term for a &quot;map&quot;, because Inform treats it as another case of &quot;applied to&quot;.</p>
<!-- START PHRASE "defn362" -->
<div class="definition"><a id="defn362"></a><p class="defnprototype"><b></b>(phrase value -&gt; value)<b> applied to </b>(list of values)<b> ... value</b></p>
<!-- END PHRASE -->
<!-- definition of ph_appliedlist -->

<p>This phrase takes the list, applies the phrase to each entry in the list, and forms a new list of the result. Example:</p>
<!-- START CODE "c8696" -->
<a id="c8696"></a><blockquote class="code"><p class="quoted">
To decide what number is double (N - a number) (this is doubling):
<br />&#160;&#160;&#160;&#160;decide on N plus N.
</p></blockquote>
<!-- END CODE -->
<p>Then &quot;doubling applied to 2&quot; produces 4, by the simpler definition of &quot;applied to&quot;, but also:</p>
<!-- START CODE "c8697" -->
<a id="c8697"></a><blockquote class="code"><p class="quoted">
doubling applied to {2, 3, 4}
</p></blockquote>
<!-- END CODE -->
<p>produces the list {4, 6, 8}.</p>

<!-- end definition -->
</div>

<p>More divertingly, suppose we define:</p>
<!-- START CODE "c8698" -->
<a id="c8698"></a><blockquote class="code"><p class="quoted">
To decide what text is the longhand form of (N - a number)
<br />&#160;&#160;&#160;&#160;(this is spelling out):
<br />&#160;&#160;&#160;&#160;decide on &quot;[N in words]&quot;.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8699" -->
<a id="c8699"></a><blockquote class="code"><p class="quoted">
To decide what text is the consonant form of (T - text)
<br />&#160;&#160;&#160;&#160;(this is txtng):
<br />&#160;&#160;&#160;&#160;replace the regular expression &quot;&lt;aeiou&gt;&quot; in T with &quot;&quot;;
<br />&#160;&#160;&#160;&#160;decide on T.
</p></blockquote>
<!-- END CODE -->
<p>Then we can write a chain of three maps in succession:</p>
<!-- START CODE "c8700" -->
<a id="c8700"></a><blockquote class="code"><p class="quoted">
txtng applied to spelling out applied to doubling applied to {3, 8, 4, 19, 7}
</p></blockquote>
<!-- END CODE -->
<p>to produce the value {&quot;sx&quot;, &quot;sxtn&quot;, &quot;ght&quot;, &quot;thrty-ght&quot;, &quot;frtn&quot;}.</p>
<p>Next, filtering. Here we make use of descriptions, in order to say what values will be allowed through the filter. So:</p>
<!-- START PHRASE "defn363" -->
<div class="definition"><a id="defn363"></a><p class="defnprototype"><b>filter to </b>(description of values)<b> of </b>(list of values)<b> ... value</b></p>
<!-- END PHRASE -->
<!-- definition of ph_filter -->

<p>This phrase produces a new list which is a thinner version of the one given, so that it contains only those values which match the description given. Example:</p>
<!-- START CODE "c8701" -->
<a id="c8701"></a><blockquote class="code"><p class="quoted">
filter to even numbers of {3, 8, 4, 19, 7}
</p></blockquote>
<!-- END CODE -->
<p>produces {8, 4}, with the values 3, 19, and 7 failing to make it through. A sufficiently fine filter may well thin out a list to a single entry, or even no entries at all, but the result is always a list.</p>

<!-- end definition -->
</div>

<p>To get the full effect of filtering, we probably need to define an adjective or two. For example:</p>
<!-- START CODE "c8702" -->
<a id="c8702"></a><blockquote class="code"><p class="quoted">
Definition: a text (called T) is lengthy if the number of characters in it is greater than 6.
</p></blockquote>
<!-- END CODE -->
<p>We can then write:</p>
<!-- START CODE "c8703" -->
<a id="c8703"></a><blockquote class="code"><p class="quoted">
filter to lengthy texts of spelling out applied to {15, 2, 20, 29, -4}
</p></blockquote>
<!-- END CODE -->
<p>which produces {&quot;fifteen&quot;, &quot;twenty-nine&quot;, &quot;minus four&quot;}.</p>
<p>Lastly, reduction. In order to combine a whole list of values, we need a phrase to combine any two. Here are some samples:</p>
<!-- START CODE "c8704" -->
<a id="c8704"></a><blockquote class="code"><p class="quoted">
To decide what number is the larger of (N - number) and (M - number)
<br />&#160;&#160;&#160;&#160;(this is maximizing):
<br />&#160;&#160;&#160;&#160;if N &gt; M, decide on N;
<br />&#160;&#160;&#160;&#160;decide on M.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8705" -->
<a id="c8705"></a><blockquote class="code"><p class="quoted">
To decide what text is the concatenation of (X - text) and (Y - text)
<br />&#160;&#160;&#160;&#160;(this is concatenation):
<br />&#160;&#160;&#160;&#160;decide on &quot;[X][Y]&quot;.
</p></blockquote>
<!-- END CODE -->
<p>And here are some sample reductions:</p>
<!-- START CODE "c8706" -->
<a id="c8706"></a><blockquote class="code"><p class="quoted">
let X be the maximization reduction of {3, 8, 4, 19, 7};
<br />let Y be the concatenation reduction of txtng applied to spelling out
<br />&#160;&#160;&#160;&#160;applied to doubling applied to {3, 8, 4, 19, 7};
</p></blockquote>
<!-- END CODE -->
<p>sets X to 19, the highest of the values, and Y to the text &quot;sxsxtnghtthrty-ghtfrtn&quot;. In each case a list has been reduced to a single value which somehow combines the contents.</p>
<!-- START PHRASE "defn364" -->
<div class="definition"><a id="defn364"></a><p class="defnprototype"><b></b>(phrase (value, value) -&gt; value)<b> reduction of </b>(list of values)<b> ... value</b></p>
<!-- END PHRASE -->
<!-- definition of ph_reduction -->

<p>This phrase works through the list and accumulates the values in it, using the phrase supplied. Example: if we have</p>
<!-- START CODE "c8707" -->
<a id="c8707"></a><blockquote class="code"><p class="quoted">
To decide what number is the sum of (N - number) and (M - number)
<br />&#160;&#160;&#160;&#160;(this is summing):
<br />&#160;&#160;&#160;&#160;decide on N + M.
</p></blockquote>
<!-- END CODE -->
<p>then the summing reduction of {3, 8, 4, 19, 7} is the number 41, obtained by</p>
<!-- START CODE "c8708" -->
<a id="c8708"></a><blockquote class="code"><p class="quoted">
(((3 + 8) + 4) + 19) + 7
</p></blockquote>
<!-- END CODE -->
<p>so that the summing phrase has been used four times.</p>

<!-- end definition -->
</div>

<p>Is map/filter/reduce always a good idea? Devotees point out that almost any computation can be thought of in this way, and in systems where the work has to be distributed around multiple processors it can be a very powerful tool. (There are programming languages without loops where it's essentially the only tool.) At its best, it reads very elegantly: one assembles all of the tools needed - definitions of doubling, lengthy, spelling out, concatenation and so on - and then each actual task is expressed in a single line at the end.</p>
<p>On the other hand, there are also times when this is a needlessly complicated disguise for what could more easily be done with a &quot;repeat&quot; loop, and also more efficiently since assembling and dismantling lists in memory does take some overhead time. So these list operations are not a panacea, but it's good to have them available.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_22.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_22.html" class="standardlink">Start of Chapter 22: Advanced Phrases</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s4" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_22.html#s4" class="standardlink">Back to §22.4. Default values for phrase kinds</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s6" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_22.html#s6" class="standardlink">Onward to §22.6. Generic phrases</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s6"></a>§22.6. Generic phrases</p>
<p>The following looks quite innocent:</p>
<!-- START CODE "c8709" -->
<a id="c8709"></a><blockquote class="code"><p class="quoted">
To say (V - value) twice: say &quot;[V]. [V], I say!&quot;
</p></blockquote>
<!-- END CODE -->
<p>It's clear at a glance what this is intended to do, but at a second glance things aren't so straightforward. &quot;Value&quot; is not itself a kind - it's too big and unspecific. For instance, if we were to allow a variable to be just &quot;a value&quot;, we could freely set it to 12 one minute and to &quot;dahlias&quot; the next, and such a variable would be dangerous since we would never know what could safely be done with its contents. A phrase like this one is called &quot;generic&quot;, because it's not so much a single, actual phrase as a recipe to make phrases. (Inform automatically works out which kinds we need the phrase for, and creates a version of the phrase for those kinds.)</p>
<p>So &quot;value&quot; is not a kind, but a kind of kind. Inform has several of these:</p>
<!-- START CODE "c8710" -->
<a id="c8710"></a><blockquote class="code"><p class="quoted">
value, arithmetic value, enumerated value, sayable value
</p></blockquote>
<!-- END CODE -->
<p>These act as ways to say &quot;a value of any kind matching this can go here&quot;. For example, &quot;value&quot; is a way to say &quot;any kind at all&quot;; &quot;arithmetic value&quot; is any kind which arithmetic can be performed on (any kind with the little calculator icon in the Arithmetic part of the Kinds index); and so on. If we write:</p>
<!-- START CODE "c8711" -->
<a id="c8711"></a><blockquote class="code"><p class="quoted">
To double (V - arithmetic value): say &quot;[V times 2].&quot;
</p></blockquote>
<!-- END CODE -->
<p>the restriction to &quot;arithmetic value&quot; means that although &quot;double 3&quot;, &quot;double 6 kg&quot;, etc., would be matched, &quot;double the Entire Game&quot; would not - you can't perform arithmetic on scenes. Similarly, it would have been tidier to write:</p>
<!-- START CODE "c8712" -->
<a id="c8712"></a><blockquote class="code"><p class="quoted">
To say (V - sayable value) twice: say &quot;[V]. [V], I say!&quot;
</p></blockquote>
<!-- END CODE -->
<p>because then Inform will make it clearer why &quot;say X twice&quot; won't work if X is one of those rare values which it can't say (an activity, for instance).</p>
<p>The Kinds index shows which kinds match against which of these &quot;kinds of kind&quot;. For instance, it shows that &quot;time&quot;</p>
<!-- START CODE "c8713" -->
<a id="c8713"></a><blockquote class="code"><p class="quoted">
Matches: value, arithmetic value, sayable value
</p></blockquote>
<!-- END CODE -->
<p>which means that time is something we can do arithmetic on, and can say.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_22.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_22.html" class="standardlink">Start of Chapter 22: Advanced Phrases</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s5" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_22.html#s5" class="standardlink">Back to §22.5. Map, filter and reduce</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s7" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_22.html#s7" class="standardlink">Onward to §22.7. Kind variables</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s7"></a>§22.7. Kind variables</p>
<p>The examples of generic phrases in the previous section were really only toy examples. Suppose we want a phrase which will take any arithmetic value and triple it. We could do something like this:</p>
<!-- START CODE "c8714" -->
<a id="c8714"></a><blockquote class="code"><p class="quoted">
To triple (V - arithmetic value): say &quot;[V times 3].&quot;
</p></blockquote>
<!-- END CODE -->
<p>But this only prints the answer. Suppose we want to be given the value back, instead: how can we write the phrase? The trouble is that, not knowing the kind of V, we can't say what kind will be produced. We need a way of saying &quot;the same kind comes out as went in&quot;. Inform expresses that using kind variables:</p>
<!-- START CODE "c8715" -->
<a id="c8715"></a><blockquote class="code"><p class="quoted">
To decide which K is triple (original - arithmetic value of kind K):
<br />&#160;&#160;&#160;&#160;decide on 3 times the original.
</p></blockquote>
<!-- END CODE -->
<p>Here, K stands for any kind which matches &quot;arithmetic value&quot;. Inform supports exactly 26 of these symbols, which are written A to Z, but it's customary to use K and L. (They can be written in the plural if we like: e.g., &quot;list of Ks&quot;. But they must always use a capital letter: &quot;list of k&quot; is not allowed.)</p>
<p>Each symbol we use has to be declared in exactly one of the bracketed ingredients for the phrase - here, the declaration is &quot;arithmetic value of kind K&quot;. That creates K and says that it has to be arithmetic; if we'd just said &quot;value of kind K&quot;, it could have been anything. (Alternatively, we could use any of the kinds of kind in the previous section.)</p>
<p>For a more ambitious example, here is one way to define the mapping operation described earlier in the chapter:</p>
<!-- START CODE "c8716" -->
<a id="c8716"></a><blockquote class="code"><p class="quoted">
To decide what list of L is (function - phrase K -&gt; value of kind L)
<br />&#160;&#160;&#160;&#160;applied to (original list - list of values of kind K):
<br />&#160;&#160;&#160;&#160;let the result be a list of Ls;
<br />&#160;&#160;&#160;&#160;repeat with item running through the original list:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;let the mapped item be the function applied to the item;
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;add the mapped item to the result;
<br />&#160;&#160;&#160;&#160;decide on the result.
</p></blockquote>
<!-- END CODE -->
<p>Here we need two symbols to explain the complicated way that the values going in and out have to match up to each other. Note also the way that the temporary variable &quot;result&quot; is created:</p>
<!-- START CODE "c8717" -->
<a id="c8717"></a><blockquote class="code"><p class="quoted">
let the result be a list of Ls;
</p></blockquote>
<!-- END CODE -->
<p>Ordinarily, of course, &quot;L&quot; is not a kind. But within the body of a phrase definition, it means whatever kind L matched against.</p>
<p>When a symbol occurs several times in the same definition, subtle differences can arise according to which appearance is the declaration. These are not quite the same:</p>
<!-- START CODE "c8718" -->
<a id="c8718"></a><blockquote class="code"><p class="quoted">
To hunt for (V - value of kind K) in (L - list of Ks): ...
<br />To hunt for (V - K) in (L - list of values of kind K): ...
</p></blockquote>
<!-- END CODE -->
<p>The difference arises - though very rarely - if V has some different kind compared to the list entries, but which can be used as if it were of that kind. For example,</p>
<!-- START CODE "c8719" -->
<a id="c8719"></a><blockquote class="code"><p class="quoted">
hunt for the player's command in {&quot;take all&quot;, &quot;wait&quot;};
</p></blockquote>
<!-- END CODE -->
<p>Here V is a snippet, but L is a list of texts; and a snippet can be used in place of a text, but not vice versa. So this will match the second definition, because K is set to &quot;text&quot;, but it won't match the first, where K is set to &quot;snippet&quot;.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_22.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_22.html" class="standardlink">Start of Chapter 22: Advanced Phrases</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s6" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_22.html#s6" class="standardlink">Back to §22.6. Generic phrases</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s8" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_22.html#s8" class="standardlink">Onward to §22.8. Matching the names of kinds</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s8"></a>§22.8. Matching the names of kinds</p>
<p>Sometimes a phrase needs to know what kind it's to work on, but isn't going to be given any particular value of it. For example:</p>
<!-- START CODE "c8720" -->
<a id="c8720"></a><blockquote class="code"><p class="quoted">
To assay (name of kind of value K):
<br />&#160;&#160;&#160;&#160;repeat with item running through Ks:
<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;say &quot;There's [item].&quot;;
<br />&#160;&#160;&#160;&#160;say &quot;But the default is [default value of K].&quot;;
</p></blockquote>
<!-- END CODE -->
<p>Note that there's no hyphen, and no name for the bracketed token - it only sets K. We can then have, say:</p>
<!-- START CODE "c8721" -->
<a id="c8721"></a><blockquote class="code"><p class="quoted">
assay colours;
<br />assay vehicles;
</p></blockquote>
<!-- END CODE -->
<p>But &quot;assay texts&quot; would throw a problem message, because we can't repeat through all possible texts. For a different reason,</p>
<!-- START CODE "c8722" -->
<a id="c8722"></a><blockquote class="code"><p class="quoted">
assay open doors;
</p></blockquote>
<!-- END CODE -->
<p>would not be allowed - &quot;open doors&quot; is a description which applies to some doors and not others; it isn't a kind. It would make no sense to talk about &quot;default value of open door&quot;, for example.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_22.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_22.html" class="standardlink">Start of Chapter 22: Advanced Phrases</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s7" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_22.html#s7" class="standardlink">Back to §22.7. Kind variables</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s9" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_22.html#s9" class="standardlink">Onward to §22.9. In what order?</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s9"></a>§22.9. In what order?</p>
<p>Recall the definition:</p>
<!-- START CODE "c8723" -->
<a id="c8723"></a><blockquote class="code"><p class="quoted">
To slam shut (box - an open container): say &quot;With great panache, you slam shut [the box].&quot;.
</p></blockquote>
<!-- END CODE -->
<p>Suppose we then try to &quot;slam shut the wall safe&quot; at a time during play when the wall safe is already closed. An error message will then be printed during play, since there must be a mistake in the design. The combination of checking both when Inform builds the story file and then continuously when the story file is played guarantees that, in all cases, a varying item such as &quot;box&quot; in the definition of &quot;To slam shut (box - open container)&quot; always satisfies the condition laid down.</p>
<p>Instead suppose we also have the following definition:</p>
<!-- START CODE "c8724" -->
<a id="c8724"></a><blockquote class="code"><p class="quoted">
To slam shut (box - a container): say &quot;You are unable to slam shut [the box], which is already closed.&quot;.
</p></blockquote>
<!-- END CODE -->
<p>We now have two definitions of &quot;slam shut&quot;. Sometimes the box it's applied to will be closed, in which case only the second definition fits, and will be the one used. But if the box is open, both definitions fit. Which will happen? The rule is:</p>
<!-- START CODE "c8725" -->
<a id="c8725"></a><blockquote class="code"><p class="quoted">
1. A narrower condition takes precedence over a broader one;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8726" -->
<a id="c8726"></a><blockquote class="code"><p class="quoted">
2. If neither condition is narrower than the other, then whichever phrase was defined later in the source code is the one taking precedence;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8727" -->
<a id="c8727"></a><blockquote class="code"><p class="quoted">
3. Except that if the phrase is being used in the definition of phrase P, then P is always last in precedence order, so that recursion is always the very last possibility considered. This allows more specific or later definitions to make use of less specific or earlier ones in a natural way.
</p></blockquote>
<!-- END CODE -->
<p>Rule 1 ensures that a definition involving &quot;open container&quot; takes priority over one which merely involves &quot;container&quot;, for instance.</p>
<p>And therefore when the box is open, it's the more specific phrase to do with open containers which is invoked: so, with great panache, the box is slammed shut.</p>
<p>On the other hand, neither of these patterns is narrower than the other:</p>
<!-- START CODE "c8728" -->
<a id="c8728"></a><blockquote class="code"><p class="quoted">
To describe (something - transparent): ...
<br />To describe (something - container): ...
</p></blockquote>
<!-- END CODE -->
<p>Some containers are transparent, some not; some transparent things are containers, some not. Rule 1 therefore does not apply, so it is the later of the two phrases which takes effect.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_22.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_22.html" class="standardlink">Start of Chapter 22: Advanced Phrases</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s8" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_22.html#s8" class="standardlink">Back to §22.8. Matching the names of kinds</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s10" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_22.html#s10" class="standardlink">Onward to §22.10. Ambiguities</a></td></tr>
</table><hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
<p class="sectionheading"><a id="s10"></a>§22.10. Ambiguities</p>
<p>Another possible ambiguity occurs when a phrase might match two lexically different possibilities using the same words.</p>
<!-- START CODE "c8729" -->
<a id="c8729"></a><blockquote class="code"><p class="quoted">
say the dishcloth;
</p></blockquote>
<!-- END CODE -->
<p>could be construed as a usage of either of these cases:</p>
<!-- START CODE "c8730" -->
<a id="c8730"></a><blockquote class="code"><p class="quoted">
say the (something - a thing)
<br />say (something - a thing)
</p></blockquote>
<!-- END CODE -->
<p>These of course have different effects - one produces the name with a definite article, the other just the name, so the difference is important.</p>
<p>The rule here is that whichever possibility contains the most words, in this case &quot;say the (...)&quot;, takes precedence, because it's assumed to be a more specific form of the less wordy version.</p>
<hr />
<div class="roadsigns">
<table><tr><td class="roadsigndirection"><a href="WI_22.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_22.html" class="standardlink">Start of Chapter 22: Advanced Phrases</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_22.html#s9" class="standardlink"><img alt="arrow-left.png" src="images/arrow-left.png" /></a></td><td><a href="WI_22.html#s9" class="standardlink">Back to §22.9. In what order?</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_23.html#s1" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_23.html#s1" class="standardlink">Onward to Chapter 23: Figures, Sounds and Files: §23.1. Beyond text</a></td></tr>
</table><hr />
</div>
<div class="bookexamples">
<p class="chapterheading">Examples from Chapter 22: Advanced Phrases</p><table class="centredtable"><tr><td class="roadsigndirection"><a href="WI_22.html" class="standardlink"><img alt="arrow-up.png" src="images/arrow-up.png" /></a></td><td><a href="WI_22.html" class="standardlink">Start of this chapter</a></td></tr>
<tr><td class="roadsigndirection"><a href="WI_23.html" class="standardlink"><img alt="arrow-right.png" src="images/arrow-right.png" /></a></td><td><a href="WI_23.html" class="standardlink">Chapter 23: Figures, Sounds and Files</a></td></tr>
<tr><td class="roadsigndirection"><a href="examples_alphabetical.html" class="standardlink"><img alt="arrow-down-right.png" src="images/arrow-down-right.png" /></a></td><td><a href="examples_alphabetical.html" class="standardlink">Indexes of the examples</a></td></tr>
</table><!-- START EXAMPLE "439: Curare" "e100" -->
<a id="e100"></a><table class="egcue"><tr><td class="egcellforoval"><div class="egovalfornumber overstruckimage">
<a href="WI_22.html#e100" class="eglink"><b>439</b></a></div>
</td><td class="egnamecell"><p class="egcuetext"><a href="WI_22.html#e100" class="eglink"><img class="asterisk" alt="*" src="images/asterisk.png" /><b><span class="egbanner">Example</span><span class="egname">Curare</span></b></a><br />A phrase that chooses and names the least-recently selected item from the collection given, allowing the text to cycle semi-randomly through a group of objects.</p></td><td class="egcrossref"><!-- START IGNORE -->
<div class="egovalforxref overstruckimage">
<a  href="RB_2.html#e100"><i>RB</i></a></div>
<!-- END IGNORE -->
</td></tr></table>
<div class="egpanel" id="example100">
<!-- START CODE "c8731_100" -->
<a id="c8731_100"></a><blockquote class="code"><p class="quoted">
&quot;Curare&quot;
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8732_100" -->
<a id="c8732_100"></a><blockquote class="code"><p class="quoted">
A thing has a number called the last use. The last use of a thing is usually 0.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8733_100" -->
<a id="c8733_100"></a><blockquote class="code"><p class="quoted">
Definition: a thing is old if its last use is 12 or less.
</p></blockquote>
<!-- END CODE -->
<p>The actual number chosen in this definition is pretty much irrelevant: the main thing is that we want to establish relative values. The lower the &quot;last use&quot; number of an item, the older that item should be understood to be, as we see here:</p>
<!-- START CODE "c8734_100" -->
<a id="c8734_100"></a><blockquote class="code"><p class="quoted">
To decide which thing is cyclically random (collection - a description of objects):
<br />&#160;&#160;&#160;&#160;let choice be the oldest member of the collection;
<br />&#160;&#160;&#160;&#160;now the last use of the choice is the turn count;
<br />&#160;&#160;&#160;&#160;decide on choice.
</p></blockquote>
<!-- END CODE -->
<p>This phrase will select, from the collection of objects passed to it, the one that has been mentioned least recently. This means that if we consult it repeatedly about the same collection, it will begin to cycle predictably; but if new items are added to the collection, it will mention these first before returning to the previous cycle. Now we can use this:</p>
<!-- START CODE "c8735_100" -->
<a id="c8735_100"></a><blockquote class="code"><p class="quoted">
After taking inventory:
<br />&#160;&#160;&#160;&#160;say &quot;You stare morosely at [the cyclically random thing carried by the player], wondering what you're ever going to find to do with it.&quot;
</p></blockquote>
<!-- END CODE -->
<p>We could have said &quot;You stare morosely at [the oldest thing carried by the player]&quot; here, but doing so would not have set the &quot;last use&quot; property correctly, so we would not get the cycling behavior that we're looking for.</p>
<!-- START CODE "c8736_100" -->
<a id="c8736_100"></a><blockquote class="code"><p class="quoted">
The Evidence Room is a room. Some shelves are scenery supporters in the Evidence Room. A box is a kind of container which is open and not openable. On the shelves is a box.  It contains a deformed bullet and a driver's license.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8737_100" -->
<a id="c8737_100"></a><blockquote class="code"><p class="quoted">
The player carries a steel fish hook, a Chinese passport, a tube of synthetic curare, and an envelope full of Euros.
</p></blockquote>
<!-- END CODE -->
<!-- START CODE "c8738_100" -->
<a id="c8738_100"></a><blockquote class="code"><p class="quoted">
Test me with &quot;i / i / i / i / i / i / get all from box / i / i / i&quot;.
</p></blockquote>
<!-- END CODE -->
</div>
<p></p>
<!-- END EXAMPLE -->
<hr />
</div>
<!-- START IGNORE -->
<!-- END IGNORE -->
</body>
</html>
